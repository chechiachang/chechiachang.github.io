<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: 2023年9月16日 --><html lang="zh-Hant" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.042e26407c9e383d96a1f26d6787c686.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  






<script async src="https://www.googletagmanager.com/gtag/js?id=G-QYR8JCDGM9"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-QYR8JCDGM9', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>




<script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NSBJFRS');
</script>




















  
  
  






  <meta name="author" content="張哲嘉" />





  

<meta name="description" content="2020 It邦幫忙鐵人賽 系列文章
Self-host ELK stack on GCP Secure ELK Stask 監測 Google Compute Engine 上服務的各項數據 監測 Google Kubernetes Engine 的各項數據 是否選擇 ELK 作為解決方案 使用 logstash pipeline 做數據前處理 Elasticsearch 日常維護：數據清理，效能調校，永久儲存 Debug ELK stack on GCP 作為範例的 ELK 的版本是當前的 stable release 7." />



  <link rel="alternate" hreflang="en" href="https://chechia.net/en/post/2019-09-15-self-host-elk-stack-on-gcp/" />

<link rel="alternate" hreflang="zh-Hant" href="https://chechia.net/zh-hant/post/2019-09-15-self-host-elk-stack-on-gcp/" />
<link rel="canonical" href="https://chechia.net/zh-hant/post/2019-09-15-self-host-elk-stack-on-gcp/" />



  <link rel="manifest" href="/zh-hant/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />

  <meta property="twitter:site" content="@chechiachang" />
  <meta property="twitter:creator" content="@chechiachang" />
<meta property="twitter:image" content="https://chechia.net/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png" />
<meta property="og:site_name" content="Che-Chia Chang" />
<meta property="og:url" content="https://chechia.net/zh-hant/post/2019-09-15-self-host-elk-stack-on-gcp/" />
<meta property="og:title" content="Self-host ELK stack - Installation | Che-Chia Chang" />
<meta property="og:description" content="2020 It邦幫忙鐵人賽 系列文章
Self-host ELK stack on GCP Secure ELK Stask 監測 Google Compute Engine 上服務的各項數據 監測 Google Kubernetes Engine 的各項數據 是否選擇 ELK 作為解決方案 使用 logstash pipeline 做數據前處理 Elasticsearch 日常維護：數據清理，效能調校，永久儲存 Debug ELK stack on GCP 作為範例的 ELK 的版本是當前的 stable release 7." /><meta property="og:image" content="https://chechia.net/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="zh-Hant" />

  
    <meta
      property="article:published_time"
      content="2019-09-15T11:43:03&#43;08:00"
    />
  
  
    <meta property="article:modified_time" content="2023-09-11T22:33:54&#43;08:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://chechia.net/zh-hant/post/2019-09-15-self-host-elk-stack-on-gcp/"
  },
  "headline": "Self-host ELK stack - Installation",
  
  "datePublished": "2019-09-15T11:43:03+08:00",
  "dateModified": "2023-09-11T22:33:54+08:00",
  
  "author": {
    "@type": "Person",
    "name": "張哲嘉"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "chechia-net",
    "logo": {
      "@type": "ImageObject",
      "url": "https://chechia.net/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "2020 It邦幫忙鐵人賽 系列文章\nSelf-host ELK stack on GCP Secure ELK Stask 監測 Google Compute Engine 上服務的各項數據 監測 Google Kubernetes Engine 的各項數據 是否選擇 ELK 作為解決方案 使用 logstash pipeline 做數據前處理 Elasticsearch 日常維護：數據清理，效能調校，永久儲存 Debug ELK stack on GCP 作為範例的 ELK 的版本是當前的 stable release 7."
}
</script>

  

  




  
  
  

  
  

  


  
  <title>Self-host ELK stack - Installation | Che-Chia Chang</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="89b94a9f78ad2ba6feb1029b40b9f2b2" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>搜尋</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="關閉"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="搜尋..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="搜尋...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/zh-hant/">Che-Chia Chang</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="切換導航">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/zh-hant/">Che-Chia Chang</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/zh-hant/#talks"><span>演講</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/zh-hant/#posts"><span>發文</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/zh-hant/#projects"><span>專案</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://www.instagram.com/c.c.leather/" target="_blank" rel="noopener"><span>皮件</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://www.instagram.com/dive.with.cat.coach/" target="_blank" rel="noopener"><span>水肺</span></a>
          </li>

          
          

          

          
          
          
            
              
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="https://mvp.microsoft.com/zh-TW/mvp/profile/e407d0b9-5c01-eb11-a815-000d3a8ccaf5" target="_blank" rel="noopener"><span>微軟MVP</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://github.com/chechiachang" data-toggle="tooltip" data-placement="bottom" title="查看我的Github" target="_blank" rel="noopener" aria-label="查看我的Github">
                <i class="fab fa-github" aria-hidden="true"></i>
              </a>
            </li>
          
            
            <li class="nav-item d-none d-lg-inline-flex">
              <a class="nav-link" href="https://www.facebook.com/engineer.from.scratch" data-toggle="tooltip" data-placement="bottom" title="追蹤我的Facebook粉絲專頁" target="_blank" rel="noopener" aria-label="追蹤我的Facebook粉絲專頁">
                <i class="fab fa-facebook" aria-hidden="true"></i>
              </a>
            </li>
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="搜尋"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="顯示選項">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>明亮</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>暗黑</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>自動</span>
            </a>
          </div>
        </li>
        

        
        
        <li class="nav-item dropdown i18n-dropdown">
          <a href="#" class="nav-link " data-toggle="dropdown"
             aria-haspopup="true" aria-label="語言">
            <i class="fas fa-globe mr-1" aria-hidden="true"></i></a>
          <div class="dropdown-menu">
            <div class="dropdown-item dropdown-item-active">
              <span>中文 (繁體)</span>
            </div>
            
            <a class="dropdown-item" href="https://chechia.net/en/post/2019-09-15-self-host-elk-stack-on-gcp/">
              <span>English</span>
            </a>
            
          </div>
        </li>
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  













  

  
  
  
<div class="article-container pt-3">
  <h1>Self-host ELK stack - Installation</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          最近更新於
      
    
    9月 11, 2023
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    4 閱讀時間（分鐘）
  </span>
  

  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/zh-hant/category/kubernetes/">kubernetes</a>, <a href="/zh-hant/category/elasticsearch/">elasticsearch</a></span>
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      <p><a href="https://ithelp.ithome.com.tw/2020ironman" target="_blank" rel="noopener">2020 It邦幫忙鐵人賽</a> 系列文章</p>
<ul>
<li><a href="https://chechia.net/zh-hant/post/2019-09-15-self-host-elk-stack-on-gcp/">Self-host ELK stack on GCP</a></li>
<li><a href="https://chechia.net/zh-hant/post/2019-09-15-secure-elk-stack/">Secure ELK Stask</a></li>
<li><a href="https://chechia.net/zh-hant/post/2019-09-18-monitoring-gce-with-elk/">監測 Google Compute Engine 上服務的各項數據</a></li>
<li><a href="https://chechia.net/zh-hant/post/2019-09-19-monitoring-gke-with-elk/">監測 Google Kubernetes Engine 的各項數據</a></li>
<li><a href="https://chechia.net/zh-hant/post/2019-09-18-elastic-or-not-elastic/">是否選擇 ELK 作為解決方案</a></li>
<li><a href="https://chechia.net/zh-hant/post/2019-09-21-logstash-on-gke/">使用 logstash pipeline 做數據前處理</a></li>
<li>Elasticsearch 日常維護：數據清理，效能調校，永久儲存</li>
<li>Debug ELK stack on GCP</li>
</ul>
<p>作為範例的 ELK 的版本是當前的 stable release 7.3.1。</p>
<p>由於我比較熟悉 GCP / GKE 的服務，這篇的操作過程都會以 GCP 平台作為範例，不過操作過程大體上是跨平台通用的。</p>
<p>對我的文章有興趣，歡迎到我的網站上 <a href="https://chechia.net" target="_blank" rel="noopener">https://chechia.net</a> 閱讀其他技術文章，有任何謬誤也請各方大德直接聯繫我，感激不盡。</p>
<p>&ndash;</p>
<h1 id="簡介-elk-stack">簡介 ELK stack</h1>
<p><a href="https://www.elastic.co/guide/index.html" target="_blank" rel="noopener">官方說明文件</a></p>
<h3 id="elk-的元件">ELK 的元件</h3>
<ul>
<li>Elasticsearch: 基於 Lucene 的分散式全文搜索引擎</li>
<li>Logstash: 數據處理 pipeline</li>
<li>Kibana: ELK stack 的管理後台與數據視覺化工具</li>
<li>Beats: 輕量級的應用端數據收集器，會從被監控端收集 log 與監控數據(metrics)</li>
</ul>
<h3 id="elk-的工作流程">ELK 的工作流程</h3>
<p>beats -&gt; (logstash) -&gt; elasticsearch -&gt; kibana</p>
<ol>
<li>將 beats 放在應用端的主機上，或是在容器化環境種作為 sidecar，跟應用放在一起</li>
<li>設定 beats 從指定的路徑收集 log 與 metrics</li>
<li>設定 beats 向後輸出的遠端目標</li>
<li>(Optional) beats 輸出到 logstash ，先進行數據的變更、格式整理，在後送到 elasticsearch</li>
<li>beats 向後輸出到 elasticsearch，儲存數據文件(document)，並依照樣式(template)與索引(index)儲存，便可在 elasticsearch 上全文搜索數據</li>
<li>透過 Kibana，將 elasticsearch 上的 log 顯示</li>
</ol>
<h1 id="官方不是有出文件嗎">官方不是有出文件嗎</h1>
<p>Elastic 官方準備了大量的文件，理論上要跟著文件一步一步架設這整套工具應該是十分容易。然而實際照著做卻遇上很多困難。由於缺乏 get-started 的範例文件，不熟悉 ELK 設定的使用者，常常需要停下來除錯，甚至因為漏掉某個步驟，而需要回頭重做一遍。</p>
<p>說穿了本篇的技術含量不高，就只是一個踩雷過程。</p>
<p>Lets get our hands dirty.</p>
<h1 id="warning">WARNING</h1>
<p>這篇安裝過程沒有做安全性設定，由於 ELK stack 的安全性功能模組，在<a href="https://www.elastic.co/what-is/open-x-pack" target="_blank" rel="noopener">v6.3.0 以前的版本是不包含安全性模組的</a>，官方的安裝說明文件將安全性設定另成一篇。我第一次安裝，全部安裝完後，才發現裏頭沒有任何安全性設定，包含帳號密碼登入、api secret token、https/tls 通通沒有，整組 elk 裸奔。</p>
<p>我這邊分開的目的，不是讓大家都跟我一樣被雷(XD)，而是因為</p>
<ul>
<li>另起一篇對安全性設定多加說明</li>
<li>在安全的內網中，沒有安全性設定，可以大幅加速開發與除錯</li>
</ul>
<p>雖然沒有安全性設定，但仍然有完整的功能，如果只是在測試環境，或是想要評估試用 self-hosted ELK，這篇的說明已足夠。但千萬不要用這篇上 public network 或是用在 production 環境喔。</p>
<p>如果希望第一次安裝就有完整的 security 設定，請等待下篇 <a href="#secure-elk-stack">Secure ELK Stask</a></p>
<h1 id="討論需求與規格">討論需求與規格</h1>
<p>這邊只是帶大家過一下基礎安裝流程，我們在私有網路中搭建一台 standalone 的 ELK stack，通通放在一台節點(node)上。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">elk-node-standalone 10.140.0.10
</span></span><span class="line"><span class="cl">app-node-1          10.140.0.11
</span></span><span class="line"><span class="cl">...                 ...
</span></span></code></pre></div><p>本機的 ELK stack 元件，彼此透過 localhost 連線</p>
<ul>
<li>Elasticsearch:  localhost:9200</li>
<li>Kibana:         localhost:5601</li>
<li>Apm-server:     localhost:8200</li>
<li>Self Monitoring Services</li>
</ul>
<p>私有網路中的外部服務透過 10.140.0.10</p>
<ul>
<li>beats 從其他 node 輸出到 Elasticsearch: 10.140.0.10:9200</li>
<li>beats 從其他 node 輸出到 Apm-server:    10.140.0.10:8200</li>
<li>在內部網路中 透過 browser 存取 Kibana:  10.140.0.10:5601</li>
</ul>
<p>standalone 的好處:</p>
<ul>
<li>方便 (再次強調這篇只是示範，實務上不要貪一時方便，維運崩潰)</li>
<li>最簡化設定，ELK 有非常大量的設定可以調整，這篇簡化了大部分</li>
</ul>
<p>Standalone可能造成的問題:</p>
<ul>
<li>No High Availablity: 沒有任何容錯備援可以 failover，這台掛就全掛</li>
<li>外部服務多的話，很容易就超過 node 上對於網路存取的限制，造成 tcp drop 或 delay。需要調整 ulimit 來增加網路，當然這在雲端上會給維運帶來更多麻煩，不是一個好解法。</li>
</ul>
<p>如果要有 production ready 的 ELK</p>
<ul>
<li>HA 開起來</li>
<li>把服務分散到不同 node 上, 方便之後 scale out 多開幾台
<ul>
<li>elasticsearch-1, elasticsearch-2, elasticsearch-3&hellip;</li>
<li>kibana-1</li>
<li>apm-server-1, apm-server-2, &hellip;</li>
</ul>
</li>
<li>如果應用在已經容器化, 這些服務元件也可以上 Kubernetes 做容器自動化，這個部份蠻好玩，如果有時間我們來聊這篇</li>
</ul>
<h1 id="主機設定">主機設定</h1>
<p>Elasticsearch 儲存數據會佔用不少硬碟空間，我個人的習慣是只要有額外占用儲存空間，都要另外掛載硬碟，不要占用 root，所以這邊會需要另外掛載硬碟。</p>
<p>GCP 上使用 Google Compote Engine 的朋友，可以照 <a href="https://cloud.google.com/compute/docs/disks/add-persistent-disk?hl=zh-tw" target="_blank" rel="noopener">Google 官方操作步驟操作</a></p>
<p>完成後接近這樣</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ df -h
</span></span><span class="line"><span class="cl">$ df --human-readable
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Filesystem      Size  Used Avail Use% Mounted on
</span></span><span class="line"><span class="cl">/dev/sda1       9.6G  8.9G  682M  93% /
</span></span><span class="line"><span class="cl">/dev/sdb        492G   63G  429G  13% /mnt/disks/elk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ ls /mnt/disks/elk
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/mnt/disks/elk/elasticsearch
</span></span><span class="line"><span class="cl">/mnt/disks/elk/apm-server
</span></span><span class="line"><span class="cl">/mnt/disks/elk/kibana
</span></span></code></pre></div><p>至於需要多少容量，取決收集數據的數量，落差非常大，可以先上個 100Gb ，試跑一段時間，再視情況 scale storage disk。</p>
<h1 id="開防火牆">開防火牆</h1>
<p>需要開放 10.140.0.10 這台機器的幾個 port</p>
<ul>
<li>elasticsearch           :9200   來源只開放私有網路其他 ip 10.140.0.0/9</li>
<li>apm-server              :8200   (同上)</li>
<li>kibana                  :5601   (同上)，如果想從外部透過 browser開，需要 whitelist ip</li>
</ul>
<p>GCP 上有 default 的防火牆允許規則，私有網路可以彼此連線</p>
<ul>
<li>default-allow-internal: :all    :10.140.0.0/9   tcp:0-65535</li>
</ul>
<h1 id="install-elasticsearch">Install Elasticsearch</h1>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.3/install-elasticsearch.html" target="_blank" rel="noopener">Install Elasticsearch 官方文件 7.3</a></p>
<p>我們這邊直接在 ubuntu 18.04 上使用 apt 作為安裝</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get install apt-transport-https
</span></span><span class="line"><span class="cl">wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
</span></span><span class="line"><span class="cl">add-apt-repository &#34;deb https://artifacts.elastic.co/packages/7.x/apt stable main&#34;
</span></span><span class="line"><span class="cl">sudo apt-get update
</span></span><span class="line"><span class="cl">sudo apt-get install elasticsearch
</span></span></code></pre></div><p>安裝完後路徑長這樣</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/etc/elasticsearch
</span></span><span class="line"><span class="cl">/etc/elasticsearch/elasticsearch.yml
</span></span><span class="line"><span class="cl">/etc/elasticsearch/jvm.options
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Utility
</span></span><span class="line"><span class="cl">/usr/share/elasticsearch/bin/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Log
</span></span><span class="line"><span class="cl">/var/log/elasticsearch/elasticsearch.log
</span></span></code></pre></div><p>有需要也可以複寫設定檔，把 log 也移到 /mnt/disks/elk/elasticsearch/logs</p>
<h3 id="服務控制">服務控制</h3>
<p>透過 systemd 管理，我們可以用 systemctl 控制，
用戶 elasticsearch:elasticsearch，操作時會需要 sudo 權限。</p>
<p>但在啟動前要先調整數據儲存路徑，並把權限移轉給使用者。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mkdir -p /mnt/disks/elk/elasticsearch
</span></span><span class="line"><span class="cl">chown elasticsearch:elasticsearch /mnt/disks/elk/elasticsearch
</span></span></code></pre></div><h3 id="設定檔案">設定檔案</h3>
<p>ELK 提供了許多可設定調整的設定,但龐大的設定檔案也十分難上手。我們這邊先簡單更改以下設定檔案</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo vim /etc/elasticsearch/elasticsearch.yml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Change Network
</span></span><span class="line"><span class="cl">network.host: 0.0.0.0
</span></span><span class="line"><span class="cl"># Change data path
</span></span><span class="line"><span class="cl">path.data: /mnt/disks/elk/elasticsearch
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">vim /etc/elasticsearch/jvm-options
</span></span><span class="line"><span class="cl"># Adjust heap to 4G
</span></span><span class="line"><span class="cl">-Xms4g
</span></span><span class="line"><span class="cl">-Xmx4g
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Enable xpack.security
</span></span><span class="line"><span class="cl">discovery.seed_hosts: [&#34;10.140.0.10&#34;]
</span></span><span class="line"><span class="cl">discovery.type: &#34;single-node&#34;
</span></span><span class="line"><span class="cl">xpack.security.enabled: true
</span></span><span class="line"><span class="cl">xpack.security.transport.ssl.enabled: true
</span></span><span class="line"><span class="cl">xpack.license.self_generated.type: basic
</span></span></code></pre></div><p>6.3.0 後的版本已經附上安全性模組 xpack，這邊順便開起來。關於 xpack 的安全性設定，這邊先略過不提。</p>
<p>有啟用 xpack ，可以讓我們透過 elasticsearch 附帶的工具，產生使用者與帳號密碼。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/usr/share/elasticsearch/bin/elasticsearch-setup-passwords auto
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Keep your passwords safe
</span></span></code></pre></div><p>然後把啟動 Elasticsearch</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo systemctl enable elasticsearch.service
</span></span><span class="line"><span class="cl">sudo systemctl start elasticsearch.service
</span></span><span class="line"><span class="cl">sudo systemctl status elasticsearch.service
</span></span></code></pre></div><p>看一下 log，確定服務有在正常工作</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tail -f /var/log/elasticsearch/elasticsearch.log
</span></span></code></pre></div><p>在 node 上試打 Elasticsearch API</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ curl localhost:9200
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  &#34;name&#34; : &#34;elk&#34;,
</span></span><span class="line"><span class="cl">  &#34;cluster_name&#34; : &#34;elasticsearch&#34;,
</span></span><span class="line"><span class="cl">  &#34;cluster_uuid&#34; : &#34;uiMZe7VETo-H6JLFLF4SZg&#34;,
</span></span><span class="line"><span class="cl">  &#34;version&#34; : {
</span></span><span class="line"><span class="cl">    &#34;number&#34; : &#34;7.3.1&#34;,
</span></span><span class="line"><span class="cl">    &#34;build_flavor&#34; : &#34;default&#34;,
</span></span><span class="line"><span class="cl">    &#34;build_type&#34; : &#34;deb&#34;,
</span></span><span class="line"><span class="cl">    &#34;build_hash&#34; : &#34;4749ba6&#34;,
</span></span><span class="line"><span class="cl">    &#34;build_date&#34; : &#34;2019-08-19T20:19:25.651794Z&#34;,
</span></span><span class="line"><span class="cl">    &#34;build_snapshot&#34; : false,
</span></span><span class="line"><span class="cl">    &#34;lucene_version&#34; : &#34;8.1.0&#34;,
</span></span><span class="line"><span class="cl">    &#34;minimum_wire_compatibility_version&#34; : &#34;6.8.0&#34;,
</span></span><span class="line"><span class="cl">    &#34;minimum_index_compatibility_version&#34; : &#34;6.0.0-beta1&#34;
</span></span><span class="line"><span class="cl">  },
</span></span><span class="line"><span class="cl">  &#34;tagline&#34; : &#34;You Know, for Search&#34;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></div><h1 id="kibana">Kibana</h1>
<p>有了正常工作的 Elasticsearch，接下來要安裝 kibana，由於 apt repository 已經匯入，這邊直接</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get update
</span></span><span class="line"><span class="cl">sudo apt-get install kibana
</span></span></code></pre></div><p>一樣快速設定一下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ vim /etc/kibana/kinana.yml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># change server.host from localhost to 0.0.0.0 to allow outside requests
</span></span><span class="line"><span class="cl">server.host: &#34;0.0.0.0&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Add elasticsearch password
</span></span><span class="line"><span class="cl">elasticsearch.username: &#34;kibana&#34;
</span></span><span class="line"><span class="cl">elasticsearch.password:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo systemctl enable kibana.service
</span></span><span class="line"><span class="cl">sudo systemctl start kibana.service
</span></span><span class="line"><span class="cl">sudo systemctl status kibana.service
</span></span></code></pre></div><p>檢查 log 並試打一下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo systemctl status kibana
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ curl localhost:5601
</span></span></code></pre></div><p>透過內網 ip 也可以用 browser 存取
使用 elastic 這組帳號密碼登入，可以有管理員權限
可以檢視一下 kibana 的頁面，看一下是否系統功能都上常上線
http://10.140.0.10/app/monitoring#</p>
<h1 id="filebeat">Filebeat</h1>
<p>以上是 ELK 最基本架構: elasticsearch 引擎與前端視覺化管理工具 Kibana。當然現在進去 kibana 是沒有數據的，所以我們現在來安裝第一個 beat，收集第一筆數據。</p>
<p>你可能會覺得奇怪: 我現在沒有任何需要監控的應用，去哪收集數據?</p>
<p>ELK 提供的自我監測 (self-monitoring) 的功能，也就是在 node 上部屬 filebeat 並啟用 modules，便可以把這台 node 上的 elasticsearch 運行的狀況，包含cpu 狀況、記憶體用量、儲存空間用量、安全性告警、&hellip;都做為數據，傳到 elasticsearch 中，並在 Kibana monitoring 頁面製圖顯示。</p>
<p>這邊也剛好做為我們 ELK stack 的第一筆數據收集。</p>
<p>WARNING: 這邊一樣要提醒， production 環境多半會使用另外一組的 elasticsearch 來監控主要的這組 elastic stack，以維持 elk stack 的穩定性，才不會自己 monitoring 自己，結果 elastic 掛了，metrics 跟錯誤訊息都看不到。</p>
<p><a href="https://www.elastic.co/guide/en/beats/filebeat/7.3/filebeat-installation.html" target="_blank" rel="noopener">官方安裝文件</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get update
</span></span><span class="line"><span class="cl">sudo apt-get install filebeat
</span></span></code></pre></div><p>預設的 filebeat.yml 設定檔案不是完整的，請到官網下載完整版，但官網沒給檔案連結(慘)，只有網頁版 <a href="https://www.elastic.co/guide/en/beats/filebeat/7.3/filebeat-reference-yml.html" target="_blank" rel="noopener">https://www.elastic.co/guide/en/beats/filebeat/7.3/filebeat-reference-yml.html</a></p>
<p>我們上 github 把她載下來</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-v" data-lang="v"><span class="line"><span class="cl"><span class="err">$</span> <span class="nv">wget</span> <span class="nv">https</span><span class="p">:</span><span class="c1">//raw.githubusercontent.com/elastic/beats/v7.3.1/filebeat/filebeat.reference.yml
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="err">$</span> <span class="nv">sudo</span> <span class="nv">mv</span> <span class="nv">filebeat</span><span class="o">-</span><span class="nv">reference</span><span class="o">-</span><span class="nv">y</span>
</span></span><span class="line"><span class="cl"><span class="err">$</span> <span class="nv">sudo</span> <span class="nv">vim</span> <span class="o">/</span><span class="nv">etc</span><span class="o">/</span><span class="nv">filebeat</span><span class="o">/</span><span class="nv">filebeat</span><span class="p">.</span><span class="nv">yml</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">#</span> <span class="nc">Enable</span> <span class="nv">elasticsearch</span> <span class="kn">module</span> <span class="nv">and</span> <span class="nv">kibana</span> <span class="kn">module</span> <span class="nv">to</span> <span class="nv">process</span> <span class="nv">metrics</span> <span class="nv">of</span> <span class="nv">localhost</span> <span class="nv">elasticsearch</span> <span class="o">&amp;</span> <span class="nv">kibana</span>
</span></span><span class="line"><span class="cl"><span class="nv">filebeat</span><span class="p">.</span><span class="nl">modules</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="kn">module</span><span class="p">:</span> <span class="nv">elasticsearch</span>
</span></span><span class="line"><span class="cl">  <span class="o">#</span> <span class="nc">Server</span> <span class="nv">log</span>
</span></span><span class="line"><span class="cl">  <span class="nl">server</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nv">enabled</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="kn">module</span><span class="p">:</span> <span class="nv">kibana</span>
</span></span><span class="line"><span class="cl">  <span class="o">#</span> <span class="nc">All</span> <span class="nv">logs</span>
</span></span><span class="line"><span class="cl">  <span class="nl">log</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nv">enabled</span><span class="p">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">#</span> <span class="nc">The</span> <span class="nv">name</span> <span class="nv">will</span> <span class="nv">be</span> <span class="nv">added</span> <span class="nv">to</span> <span class="nv">metadata</span>
</span></span><span class="line"><span class="cl"><span class="nv">name</span><span class="p">:</span> <span class="nv">filebeat</span><span class="o">-</span><span class="nv">elk</span>
</span></span><span class="line"><span class="cl"><span class="nl">fields</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">  <span class="nv">env</span><span class="p">:</span> <span class="nv">elk</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">#</span> <span class="nc">Add</span> <span class="nv">additional</span> <span class="nv">cloud_metadata</span> <span class="nv">since</span> <span class="nv">we</span><span class="s1">&#39;re on GCP
</span></span></span><span class="line"><span class="cl"><span class="s1">processors:
</span></span></span><span class="line"><span class="cl"><span class="s1">- add_cloud_metadata: ~
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1"># Output to elasticsearch
</span></span></span><span class="line"><span class="cl"><span class="s1">output.elasticsearch:
</span></span></span><span class="line"><span class="cl"><span class="s1">  enabled: true
</span></span></span><span class="line"><span class="cl"><span class="s1">  hosts: [&#34;localhost:9200&#34;]
</span></span></span><span class="line"><span class="cl"><span class="s1">  protocol: &#34;http&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">  username: &#34;elastic&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">  password: 
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1"># Configure kibana with filebeat: add template, dashboards, etc...
</span></span></span><span class="line"><span class="cl"><span class="s1">setup.kibana:
</span></span></span><span class="line"><span class="cl"><span class="s1">  host: &#34;localhost:5601&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">  protocol: &#34;http&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">  username: &#34;elastic&#34;
</span></span></span><span class="line"><span class="cl"><span class="s1">  password: 
</span></span></span></code></pre></div><p>啟動 filebeat</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo systemctl start filebeat
</span></span></code></pre></div><p>看一下 log，filebeat 會開始收集 elasticsearch 的 log 與 metrics，可以在 log 上看到收集的狀況。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ sudo journalctl -fu filebeat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Sep 15 06:28:50 elk filebeat[9143]: 2019-09-15T06:28:50.176Z        INFO        [monitoring]        log/log.go:145        Non-zero metrics in the last 30s        {&#34;monitoring&#34;: {&#34;metrics&#34;: {&#34;beat&#34;:{&#34;cpu&#34;:{&#34;system&#34;:{&#34;ticks&#34;:1670860,&#34;time&#34;:{&#34;ms&#34;:66}},&#34;total&#34;:{&#34;ticks&#34;:6964660,&#34;time&#34;:{&#34;ms&#34;:336},&#34;value&#34;:6964660},&#34;user&#34;:{&#34;ticks&#34;:5293800,&#34;time&#34;:{&#34;ms&#34;:270}}},&#34;handles&#34;:{&#34;limit&#34;:{&#34;hard&#34;:4096,&#34;soft&#34;:1024},&#34;open&#34;:11},&#34;info&#34;:{&#34;ephemeral_id&#34;:&#34;62fd4bfa-1949-4356-9615-338ca6a95075&#34;,&#34;uptime&#34;:{&#34;ms&#34;:786150373}},&#34;memstats&#34;:{&#34;gc_next&#34;:7681520,&#34;memory_alloc&#34;:4672576,&#34;memory_total&#34;:457564560376,&#34;rss&#34;:-32768},&#34;runtime&#34;:{&#34;goroutines&#34;:98}},&#34;filebeat&#34;:{&#34;events&#34;:{&#34;active&#34;:-29,&#34;added&#34;:1026,&#34;done&#34;:1055},&#34;harvester&#34;:{&#34;open_files&#34;:4,&#34;running&#34;:4}},&#34;libbeat&#34;:{&#34;config&#34;:{&#34;module&#34;:{&#34;running&#34;:0}},&#34;output&#34;:{&#34;events&#34;:{&#34;acked&#34;:1055,&#34;active&#34;:-50,&#34;batches&#34;:34,&#34;total&#34;:1005},&#34;read&#34;:{&#34;bytes&#34;:248606},&#34;write&#34;:{&#34;bytes&#34;:945393}},&#34;pipeline&#34;:{&#34;clients&#34;:9,&#34;events&#34;:{&#34;active&#34;:32,&#34;published&#34;:1026,&#34;total&#34;:1026},&#34;queue&#34;:{&#34;acked&#34;:1055}}},&#34;registrar&#34;:{&#34;states&#34;:{&#34;current&#34;:34,&#34;update&#34;:1055},&#34;writes&#34;:{&#34;success&#34;:35,&#34;total&#34;:35}},&#34;system&#34;:{&#34;load&#34;:{&#34;1&#34;:1.49,&#34;15&#34;:0.94,&#34;5&#34;:1.15,&#34;norm&#34;:{&#34;1&#34;:0.745,&#34;15&#34;:0.47,&#34;5&#34;:0.575}}}}}}
</span></span></code></pre></div><p>如果數據都有送出，就可以回到 kibana 的頁面，看一下目前這個 elasticsearch 集群，有開啟 monitoring 功能的元件們，是否都有正常工作。</p>
<p>http://10.140.0.10/app/monitoring#</p>
<p>頁面長得像這樣</p>


















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="elk/kibana-monitoring.png" alt="" loading="lazy" data-zoomable width="100%" height="100%" /></div>
  </div></figure>

<p>Standalone cluster 中的 filebeat，是還未跟 elasticsearch 配對完成的數據，會顯示在另外一個集群中，配對完後會歸到 elk cluster 中，就是我們的主要 cluster。</p>
<p>點進去可以看各個元件的服務情形。</p>
<h1 id="小結">小結</h1>
<ul>
<li>簡單思考 self-host ELK stack 搭建的架構</li>
<li>在單一 node 上安裝最簡易的 elastic stack</li>
<li>設定元件的 output 位置</li>
<li>設定 self-monitoring</li>
</ul>
<p>恭喜各位獲得一個裸奔但是功能完整的 ELK, 我們下篇再向安全性邁進。</p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/zh-hant/tag/%E9%90%B5%E4%BA%BA%E8%B3%BD2019/">鐵人賽2019</a>
  
  <a class="badge badge-light" href="/zh-hant/tag/gcp/">gcp</a>
  
  <a class="badge badge-light" href="/zh-hant/tag/tls/">tls</a>
  
  <a class="badge badge-light" href="/zh-hant/tag/elasticsearch/">elasticsearch</a>
  
  <a class="badge badge-light" href="/zh-hant/tag/devops/">devops</a>
  
  <a class="badge badge-light" href="/zh-hant/tag/logstash/">logstash</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fchechia.net%2Fzh-hant%2Fpost%2F2019-09-15-self-host-elk-stack-on-gcp%2F&amp;text=Self-host&#43;ELK&#43;stack&#43;-&#43;Installation" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fchechia.net%2Fzh-hant%2Fpost%2F2019-09-15-self-host-elk-stack-on-gcp%2F&amp;t=Self-host&#43;ELK&#43;stack&#43;-&#43;Installation" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=Self-host%20ELK%20stack%20-%20Installation&amp;body=https%3A%2F%2Fchechia.net%2Fzh-hant%2Fpost%2F2019-09-15-self-host-elk-stack-on-gcp%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fchechia.net%2Fzh-hant%2Fpost%2F2019-09-15-self-host-elk-stack-on-gcp%2F&amp;title=Self-host&#43;ELK&#43;stack&#43;-&#43;Installation" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=Self-host&#43;ELK&#43;stack&#43;-&#43;Installation%20https%3A%2F%2Fchechia.net%2Fzh-hant%2Fpost%2F2019-09-15-self-host-elk-stack-on-gcp%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fchechia.net%2Fzh-hant%2Fpost%2F2019-09-15-self-host-elk-stack-on-gcp%2F&amp;title=Self-host&#43;ELK&#43;stack&#43;-&#43;Installation" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      <a href="https://chechia.net/"><img class="avatar mr-3 avatar-circle" src="https://s.gravatar.com/avatar/e56eaaf62e2112055827c197b938d620?s=200" alt="張哲嘉"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://chechia.net/">張哲嘉</a></h5>
      <h6 class="card-subtitle">Site Reliability Engineer</h6>
      <p class="card-text">我的研究領域包括網站可靠性工程、DevOps、Container和Kubernetes。</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/zh-hant/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/chechiachang" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/chechiachang" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.facebook.com/engineer.from.scratch" target="_blank" rel="noopener">
        <i class="fab fa-facebook"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/che-chia-chang-92194a4a/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2023 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.f64289d8217e08e3afcd597d60836062.js"></script>




  

  
  

  













  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  

















<script id="page-data" type="application/json">{"use_headroom":true}</script>


  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>









  
  


<script src="/zh-hant/js/wowchemy.min.29bb000facffd3af35e773e640a66a6f.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">引用</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> 複製
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> 下載
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>


















</body>
</html>
