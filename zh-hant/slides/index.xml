<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Slides | Che-Chia Chang</title>
    <link>https://chechia.net/zh-hant/slides/</link>
      <atom:link href="https://chechia.net/zh-hant/slides/index.xml" rel="self" type="application/rss+xml" />
    <description>Slides</description>
    <generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>zh-Hant</language><lastBuildDate>Sun, 01 Jun 2025 00:45:00 +0000</lastBuildDate>
    <item>
      <title>Workshop: RAGæ‰“é€ ä¼æ¥­AIçŸ¥è­˜åº«ï¼šæŠŠä¸€ç”²å­åŠŸåŠ›å‚³çµ¦æ–°äºº</title>
      <link>https://chechia.net/zh-hant/slides/2025-06-05-devops-rag-internal-ai/</link>
      <pubDate>Sun, 01 Jun 2025 00:45:00 +0000</pubDate>
      <guid>https://chechia.net/zh-hant/slides/2025-06-05-devops-rag-internal-ai/</guid>
      <description>&lt;h3 id=&#34;rag-workshop-è¡Œå‰é€šçŸ¥åŸºæœ¬éœ€æ±‚&#34;&gt;RAG workshop è¡Œå‰é€šçŸ¥ï¼šåŸºæœ¬éœ€æ±‚&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç•¶å¤©å¸¶è‡ªå·±çš„é›»è…¦ã€‚ç•¶å¤©å»ºè­°è‡ªå‚™æ‰‹æ©Ÿç¶²è·¯&lt;/li&gt;
&lt;li&gt;é¸é …1: ç”¨é›»è…¦åœ¨ docker é‹è¡Œé–‹ç™¼ç’°å¢ƒ&lt;/li&gt;
&lt;li&gt;é¸é …2: ç”¨é›»è…¦é ç«¯é€£ç·šè¬›å¸«æä¾›çš„ VMï¼Œåœ¨é ç«¯VM ä¸­é‹è¡Œ docker é–‹ç™¼ç’°å¢ƒ&lt;/li&gt;
&lt;li&gt;æœƒä½¿ç”¨ docker&lt;/li&gt;
&lt;li&gt;æœƒä½¿ç”¨ python èˆ‡ jupyter notebook&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h5 id=&#34;é¸é …1-ä½¿ç”¨è‡ªå·±çš„é›»è…¦-&#34;&gt;é¸é …1: ä½¿ç”¨è‡ªå·±çš„é›»è…¦ ğŸ’»&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨ workshop é–‹å§‹å‰ï¼Œåœ¨è‡ªå·±çš„é›»è…¦ä¸Š
&lt;ol&gt;
&lt;li&gt;å®‰è£ &lt;a href=&#34;https://docs.docker.com/get-started/get-docker/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;docker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;git clone æ•™æ&lt;/li&gt;
&lt;li&gt;å•Ÿå‹• docker é–‹ç™¼ç’°å¢ƒï¼Œä¸‹è¼‰ docker images&lt;/li&gt;
&lt;li&gt;å®‰è£æ‰€éœ€çš„ Python å¥—ä»¶&lt;/li&gt;
&lt;li&gt;é–‹å•Ÿç€è¦½å™¨ï¼Œé€£ç·šåˆ°&lt;a href=&#34;http://localhost:8888&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://localhost:8888&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone https://github.com/chechiachang/rag-workshop.git
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; rag-workshop
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; -it notebook pip install pandas openai qdrant_client tqdm tenacity wget tenacity unstructured markdown ragas sacrebleu langchain_qdrant langchain-openai langchain_openai langchain_community tiktoken ipywidgets
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;ç™»å…¥token&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;workshop1234!&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h5 id=&#34;é¸é …2-ä½¿ç”¨é ç«¯-vm&#34;&gt;é¸é …2: ä½¿ç”¨é ç«¯ VM&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;æœ‰è‡ªå·±çš„é›»è…¦ï¼Œç•¶å¤©å»ºè­°è‡ªå‚™æ‰‹æ©Ÿç¶²è·¯ï¼Œé€£ç·šåˆ°é ç«¯ VM&lt;/li&gt;
&lt;li&gt;æå‰è¨»å†Š tunnel å·¥å…·ï¼ˆæ²’æœ‰æ¥­é…ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://dashboard.ngrok.com/login&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ngrok&lt;/a&gt; ç™»å…¥ Login -&amp;gt; å·¦æ‰‹é‚Š Identity &amp;amp; Access -&amp;gt; Authtokens -&amp;gt; Add Tunnel authtoken -&amp;gt; è¨˜åœ¨å®‰å…¨çš„åœ°æ–¹&lt;/li&gt;
&lt;li&gt;ä¹Ÿå¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://pinggy.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Pinggy&lt;/a&gt;ï¼Œä½†å…è²»æœ‰é™æ™‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å»ºè­°&#34;&gt;å»ºè­°&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å„ªå…ˆä½¿ç”¨å€‹äººé›»è…¦ã€‚æœƒç›¡é‡æä¾›å…è²» VM åé¡ï¼Œä½†ä¾åƒèˆ‡äººæ•¸ä¸ä¿è­‰ç¾å ´æœ‰&lt;/li&gt;
&lt;li&gt;åœ¨å®¶å…ˆè©¦è·‘ä¸€éï¼ŒæŠŠ docker image è·Ÿ pip å¥—ä»¶éƒ½ä¸‹è¼‰å¥½ï¼Œç¾å ´è¦è¼‰å¾ˆä¹…&lt;/li&gt;
&lt;li&gt;è©¦å®Œå¾Œè¨˜å¾—é—œæ‰ ngrokï¼Œä»¥å…ç”¨å®Œæ¯æœˆçš„å…è²»é¡åº¦&lt;/li&gt;
&lt;li&gt;äº‹å…ˆçœ‹å®Œå…§å®¹è¦ºå¾—å¤ªç°¡å–®å¯ä»¥ä¸ç”¨ä¾†ï¼Œä½†æ­¡è¿æœƒå¾Œæ‰¾æˆ‘èŠå¤©ï¼¸ï¼¤&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æŠ•å½±ç‰‡èˆ‡æ•™æèˆ‡å®Œæ•´ç¨‹å¼ç¢¼æ”¾åœ¨ç¶²ç«™ä¸Š&#34;&gt;æŠ•å½±ç‰‡èˆ‡æ•™æèˆ‡å®Œæ•´ç¨‹å¼ç¢¼æ”¾åœ¨ç¶²ç«™ä¸Š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://chechia.net&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://chechia.net&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://chechia.net/zh-hant/slides/2025-06-05-devops-rag-internal-ai/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://chechia.net/zh-hant/slides/2025-06-05-devops-rag-internal-ai/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ğŸ“ &lt;a href=&#34;https://github.com/chechiachang/chechiachang.github.io-src/blob/master/content/zh-hant/slides/2025-06-05-devops-rag-internal-ai/index.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Github æŠ•å½±ç‰‡åŸå§‹ç¢¼èˆ‡è¬›ç¨¿&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä»¥ä¸‹æ˜¯-rag-workshop-ç•¶å¤©å…§å®¹&#34;&gt;ä»¥ä¸‹æ˜¯ RAG Workshop ç•¶å¤©å…§å®¹&lt;/h3&gt;
&lt;p&gt;å¯ä»¥å…ˆçœ‹ï¼Œä¹Ÿå¯ä»¥ç•¶å¤©å†çœ‹&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;rag-workshop-æµç¨‹&#34;&gt;RAG Workshop æµç¨‹&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;10min - &lt;strong&gt;ç’°å¢ƒè¨­å®šï¼šç¢ºå®šåƒèˆ‡è€…éƒ½æœ‰è¨­å®šå¥½é–‹ç™¼ç’°å¢ƒ&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;10min - ç‚ºä»€éº¼éœ€è¦ RAGï¼ˆRetrieval-Augmented Generationï¼‰&lt;/li&gt;
&lt;li&gt;10min - Notebook 2 Embedding èˆ‡å‘é‡æ•¸æ“šåº«&lt;/li&gt;
&lt;li&gt;10min - Notebook 3 Embedding Search&lt;/li&gt;
&lt;li&gt;10min - Notebook 4 DIY&lt;/li&gt;
&lt;li&gt;10min - Notebook 5 Evaluation&lt;/li&gt;
&lt;li&gt;10min - Notebook 6 k8s RAG QA&lt;/li&gt;
&lt;li&gt;20min - DIY + Q&amp;amp;A&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h5 id=&#34;é¸é …1-ä½¿ç”¨è‡ªå·±çš„é›»è…¦&#34;&gt;é¸é …1: ä½¿ç”¨è‡ªå·±çš„é›»è…¦&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;æœ‰åœ¨å®¶å…ˆè©¦è·‘ä¸€éï¼Œæ‡‰è©²å¯ä»¥åœ¨æœ¬åœ°å­˜å– Notebook &lt;a href=&#34;http://localhost:8888&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://localhost:8888&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;åˆ° &lt;a href=&#34;https://workshop.chechia.net&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;workshop.chechia.net&lt;/a&gt; å–å¾— OpenAI Key&lt;/li&gt;
&lt;li&gt;å¯ä»¥è©¦è‘—è·‘ notebook 2-5&lt;/li&gt;
&lt;li&gt;å¿˜è¨˜æ€éº¼å•Ÿå‹•ï¼Œå¯ä»¥å›åˆ°æŠ•å½±ç‰‡æœ€é–‹å§‹&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;notebook token: workshop1234!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;AZURE_OPENAI_API_KEY=&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;AZURE_OPENAI_ENDPOINT=&amp;#34;&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h5 id=&#34;é¸é …2-ä½¿ç”¨é ç«¯-vm-1&#34;&gt;é¸é …2: ä½¿ç”¨é ç«¯ VM&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;è‡³&lt;a href=&#34;https://workshop.chechia.net&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;workshop.chechia.net&lt;/a&gt; é ˜å–ä¸€å° VM ä¸¦ç°½å&lt;/li&gt;
&lt;li&gt;googel sheet å·¦é‚Š urlï¼Œé–‹å•Ÿ bastion é€£ç·š&lt;/li&gt;
&lt;li&gt;Protocol: SSHï¼Œport 22ï¼Œauthentication type: password&lt;/li&gt;
&lt;li&gt;å¸³è™Ÿå¯†ç¢¼åœ¨&lt;a href=&#34;https://workshop.chechia.net&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;workshop.chechia.net&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/azure-bastion_hud0b002e70f9988d619375cc2291231bb_27220_8aa3d767b665df4f846c9f4ea3bf4e4f.webp 400w,
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/azure-bastion_hud0b002e70f9988d619375cc2291231bb_27220_03c55b28d75c2ab6499830cbb3b9c46e.webp 760w,
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/azure-bastion_hud0b002e70f9988d619375cc2291231bb_27220_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2025-06-05-devops-rag-internal-ai/azure-bastion_hud0b002e70f9988d619375cc2291231bb_27220_8aa3d767b665df4f846c9f4ea3bf4e4f.webp&#34;
               width=&#34;359&#34;
               height=&#34;599&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h5 id=&#34;é¸é …2-ä½¿ç”¨-ngrok-é€£ç·šåˆ°-jupyter-notebook&#34;&gt;é¸é …2: ä½¿ç”¨ ngrok é€£ç·šåˆ° jupyter notebook&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;é€²å…¥ VM å¾Œï¼Œä¿®æ”¹ä¸‹é¢ ngrok authtokenã€‚æŒ‡ä»¤ä¸€è¡Œä¸€è¡Œè²¼ä¸Šï¼ˆå³éµï¼‰åˆ° bastion ä¸­åŸ·è¡Œ&lt;/li&gt;
&lt;li&gt;é€é &lt;a href=&#34;https://4d11-52-230-24-207.ngrok-free.app/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://4d11-52-230-24-207.ngrok-free.app/&lt;/a&gt; å°±å¯ä»¥ä½¿ç”¨ notebook (æ¯å€‹äººä¸ä¸€æ¨£)&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd rag-workshop
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NGROK_AUTHTOKEN=&amp;lt;æ”¹æˆä½ çš„token&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sed -i &amp;#34;s/your-token/$NGROK_AUTHTOKEN/&amp;#34; docker-compose.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker logs ngrok
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;t=2025-06-02T06:17:41+0000 lvl=info msg=&amp;#34;started tunnel&amp;#34; obj=tunnels name=command_line addr=http://notebook:8888 url=https://4d11-52-230-24-207.ngrok-free.app
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;ä»¥ä¸Šæ˜¯-workshop-ç’°å¢ƒè¨­å®š&#34;&gt;ä»¥ä¸Šæ˜¯ Workshop ç’°å¢ƒè¨­å®š&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å¾Œé¢ä¸Šèª²éƒ½é€éé€™å€‹ç¶²å€æ“ä½œ&lt;/li&gt;
&lt;li&gt;é‚„æ²’æœ‰çœ‹åˆ° jupyter notebook çš„äººï¼Œè«‹èˆ‰æ‰‹&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;rag-workshop-æµç¨‹-1&#34;&gt;RAG Workshop æµç¨‹&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç’°å¢ƒè¨­å®šï¼šç¢ºå®šåƒèˆ‡è€…éƒ½æœ‰è¨­å®šå¥½é–‹ç™¼ç’°å¢ƒ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç‚ºä»€éº¼éœ€è¦ RAGï¼ˆRetrieval-Augmented Generationï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Embedding èˆ‡å‘é‡æ•¸æ“šåº«&lt;/li&gt;
&lt;li&gt;Embedding Search&lt;/li&gt;
&lt;li&gt;DIY&lt;/li&gt;
&lt;li&gt;Evaluation&lt;/li&gt;
&lt;li&gt;å¯¦éš›æ‡‰ç”¨: ä»¥ k8s official docs ç‚ºä¾‹&lt;/li&gt;
&lt;li&gt;DIY + Q&amp;amp;A&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;çŸ¥è­˜ç²å–æ•ˆç‡åœ¨-devops-çš„é›£é¡Œ&#34;&gt;çŸ¥è­˜ç²å–æ•ˆç‡åœ¨ DevOps çš„é›£é¡Œ&lt;/h3&gt;
&lt;p&gt;åœ¨å¿«é€Ÿè®Šå‹•ã€è³‡è¨Šåˆ†æ•£çš„ç’°å¢ƒä¸­ï¼Œé›£ä»¥å³æ™‚å–å¾—éœ€è¦çš„çŸ¥è­˜ã€‚ã€Œæœ‰ä½†æ‰¾ä¸åˆ°ã€çœ‹ä¸æ‡‚ã€ç”¨ä¸èµ·ä¾†ã€&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;çŸ¥è­˜åˆ†æ•£åœ¨å¤šå€‹ç³»çµ±ã€æ ¼å¼èˆ‡å·¥å…·ä¸­&lt;/li&gt;
&lt;li&gt;çŸ¥è­˜å¤šç‚ºã€Œéœæ…‹æ–‡ä»¶ã€ï¼Œé›£ä»¥äº’å‹•å•ç­”ï¼Œèˆ‰ä¾‹ï¼Œæˆ–æ˜¯æ›å¥è©±èªª&lt;/li&gt;
&lt;li&gt;éš±æ€§çŸ¥è­˜æœªè¢«ç³»çµ±åŒ–å„²å­˜(ä¾‹å¦‚ï¼šå£é ­å‚³æ‰¿ã€slack è¨è«–ã€æœƒè­°ç´€éŒ„ç­‰)&lt;/li&gt;
&lt;li&gt;æŸ¥è©¢æµç¨‹èˆ‡é–‹ç™¼æµç¨‹è„«ç¯€&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æƒ…å¢ƒæ–°äººå·¥ç¨‹å¸«è¦å¦‚ä½•åˆ°-k8s-doc-æŸ¥åˆ°æƒ³è¦çš„å…§å®¹&#34;&gt;æƒ…å¢ƒï¼šæ–°äººå·¥ç¨‹å¸«è¦å¦‚ä½•åˆ° k8s doc æŸ¥åˆ°æƒ³è¦çš„å…§å®¹ï¼Ÿ&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æœ‰å•é¡Œå» google / stack overflow&lt;/li&gt;
&lt;li&gt;éœ€è¦æœå°‹å¼•æ“(k8s doc æœ‰æä¾›ï¼Œä½†å…§éƒ¨æ–‡ä»¶ç³»çµ±ä¸ä¸€å®šæœ‰)&lt;/li&gt;
&lt;li&gt;éœ€è¦é—œéµå­—(æ–°äººæ€éº¼çŸ¥é“è¦æŸ¥ Dynamic Persistent Volume Resizing)&lt;/li&gt;
&lt;li&gt;å”åŠ©ç†è§£ï¼ˆèˆ‰ä¾‹ï¼Œæ›å¥è©±èªªï¼‰&lt;/li&gt;
&lt;li&gt;è·¨èªè¨€é–€æª»&lt;/li&gt;
&lt;/ol&gt;
&lt;aside class=&#34;notes&#34;&gt;
  k8s doc æœ‰æä¾›é—œéµå­—æœå°‹ï¼Œé€™å€‹æœå°‹åŠŸèƒ½æ˜¯æ€éº¼åšçš„ï¼Ÿ
Programmable Search Engineï¼ˆPSEï¼‰https://developers.google.com/custom-search/docs/tutorial/introduction
Fulltext Search Engine ä¾‹å¦‚ elasticsearch ä½¿ç”¨ Lucene
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/search-in-k8s-official-doc_hu5ebc2a73ee3c44bde0730bde6bf194dd_99993_ba0bedbef430605582db8405bbadfdf2.webp 400w,
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/search-in-k8s-official-doc_hu5ebc2a73ee3c44bde0730bde6bf194dd_99993_cbca56289ea87ea85283ee75ee320f80.webp 760w,
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/search-in-k8s-official-doc_hu5ebc2a73ee3c44bde0730bde6bf194dd_99993_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2025-06-05-devops-rag-internal-ai/search-in-k8s-official-doc_hu5ebc2a73ee3c44bde0730bde6bf194dd_99993_ba0bedbef430605582db8405bbadfdf2.webp&#34;
               width=&#34;760&#34;
               height=&#34;408&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;DevOps AI Copilot ä¸æ‡‰è©²åƒåœ–æ›¸é¤¨å®ˆé–€å“¡ç­‰äººä¾†å€Ÿæ›¸ï¼Œ
è€Œæ‡‰è©²åƒå°èˆªç³»çµ±ï¼Œåœ¨ä½ é–‹è»Šæ™‚ä¸»å‹•å‘Šè¨´ä½ ï¼šå‰æ–¹æœ‰å½é“ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;RAG + Context-Aware Knowledge Copilot&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  é€™é‚Šæ‰¯çš„æ¯”è¼ƒé ï¼Œä½†åŸºæœ¬ä¸Šæˆ‘å€‘æœŸå¾…çš„è§£æ±ºæ–¹æ¡ˆæ˜¯é€™æ¨£
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä»€éº¼æ˜¯-rag&#34;&gt;ä»€éº¼æ˜¯ RAG&lt;/h3&gt;
&lt;h5 id=&#34;ragretrieval-augmented-generationæª¢ç´¢å¢å¼·ç”Ÿæˆæ˜¯ä¸€ç¨®çµåˆæª¢ç´¢ç³»çµ±èˆ‡ç”Ÿæˆå¼æ¨¡å‹å¦‚-gptçš„è‡ªç„¶èªè¨€è™•ç†æ¶æ§‹åœ¨ç”Ÿæˆç­”æ¡ˆæ™‚å¼•ç”¨å¤–éƒ¨çŸ¥è­˜ä½¿æ¨¡å‹å›ç­”æ›´æº–ç¢ºä¸”å…·äº‹å¯¦æ ¹æ“š&#34;&gt;RAGï¼ˆRetrieval-Augmented Generationï¼Œæª¢ç´¢å¢å¼·ç”Ÿæˆï¼‰æ˜¯ä¸€ç¨®çµåˆæª¢ç´¢ç³»çµ±èˆ‡ç”Ÿæˆå¼æ¨¡å‹ï¼ˆå¦‚ GPTï¼‰çš„è‡ªç„¶èªè¨€è™•ç†æ¶æ§‹ï¼Œåœ¨ç”Ÿæˆç­”æ¡ˆæ™‚å¼•ç”¨å¤–éƒ¨çŸ¥è­˜ï¼Œä½¿æ¨¡å‹å›ç­”æ›´æº–ç¢ºä¸”å…·äº‹å¯¦æ ¹æ“šã€‚&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Retrievalï¼ˆæª¢ç´¢ï¼‰ï¼š&lt;/strong&gt; å¾ä¸€å€‹å¤–éƒ¨çŸ¥è­˜åº«ï¼ˆå¦‚æ–‡ä»¶ã€å‘é‡è³‡æ–™åº«ç­‰ï¼‰ä¸­æ‰¾åˆ°èˆ‡å•é¡Œç›¸é—œçš„è³‡è¨Šã€‚é€šå¸¸æœƒç”¨èªæ„å‘é‡ï¼ˆembeddingsï¼‰åšç›¸ä¼¼åº¦æœå°‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Generationï¼ˆç”Ÿæˆï¼‰ï¼š&lt;/strong&gt; æŠŠæª¢ç´¢åˆ°çš„å…§å®¹èˆ‡ä½¿ç”¨è€…å•é¡Œä¸€èµ·ä¸Ÿçµ¦ LLMï¼ˆå¦‚ GPTã€Claude ç­‰ï¼‰å»ç”Ÿæˆç­”æ¡ˆã€‚ç”Ÿæˆçš„å…§å®¹æœƒæ›´å…·äº‹å¯¦æ ¹æ“šï¼Œä¸¦èƒ½å¼•ç”¨å…·é«”è³‡æ–™ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;rag-è®“-devops-æ›´æ™ºæ…§å°‘ç¹ç‘£å³æ™‚åæ‡‰&#34;&gt;RAG è®“ DevOps æ›´æ™ºæ…§ã€å°‘ç¹ç‘£ã€å³æ™‚åæ‡‰&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æå‡çŸ¥è­˜ç²å–æ•ˆç‡: å…§éƒ¨æ–‡æª”çŸ¥è­˜AIåŠ©æ‰‹&lt;/li&gt;
&lt;li&gt;çŸ¥è­˜ç•™å­˜èˆ‡æ–°äºº Onboarding&lt;/li&gt;
&lt;li&gt;åŠ é€Ÿæ•…éšœæ’æŸ¥: æ ¹æ“šéŒ¯èª¤è¨Šæ¯è‡ªå‹•å¾ Runbook ä¸­æª¢ç´¢è™•ç†æ–¹å¼&lt;/li&gt;
&lt;li&gt;å„ªåŒ–æµç¨‹è‡ªå‹•åŒ–èˆ‡æå‡æ±ºç­–å“è³ª: é€šè¨Šè»Ÿé«”å°è©± botï¼Œè‡ªå‹•ç”Ÿæˆå»ºè­°&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;rag-vs-å‚³çµ±ç¨‹å¼è¨­è¨ˆtraditional-programming&#34;&gt;RAG vs å‚³çµ±ç¨‹å¼è¨­è¨ˆï¼ˆTraditional Programmingï¼‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦å·¥å…·æå‡çŸ¥è­˜ç²å–æ•ˆç‡ï¼Œå¦‚ä½•é¸æ“‡ RAG æˆ–å‚³çµ±ç¨‹å¼è¨­è¨ˆ&lt;/li&gt;
&lt;li&gt;åœ¨ç‰¹å®šä»»å‹™çš„æ•ˆèƒ½æ˜¯å¦å„ªæ–¼äººé¡&lt;/li&gt;
&lt;li&gt;å“ªè£¡é©åˆç”¨ RAGï¼Œå“ªè£¡é©åˆç”¨å‚³çµ±ç¨‹å¼è¨­è¨ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/rag-vs-code_hu9f4f7a7594cbcf741f81ea0e7ee1d93e_174431_8715252ce2925f2b574cec4bb2d0a84d.webp 400w,
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/rag-vs-code_hu9f4f7a7594cbcf741f81ea0e7ee1d93e_174431_5705bdacf67afc9f8d81663d6d7fea49.webp 760w,
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/rag-vs-code_hu9f4f7a7594cbcf741f81ea0e7ee1d93e_174431_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2025-06-05-devops-rag-internal-ai/rag-vs-code_hu9f4f7a7594cbcf741f81ea0e7ee1d93e_174431_8715252ce2925f2b574cec4bb2d0a84d.webp&#34;
               width=&#34;760&#34;
               height=&#34;481&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  é©åˆç”¨ RAG çš„æƒ…å¢ƒï¼šå®¢æœå•ç­”ã€æŠ€è¡“æœå°‹ã€çŸ¥è­˜å‹ Chatbotã€å…§éƒ¨çŸ¥è­˜å°èˆªã€‚
é©åˆç”¨å‚³çµ±ç¨‹å¼çš„æƒ…å¢ƒï¼šé‡‘æµæ§åˆ¶ã€æµç¨‹å¼•æ“ã€å¸³å‹™ç³»çµ±ã€å®‰å…¨æ§åˆ¶ã€‚
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æœ‰äº†å¤§èªè¨€æ¨¡å‹llmå¾Œæƒ…å¢ƒè®Šæˆ&#34;&gt;æœ‰äº†å¤§èªè¨€æ¨¡å‹ï¼ˆLLMï¼‰å¾Œï¼Œæƒ…å¢ƒè®Šæˆï¼š&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;å» google -&amp;gt; å…ˆå• chatgptï¼Œåˆæ­¥å•ç­”ç†è§£å•é¡Œï¼Œæ‰¾åˆ°é—œéµå­—&lt;/li&gt;
&lt;li&gt;éœ€è¦æœå°‹å¼•æ“ -&amp;gt; chatgpt æ•´åˆï¼Œç›´æ¥ä¸Šç¶²æœå°‹&lt;/li&gt;
&lt;li&gt;éœ€è¦é—œéµå­— -&amp;gt; chatgpt å¹«ä½ æ‰¾åˆ°é—œéµå­—&lt;/li&gt;
&lt;li&gt;å”åŠ©ç†è§£ -&amp;gt; chatgpt èˆ‰ä¾‹ï¼Œæ›å¥è©±èªª&lt;/li&gt;
&lt;li&gt;è·¨èªè¨€é–€æª» -&amp;gt; chatgpt ç¿»è­¯&lt;/li&gt;
&lt;/ol&gt;
&lt;aside class=&#34;notes&#34;&gt;
  chatgpt æœƒç”¨é€šé †çš„èªè¨€å›ç­”å•é¡Œï¼ˆå„ªæ–¼å¹³å‡å·¥ç¨‹å¸«ï¼‰
&lt;/aside&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;chatgpt æœƒç”¨é€šé †çš„èªè¨€ï¼Œå¿«é€Ÿï¼ˆæ•¸ç§’å…§ï¼‰ä¸Šç¶²æœå°‹ï¼Œå›ç­”å•é¡Œ&lt;/li&gt;
&lt;li&gt;éç¨‹ä¸­ä¸å­å…¶ç…©åœ°å•ç­”ï¼Œæ›å¥è©±èªª&lt;/li&gt;
&lt;li&gt;å›ç­”çš„æ ¼å¼é«˜åº¦å®¢è£½åŒ–&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h5 id=&#34;llm-ä¸å…·å‚™å°ˆæ¥­çŸ¥è­˜ç¼ºä¹å…§å®¹æ ¹æ“šæ™‚llm-å®¹æ˜“ç”¢ç”Ÿå¹»è¦ºhallucination&#34;&gt;LLM ä¸å…·å‚™å°ˆæ¥­çŸ¥è­˜ã€‚ç¼ºä¹å…§å®¹æ ¹æ“šæ™‚ï¼ŒLLM å®¹æ˜“ç”¢ç”Ÿå¹»è¦º(hallucination)&lt;/h5&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/llm-hallucination_hu42174c29bc98b9089191b47b3864fba5_212700_9fe73f5f2b5339e829b4fd9ff27bd59e.webp 400w,
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/llm-hallucination_hu42174c29bc98b9089191b47b3864fba5_212700_b69728d4bdba428622aca425a98eed1e.webp 760w,
               /zh-hant/slides/2025-06-05-devops-rag-internal-ai/llm-hallucination_hu42174c29bc98b9089191b47b3864fba5_212700_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2025-06-05-devops-rag-internal-ai/llm-hallucination_hu42174c29bc98b9089191b47b3864fba5_212700_9fe73f5f2b5339e829b4fd9ff27bd59e.webp&#34;
               width=&#34;500&#34;
               height=&#34;500&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  LLMï¼ˆå¤§å‹èªè¨€æ¨¡å‹ï¼‰æœ¬èº«ä¸¦ä¸å…·å‚™äº‹å¯¦çŸ¥è­˜ï¼Œè€Œæ˜¯ä¾è³´è¨“ç·´æ™‚çš„èªæ–™èˆ‡æç¤ºè¼¸å…¥ä¾†ç”Ÿæˆå›ç­”ã€‚ç•¶ç¼ºä¹æ˜ç¢ºä¸Šä¸‹æ–‡æˆ–å…§å®¹æ ¹æ“šæ™‚ï¼ŒLLM å®¹æ˜“å‡ºç¾ã€Œå¹»è¦ºã€ç¾è±¡ï¼Œå³ç”Ÿæˆçœ‹ä¼¼åˆç†ä½†å¯¦éš›ä¸æ­£ç¢ºçš„è³‡è¨Šã€‚å°ˆæ¥­é ˜åŸŸå•é¡Œè‹¥æœªæä¾›æº–ç¢ºè³‡æ–™æ”¯æ’ï¼Œä¹Ÿå®¹æ˜“å°è‡´éŒ¯èª¤å›ç­”ã€‚
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;rag-workshop-æµç¨‹-2&#34;&gt;RAG Workshop æµç¨‹&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç’°å¢ƒè¨­å®šï¼šç¢ºå®šåƒèˆ‡è€…éƒ½æœ‰è¨­å®šå¥½é–‹ç™¼ç’°å¢ƒ&lt;/li&gt;
&lt;li&gt;ç‚ºä»€éº¼éœ€è¦ RAGï¼ˆRetrieval-Augmented Generationï¼‰
&lt;ol&gt;
&lt;li&gt;RAG åœ¨ã€Œæ–‡ä»¶æª¢ç´¢èˆ‡æç¤ºã€ä¸Šå„ªæ–¼äººé¡&lt;/li&gt;
&lt;li&gt;LLM è£œå¼·å·¥ç¨‹å¸«çš„èªè¨€èƒ½åŠ›&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Embedding èˆ‡å‘é‡æ•¸æ“šåº«&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Embedding Search&lt;/li&gt;
&lt;li&gt;DIY&lt;/li&gt;
&lt;li&gt;Evaluation&lt;/li&gt;
&lt;li&gt;k8s RAG QA.ipynb&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;rag-workshop-æµç¨‹-3&#34;&gt;RAG Workshop æµç¨‹&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç¢ºå®šåƒèˆ‡è€…éƒ½æœ‰è·‘ä¸€å¥—RAGèµ·ä¾†&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Evaluation&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;k8s RAG QA.ipynb&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¦‚ä½•è©•ä¼°-rag-ç³»çµ±çš„å“è³ª&#34;&gt;å¦‚ä½•è©•ä¼° RAG ç³»çµ±çš„å“è³ª?&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;äººäººéƒ½æœƒä¸‹ promptï¼Œä½†æ˜¯èª°çš„ prompt æ›´å¥½ï¼Ÿæˆ–æ˜¯æ²’å·®åˆ¥ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•é¸æ“‡ vector store çš„ chunking ç­–ç•¥ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å“ªå€‹ retriever æ›´å¥½ï¼Ÿ&lt;/li&gt;
&lt;li&gt;è¦å¦‚ä½•æŒçºŒæ”¹å–„ RAG ç³»çµ±ï¼Ÿä¸‹å€‹è¿­ä»£çš„æ”¹å–„æ–¹å‘æ˜¯ä»€éº¼ï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;-è©•ä¼°ç›®çš„ç¢ºä¿å›ç­”å“è³ªå¯é æ€§èˆ‡å¯æ§æ€§&#34;&gt;ğŸ¯ è©•ä¼°ç›®çš„ï¼šç¢ºä¿å›ç­”å“è³ªã€å¯é æ€§èˆ‡å¯æ§æ€§&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä¿è­‰æ­£ç¢ºæ€§ï¼šæª¢ç´¢å‡ºçš„è³‡è¨Šæ˜¯æ­£ç¢ºçš„ï¼Œç”Ÿæˆçš„ç­”æ¡ˆå¿ å¯¦æ–¼åŸå§‹ context&lt;/li&gt;
&lt;li&gt;é™ä½å¹»è¦ºé¢¨éšªï¼šå³ä½¿æœ‰è³‡æ–™ï¼ŒLLM ä»å¯èƒ½äº‚ç·¨&lt;/li&gt;
&lt;li&gt;æ¸¬é‡ç³»çµ±å“è³ª&lt;/li&gt;
&lt;li&gt;æ”¹å–„ä¾æ“šï¼šå¹«åŠ©é©—è­‰Chunking ç­–ç•¥ï¼ŒPrompt è¨­è¨ˆï¼ŒRetriever æ¨¡å‹èª¿æ•´&lt;/li&gt;
&lt;li&gt;è‡ªå‹•åŒ–ç›£æ§ï¼šå“è³ªè¿½è¹¤ã€å•é¡Œå®šä½ï¼Œå»ºç«‹é¡ä¼¼ APM çš„ QA æŒ‡æ¨™&lt;/li&gt;
&lt;li&gt;å° Stakeholder å±•ç¤ºæˆæ•ˆï¼šå¯è¦–åŒ–èˆ‡é‡åŒ–æŒ‡æ¨™ï¼Œæœ‰åŠ©æºé€šèˆ‡è³‡æºæŠ•å…¥&lt;/li&gt;
&lt;/ol&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;è©•ä¼°æ–¹å¼å»ºè­°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Retrievalï¼šRecall@K, MRR, nDCG&lt;/li&gt;
&lt;li&gt;Generationï¼šROUGE, BERTScore, GPTScore&lt;/li&gt;
&lt;li&gt;Faithfulnessï¼šä¾æ“šä¾†æºè³‡æ–™ç”Ÿæˆï¼Ÿ&lt;/li&gt;
&lt;li&gt;äººå·¥æ¨™è¨»ï¼šç›¸é—œæ€§ã€æ­£ç¢ºæ€§ã€å¹«åŠ©ç¨‹åº¦&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;rag-æ‡‰ç”¨-ä»¥-k8s-official-docs-ç‚ºä¾‹&#34;&gt;RAG æ‡‰ç”¨: ä»¥ k8s official docs ç‚ºä¾‹&lt;/h3&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¸½çµ&#34;&gt;ç¸½çµ&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ç‚ºä»€éº¼éœ€è¦ RAGï¼ˆRetrieval-Augmented Generationï¼‰&lt;/li&gt;
&lt;li&gt;Embedding èˆ‡å‘é‡æ•¸æ“šåº«&lt;/li&gt;
&lt;li&gt;Embedding Search&lt;/li&gt;
&lt;li&gt;DIY&lt;/li&gt;
&lt;li&gt;Evaluation&lt;/li&gt;
&lt;li&gt;k8s RAG QA.ipynb&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;maicoin-we-are-hiring&#34;&gt;MaiCoin: We are Hiring!!&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linkedin.com/jobs/view/4236558674/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Senior Site Reliability Engineer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linkedin.com/jobs/view/4236555801&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Senior Data Engineer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linkedin.com/jobs/view/4236555811&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Senior IT Engineer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linkedin.com/jobs/view/4236556713&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Blockchain Engineer (Wallet Team)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linkedin.com/jobs/view/4236558714&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Senior Backend Engineer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linkedin.com/jobs/view/4236523560/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Micro Service Software Engineer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linkedin.com/jobs/view/4236559632&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cyber Security Engineer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;diy--qa--å»ºè­°&#34;&gt;DIY + Q&amp;amp;A + å»ºè­°&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;ä¸‹æ¬¡æœƒæ”¹ç”¨ Colab&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>Hashicorp: managed database credentials with Hashicorp Vault</title>
      <link>https://chechia.net/zh-hant/slides/2024-08-28-hashicorp-vault-database/</link>
      <pubDate>Tue, 20 Aug 2024 11:00:00 +0000</pubDate>
      <guid>https://chechia.net/zh-hant/slides/2024-08-28-hashicorp-vault-database/</guid>
      <description>
&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;onepiece.png&#34;
  &gt;

&lt;aside class=&#34;notes&#34;&gt;
  æŠ•å½±ç‰‡è·Ÿè¬›ç¨¿æˆ‘éƒ½æ”¾åœ¨æˆ‘çš„ç¶²ç«™ä¸Šï¼Œå¦‚æœæœ‰èˆˆè¶£å¯ä»¥åƒè€ƒ
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;Vault: Managed Database Credentials&lt;/p&gt;
&lt;p&gt;with Hashicorp Vault&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Che Chia Chang&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;About Me&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Che Chia Chang&lt;/li&gt;
&lt;li&gt;SRE @ &lt;a href=&#34;https://www.linkedin.com/company/maicoin/jobs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Maicoin&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://mvp.microsoft.com/zh-TW/MVP/profile/e407d0b9-5c01-eb11-a815-000d3a8ccaf5&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Microsoft MVP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;chechia.net&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/mvp_huc01bc5a7b3b6fc804f96fcdc92de363e_32781_d6d605938b7a1c7fce3c5b400c9fc5d1.webp 400w,
               /media/mvp_huc01bc5a7b3b6fc804f96fcdc92de363e_32781_ad9bd2dee793a0109cd1099b629c6ffc.webp 760w,
               /media/mvp_huc01bc5a7b3b6fc804f96fcdc92de363e_32781_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/media/mvp_huc01bc5a7b3b6fc804f96fcdc92de363e_32781_d6d605938b7a1c7fce3c5b400c9fc5d1.webp&#34;
               width=&#34;20%&#34;
               height=&#34;20%&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;p&gt;ç›¸é—œè³‡æº&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/chechiachang/vault-playground&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Demo ç¯„ä¾‹ç¨‹å¼ç¢¼ https://github.com/chechiachang/vault-playground&lt;/a&gt; &lt;strong&gt;Demo ç”¨é€”ï¼Œè«‹å……åˆ†ç†è§£å¾Œå†ä½¿ç”¨&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://chechia.net/zh-hant/talk/hashicorp-managed-database-credentials-with-hashicorp-vault/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»Šæ—¥æŠ•å½±ç‰‡èˆ‡è¬›ç¨¿èˆ‡å…¶ä»–è³‡æº chechia.net&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://chechia.net/zh-hant/talk/hashicorp-vault-on-aws-k8s-%E9%9B%B2%E7%AB%AF%E5%9C%B0%E7%AB%AF%E9%80%9A%E5%90%83%E7%9A%84%E7%A7%81%E9%91%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;2023 Vault é›²ç«¯çš„ç«¯é€šåƒçš„ç§é‘°ç®¡ç†å¹³å°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://ithelp.ithome.com.tw/users/20120327/ironman/4057&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾é›¶é–‹å§‹å­¸Terraformæ‰‹æŠŠæ‰‹å…¥é–€&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;å¤§ç¶±&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DB å¸³è™Ÿå¯†ç¢¼ç®¡ç†çš„é›£é¡Œ&lt;/li&gt;
&lt;li&gt;Vault DB &lt;strong&gt;secret engine&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Demo 1 éœ€è¦æ™‚è‡ªå‹•ç”¢ç”Ÿè³‡æ–™åº«å¸³è™Ÿå¯†ç¢¼&lt;/li&gt;
&lt;li&gt;Vault &lt;strong&gt;auth method&lt;/strong&gt; ç¬¬ä¸‰æ–¹èªè­‰èº«ä»½&lt;/li&gt;
&lt;li&gt;Demo 2 github login and auth&lt;/li&gt;
&lt;li&gt;ç¨‹å¼åŒ–æ¬Šé™ç®¡ç†èˆ‡ç¨½æŸ¥&lt;/li&gt;
&lt;li&gt;Demo 3 &lt;strong&gt;terraform&lt;/strong&gt; è¨­å®š vault èˆ‡ DB secret engine&lt;/li&gt;
&lt;li&gt;(çœ‹æ™‚é–“) monitoring / audit&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;DB å¸³è™Ÿå¯†ç¢¼ç®¡ç†çš„é›£é¡Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;èªè­‰(Authentication)
&lt;ul&gt;
&lt;li&gt;å¯†ç¢¼ä¿ç®¡èˆ‡æš´éœ²&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æˆæ¬Š(Authorization)&lt;/li&gt;
&lt;li&gt;å¯†ç¢¼æ›´æ–°&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;èªè­‰å¯ä»¥æ›´å¥½
æˆæ¬Šå¯ä»¥æ›´å½ˆæ€§æ–¹ä¾¿
å¯†ç¢¼æ›´æ–°å¯ä»¥æ›´é »ç¹
å¯†ç¢¼æš´éœ²é¢¨éšªå¯ä»¥è¢«å‹•æ§åˆ¶&lt;/p&gt;
&lt;p&gt;é‡è¦ç¨‹åº¦ç¬¬ä¸€è€ƒé‡æ˜¯è³‡è¨Šå®‰å…¨
ç¬¬äºŒæ˜¯ç®¡ç†æ–¹ä¾¿åº¦ï¼Œæœ‰æ²’æœ‰ utility å¯ä»¥å¹«æˆ‘å€‘ç®¡ç†&lt;/p&gt;
&lt;p&gt;åº•ä¸‹é€éä¸€å€‹ user story ä¾†èªªæ˜é€™äº›é›£é¡Œ&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Authentication èªè­‰&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;you are who you say you are&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Authorization æˆæ¬Š&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;you are allowed to do what you are trying to do&lt;/p&gt;
&lt;/blockquote&gt;
&lt;aside class=&#34;notes&#34;&gt;
  åè©è§£é‡‹
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;User Story&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€å€‹appï¼Œç‚ºappè¨­å®šäº†ä¸€å€‹è³‡æ–™åº«&lt;/li&gt;
&lt;li&gt;è³‡æ–™åº«å­˜æ”¾appè³‡æ–™ï¼Œåªæœ‰appèƒ½å­˜å–è³‡æ–™&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨&lt;strong&gt;å¸³è™Ÿå¯†ç¢¼&lt;/strong&gt;èªè­‰ï¼Œappå¯ä»¥å­˜å–è³‡æ–™åº«&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;app(username=app, password) &amp;gt; DB&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DB &amp;gt; hi, app!&lt;/strong&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  å¸‚é¢ä¸Šæœ‰å¾ˆå¤šè³‡æ–™åº«ï¼Œéƒ½æ˜¯ä½¿ç”¨å¸³è™Ÿå¯†ç¢¼ä¾†èªè­‰appçš„èº«ä»½
ç”¢ç”Ÿç¬¬ä¸€å€‹é›£é¡Œï¼Œå°±æ˜¯å¸³è™Ÿå¯†ç¢¼çš„å­˜æ”¾èˆ‡ç®¡ç†
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/èªè­‰&lt;/p&gt;
&lt;p&gt;å°æ–¼è³‡æ–™åº«ä¾†èªªï¼Œ&lt;strong&gt;username=app&lt;/strong&gt;çš„äººï¼Œå°±æ˜¯app&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æœ‰å¸³è™Ÿå¯†ç¢¼æ˜¯å¦å°±ç›¸ä¿¡ä»–æ˜¯appï¼Ÿ&lt;/li&gt;
&lt;li&gt;æœ‰æ²’æœ‰è³¬è™Ÿå¯†ç¢¼ä»¥å¤–çš„æ–¹å¼ç¢ºèªappçš„èº«ä»½ï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;aside class=&#34;notes&#34;&gt;
  ç„¶è€Œé€™è·Ÿæˆ‘å€‘çš„ user story é‚„æ˜¯æœ‰è½å·®
å…¶ä¸­ä¹Ÿéš±è—è³‡å®‰é¢¨éšª
æˆ‘å€‘å¾ˆç¿’æ…£ä½¿ç”¨å¸³è™Ÿå¯†ç¢¼ä¾†èªè­‰èº«ä»½ï¼Œä½†æ˜¯éš¨è‘—æ™‚ä»£æ¼”é€²ï¼Œé§­å®¢æœ‰æ›´å¤šæ–¹æ³•å–å¾—å¸³è™Ÿå¯†ç¢¼
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/èªè­‰/å¯†ç¢¼ä¿ç®¡èˆ‡æš´éœ²&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;dba éœ€è¦é–‹ç™¼dbï¼Œæ‰‹ä¸Šæœ‰adminå¸³è™Ÿå¯†ç¢¼&lt;/li&gt;
&lt;li&gt;è³‡å®‰é¢¨éšª
&lt;ul&gt;
&lt;li&gt;é–‹ç™¼æ©Ÿå™¨å®‰è£æƒ¡æ„è»Ÿé«”/å´éŒ„å¯†ç¢¼&lt;/li&gt;
&lt;li&gt;å¸³è™Ÿå¯†ç¢¼è¢«ç«Šå–&lt;/li&gt;
&lt;li&gt;å“¡å·¥åˆ†é–‹ç§äººèˆ‡å…¬å¸é›»è…¦&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  é§­å®¢å°‡é–‹æºçš„å·¥å…·ä¿®æ”¹ï¼Œå¢åŠ å¾Œé–€ï¼Œç„¶å¾Œ release çµ¦ admin
å¤ éç¤¾äº¤å·¥ç¨‹ï¼Œè®“ admin ä¸çŸ¥ä¸è¦ºå®‰è£äº†æƒ¡æ„è»Ÿé«”
å¾ˆé–‹å¿ƒæ‹¿ä¾†ç”¨ï¼Œä½†æ˜¯é€™å€‹å·¥å…·å´éŒ„äº† admin çš„å¸³è™Ÿå¯†ç¢¼
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/èªè­‰/å¯†ç¢¼æš´éœ²&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ›´åš´è¬¹çš„èº«ä»½ç¢ºèªï¼Œæ›´é›£è¢«ç ´è§£
&lt;ul&gt;
&lt;li&gt;ex Client Certificate Authentication&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å®‰å…¨çš„å­˜æ”¾å¯†ç¢¼ï¼Œé¿å…å¯†ç¢¼æš´éœ²&lt;/li&gt;
&lt;li&gt;æ›´å¥½çš„åšæ³•
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸è¦å­˜æ”¾å¯†ç¢¼ï¼Œå»èƒ½ä½¿ç”¨å¯†ç¢¼??&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;æ”¾åœ¨ Vault è£¡é¢&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;ä»¥å¾€æˆ‘å€‘æ²’æœ‰æ›´å¥½çš„æ–¹å¼ä¾†ç¢ºèªappçš„èº«ä»½ï¼Œæ‰€ä»¥åªèƒ½ä½¿ç”¨å¸³è™Ÿå¯†ç¢¼
é‡å°å¯†ç¢¼å¼·åº¦ï¼Œç¾åœ¨æœ‰æ›´å¥½çš„æ–¹å¼ä¾†ç¢ºèªappçš„èº«ä»½ï¼Œä¾‹å¦‚ Client Certificate Authentication
æä¾›æ›´åš´è¬¹çš„èº«ä»½ç¢ºèªï¼Œç¾åœ¨è¨±å¤šè³‡æ–™åº«éƒ½æ”¯æ´ tlsï¼Œå¯ä»¥é€étlsä¾†ç¢ºèªappçš„èº«ä»½
å®Œæ•´çš„èªè­‰ï¼Œå…¬æ­£çš„ ca ç°½ç™¼ï¼Œcerts å¾ˆé›£è¢«æš´åŠ›ç ´è§£&lt;/p&gt;
&lt;p&gt;æˆ‘å€‘è¦é¢å°çš„æ˜¯å¦å¤–ä¸€å±¤çš„é¢¨éšªï¼Œå°±æ˜¯å¯†ç¢¼æš´éœ²
å°±ç®—ä½ æ‰‹ä¸Šæ˜¯æœ‰ä¸€å€‹å¾ˆå¼·çš„å¯†ç¢¼ï¼Œä½†æ˜¯ä½ çš„é–‹ç™¼æ©Ÿå™¨è¢«é§­ï¼Œå¯†ç¢¼å°±è¢«ç«Šå–äº†
dba æ‰‹ä¸Šæœ‰å­˜ admin å¸³è™Ÿå¯†ç¢¼çš„
æœ‰ç”¨å¯†ç¢¼ç®¡ç†å™¨ 1password ï¼Œæœ‰æ¯”è¼ƒå¥½ï¼Œå› ç‚ºä»–å¹«ä½ åšåŠ å¯†èˆ‡å„²å­˜ï¼Œä½†ä¹Ÿä¸èƒ½æœŸå¾… 1password æ°¸ä¸è¢«é§­
å¦‚æœä½ æ‰‹ä¸Šçš„å¯†ç¢¼é‡è¦ç¨‹åº¦éå¸¸é«˜ï¼Œé«˜éå¯†ç¢¼å·¥å…·å¯ä»¥æ‰¿æ“”çš„é¢¨éšªï¼Œé‚£ä½ å°±è¦è€ƒæ…®ä½¿ç”¨æ›´å®‰å…¨çš„æ–¹å¼ä¾†ç®¡ç†å¯†ç¢¼&lt;/p&gt;
&lt;p&gt;æœ‰æ²’æœ‰å¯èƒ½ dba/sre æ‰‹ä¸Šä¸è¦æœ‰å¸³è™Ÿå¯†ç¢¼ï¼Œè€Œæ˜¯ç”±å…§ç¶²çš„ vault ä¾†ç®¡ç†å¸³è™Ÿå¯†ç¢¼&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/secrets/databases&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Vault DB secret engine&lt;/a&gt;&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/vault/secret-database-flow_hucf0bd76ccd01fc5e85e88f0f3b42ba2d_27443_35a1884aeacb35c29264a054e10ce68f.webp 400w,
               /media/vault/secret-database-flow_hucf0bd76ccd01fc5e85e88f0f3b42ba2d_27443_a23c35c2ae98acc4f9cadfe7fd6beb09.webp 760w,
               /media/vault/secret-database-flow_hucf0bd76ccd01fc5e85e88f0f3b42ba2d_27443_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/media/vault/secret-database-flow_hucf0bd76ccd01fc5e85e88f0f3b42ba2d_27443_35a1884aeacb35c29264a054e10ce68f.webp&#34;
               width=&#34;90%&#34;
               height=&#34;90%&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/secrets/databases&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Vault DB secret engine&lt;/a&gt;&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://www.datocms-assets.com/2885/1576778435-vault-db.png?fit=max&amp;amp;q=80&amp;amp;w=2000&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable width=&#34;90%&#34; height=&#34;90%&#34; /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/secrets/databases&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Vault DB secret engine&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦æ™‚è‡ªå‹•ç”¢ç”ŸDBä½¿ç”¨è€…å¯†ç¢¼&lt;/li&gt;
&lt;li&gt;çŸ­æ•ˆæœŸä½¿ç”¨è€…èˆ‡å¯†ç¢¼ ex 1hr&lt;/li&gt;
&lt;li&gt;ä¸å»¶å±•è‡ªå‹•åˆ°æœŸï¼Œåˆªé™¤ä½¿ç”¨è€…&lt;/li&gt;
&lt;li&gt;æœªå®Œæˆå·¥ä½œå¯ä»¥è‡ªå‹•å»¶å±•&lt;/li&gt;
&lt;li&gt;appå¯ä»¥ä¸€ç›´å–å¾—æ–°ä½¿ç”¨è€…èˆ‡å¯†ç¢¼&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;User Story (v2)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åªæœ‰ vault æœ‰ admin å¯†ç¢¼&lt;/li&gt;
&lt;li&gt;user éœ€è¦æ™‚ï¼Œvault å‹•æ…‹ç”¢ç”Ÿ&lt;strong&gt;çŸ­æ•ˆæœŸä½¿ç”¨è€…èˆ‡å¯†ç¢¼&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ•ˆæœŸåˆ°è‡ªå‹•åˆªé™¤&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ vault library ç¨‹å¼åŒ–é€£ç·š db
&lt;ul&gt;
&lt;li&gt;ä¸åœ¨é–‹ç™¼æ©Ÿå™¨ä¸Šå­˜å¯†ç¢¼&lt;/li&gt;
&lt;li&gt;ä¸æ‰‹å‹•è¼¸å…¥å¯†ç¢¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;Vault DB secret engine æ”¯æ´ï¼Œæ²’æ”¯æ´å¯ä»¥è‡ªå·±å¯« plugin&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/vault/vault-secrets-databases_hud58a0e525517570057b3257917594d7a_260292_b88115a14e6e31ec40a3cf86015e92cd.webp 400w,
               /media/vault/vault-secrets-databases_hud58a0e525517570057b3257917594d7a_260292_ea64439a37fc602255503ad4101d0742.webp 760w,
               /media/vault/vault-secrets-databases_hud58a0e525517570057b3257917594d7a_260292_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/media/vault/vault-secrets-databases_hud58a0e525517570057b3257917594d7a_260292_b88115a14e6e31ec40a3cf86015e92cd.webp&#34;
               width=&#34;90%&#34;
               height=&#34;90%&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;p&gt;Demo 1: Vault DB secret engine&lt;/p&gt;
&lt;p&gt;Setup&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone git@github.com:chechiachang/vault-playground.git
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd vault-playground/deploy/04-docker-and-db/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker-compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker ps
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker exec -it 04-docker-and-db-mariadb_1-1 bash
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker exec -it 04-docker-and-db-vault_1-1 sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;apk update &amp;amp;&amp;amp; apk add mysql-client
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mysql -h mariadb_1 -u root -p
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;Demo 1: Vault DB secret engine&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// Connect to docker vault
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;export VAULT_ADDR=http://127.0.0.1:8200
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault login
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault secrets list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// Configure secret engine database (terraform)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault secrets list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd usage/03-terraform-lives
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;terragrunt init
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;terragrunt apply
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;Demo 1: Vault DB secret engine&lt;/p&gt;
&lt;p&gt;Use database secret engine&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// root configure (already done by terraform)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault secrets list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault list localhost_mariadb/config
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault read localhost_mariadb/config/localhost_mariadb 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault list localhost_mariadb/roles
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault read localhost_mariadb/roles/database_admin
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy read dba
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// create token for dba (will automatically done in Demo 2)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault token create -policy=dba -display-name=dba \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -ttl=1h -use-limit=5
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;Demo 1: Vault DB secret engine&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// auth as dba
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault login
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault read localhost_mariadb/creds/database_admin
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mysql --sql -h localhost -u &amp;lt;username&amp;gt; -p
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// do dba things
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;show databases;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;select user from mysql.user;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;exit
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;è§£æ±ºå­˜æ”¾èˆ‡å–ç”¨ï¼Œå›åˆ°é›£é¡Œ/èªè­‰&lt;/p&gt;
&lt;p&gt;å°æ–¼è³‡æ–™åº«ä¾†èªªï¼Œ&lt;strong&gt;username=app&lt;/strong&gt;çš„äººï¼Œå°±æ˜¯app&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æœ‰å¸³è™Ÿå¯†ç¢¼æ˜¯å¦å°±ç›¸ä¿¡ä»–æ˜¯appï¼Ÿ&lt;/li&gt;
&lt;li&gt;æœ‰æ²’æœ‰è³¬è™Ÿå¯†ç¢¼ä»¥å¤–çš„æ–¹å¼ç¢ºèªappçš„èº«ä»½ï¼Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;Vault çš„è§£æ±ºæ–¹æ¡ˆ&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /media/vault/vault-identity-based-security_hu402a17fe06332c2e538a5d7636449ecf_286984_5179beccc62b906442cf3110172671f2.webp 400w,
               /media/vault/vault-identity-based-security_hu402a17fe06332c2e538a5d7636449ecf_286984_68081a16f8fb054125c67b67c563be91.webp 760w,
               /media/vault/vault-identity-based-security_hu402a17fe06332c2e538a5d7636449ecf_286984_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/media/vault/vault-identity-based-security_hu402a17fe06332c2e538a5d7636449ecf_286984_5179beccc62b906442cf3110172671f2.webp&#34;
               width=&#34;90%&#34;
               height=&#34;90%&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/èªè­‰/Vault &lt;strong&gt;Auth method&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Vault ä»°è³´å¤–éƒ¨å¯ä¿¡ç¬¬ä¸‰æ–¹(trusted authority)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;user/app é€éç¬¬ä¸‰æ–¹å‹•æ…‹å–å¾—åˆæ³•çš„èº«ä»½&lt;/li&gt;
&lt;li&gt;aws / azure / gcp iam role / github / saml / LDAP &amp;hellip;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é–‹ç™¼æ©Ÿå™¨ä¸Šæ²’æœ‰å¯†ç¢¼ï¼Œå°±ä¸æœƒå› ç‚ºæ©Ÿå™¨è¢«é§­/å´éŒ„ï¼Œé€ æˆå¯†ç¢¼æ´©æ¼&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  Vault ä»°è³´å¤–éƒ¨å¯ä¿¡ç¬¬ä¸‰æ–¹(trusted authority)
æŠŠlocalé–‹ç™¼æ©Ÿå™¨è¢«é§­çš„é¢¨éšªï¼Œè½‰ç§»åˆ°å…¶ä»–æ›´å®‰å…¨çš„åœ°æ–¹
aws / azure / gcp iam role / github / saml
å…§ç¶²çš„Vault
LDAP
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/èªè­‰/Vault Auth method/AWS&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IAM auth method&lt;/li&gt;
&lt;li&gt;EC2 auth method
&lt;ul&gt;
&lt;li&gt;é€é AWS API å»ç¢ºèªèº«ä»½&lt;/li&gt;
&lt;li&gt;ç™»å…¥çš„ aws user / åˆæ³•çš„ iam role&lt;/li&gt;
&lt;li&gt;vault é€é aws api å»æ ¸å°èº«ä»½&lt;/li&gt;
&lt;li&gt;æ ¸å°æ­£ç¢ºï¼Œvault æä¾›çŸ­æœŸ database credential çµ¦ user / app&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/auth/aws&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;app è·‘åœ¨ Ec2 ä¸Šï¼Œä½¿ç”¨ Ec2 åšèªè­‰&lt;/a&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2024-08-28-hashicorp-vault-database/aws-auth-method_hu1b1088a0ba6f2509d5f251f49d805b90_161953_7ff24fbb2d3a1787febad7191f4de8ba.webp 400w,
               /zh-hant/slides/2024-08-28-hashicorp-vault-database/aws-auth-method_hu1b1088a0ba6f2509d5f251f49d805b90_161953_b34a552ce4f4dfc84d2e66a752b4b84e.webp 760w,
               /zh-hant/slides/2024-08-28-hashicorp-vault-database/aws-auth-method_hu1b1088a0ba6f2509d5f251f49d805b90_161953_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2024-08-28-hashicorp-vault-database/aws-auth-method_hu1b1088a0ba6f2509d5f251f49d805b90_161953_7ff24fbb2d3a1787febad7191f4de8ba.webp&#34;
               width=&#34;90%&#34;
               height=&#34;90%&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;EC2 auth method
å¦‚æœä½ æœ‰ä½¿ç”¨ aws ec2ï¼Œå¯ä»¥é€é aws api ä¾†å–å¾— iam role / ec2 metadata&lt;/p&gt;
&lt;p&gt;ç”±æ–¼ database æœ¬èº«çš„èªè­‰æ©Ÿåˆ¶æœ‰é™ï¼Œæˆ‘å€‘å¯ä»¥é€é vault ä¾†ç®¡ç†å¸³è™Ÿå¯†ç¢¼
å°‡ç™»å…¥çš„è³‡å®‰ç®¡ç†äº¤çµ¦æ›´åš´è¬¹çš„ç¬¬ä¸‰æ–¹&lt;/p&gt;
&lt;p&gt;aws login æ¯”å–®ç´” mysql login å®‰å…¨ï¼Œå› ç‚ºå¤šäº†æ›´å¤šèªè­‰æª¢æŸ¥
access key / password / MFA
ip ä¾†æºæª¢æŸ¥
ratelimit
DDOS protection
æœ‰å•é¡Œæ™‚æœƒæœ‰ audit log&lt;/p&gt;
&lt;p&gt;auth method æ··æ­
å¯ä»¥é¢å°ä¸åŒçš„è³‡å®‰é¢¨éšª&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://www.hashicorp.com/blog/dynamic-database-credentials-with-vault-and-kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;app è·‘åœ¨ Kubernetes ä¸Šï¼Œä½¿ç”¨ Service Account åšèªè­‰&lt;/a&gt;&lt;/p&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://www.datocms-assets.com/2885/1578078487-screen-shot-2020-01-03-at-19-07-14.png?fit=max&amp;amp;q=80&amp;amp;w=2000&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable width=&#34;90%&#34; height=&#34;90%&#34; /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨ Vault auth methodï¼Œä¿¡ä»»ç¬¬ä¸‰æ–¹å–å¾—èº«ä»½
å¾é›™æ–¹æŸ¥æ ¸ï¼Œè®Šæˆä¸‰æ–¹æŸ¥æ ¸&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/auth&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœ‰æ”¯æ´çš„ auth methodï¼Œå¯ä»¥è‡ªå·±æ­é…&lt;/a&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2024-08-28-hashicorp-vault-database/auth-methods_hu66061cce719dc6d5d1ccf40fb31e1212_513352_8db173cd34745c666206ef66a8a4b3e4.webp 400w,
               /zh-hant/slides/2024-08-28-hashicorp-vault-database/auth-methods_hu66061cce719dc6d5d1ccf40fb31e1212_513352_8f1549438652c6fc209b8b5e6cd78328.webp 760w,
               /zh-hant/slides/2024-08-28-hashicorp-vault-database/auth-methods_hu66061cce719dc6d5d1ccf40fb31e1212_513352_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2024-08-28-hashicorp-vault-database/auth-methods_hu66061cce719dc6d5d1ccf40fb31e1212_513352_8db173cd34745c666206ef66a8a4b3e4.webp&#34;
               width=&#34;90%&#34;
               height=&#34;90%&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;ul&gt;
&lt;li&gt;user auth method
&lt;ul&gt;
&lt;li&gt;aws/gcp/azure iam role, github, saml, LDAP&lt;/li&gt;
&lt;li&gt;Login MFA&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;appä½¿ç”¨auth methodèªè­‰
&lt;ul&gt;
&lt;li&gt;aws/gcp/azure iam role (ec2 role)&lt;/li&gt;
&lt;li&gt;kubernetes api server (pod service account)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;User Story (v3)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åªåšä¸€æ¬¡ï¼šVault è¨­å®š DB secret engine&lt;/li&gt;
&lt;li&gt;user æœ¬æ©Ÿä¸å­˜æ”¾ DB å¸³è™Ÿå¯†ç¢¼&lt;/li&gt;
&lt;li&gt;user/app é€é Vault auth method
&lt;ul&gt;
&lt;li&gt;user aws iam role&lt;/li&gt;
&lt;li&gt;app k8s service account&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;user/appå¯ä»¥å­˜å–vaultä¸­çš„dbå¸³è™Ÿå¯†ç¢¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;app &amp;gt; trusted authority&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;app &amp;lt; (identity) &amp;lt; trusted authority&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;app &amp;gt; (identity) &amp;gt; vault &amp;gt; trusted authority&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;app &amp;lt; (DB credential) &amp;lt; vault&lt;/strong&gt;&amp;gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;Demo 2: Auth method&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/auth/github&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://developer.hashicorp.com/vault/docs/auth/github&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// root 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy read sre
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault list auth/github-chechia-net/map/users
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault read auth/github-chechia-net/map/users/chechiachang
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault list auth/github-chechia-net/map/teams
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault read auth/github-chechia-net/map/teams/sre
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault auth help github-chechia-net
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// user (github login)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault login -method=github -path=github-chechia-net token=$TOKEN
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault read localhost_mariadb/creds/database_admin
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;Demo 2: Auth method&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/auth/aws&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://developer.hashicorp.com/vault/docs/auth/aws&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// User login Public Cloud
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;aws-vault exec dev -- vault login -method=aws -path=aws=sre
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gcloud ... vault login -method=gcp -path=gcp=sre
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;az login ... vault login -method=azure -path=azure=sre
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// app login k8s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/auth/kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é›£é¡Œ/èªè­‰/Vault Auth method/Kubernetes&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;app &amp;gt; sa -&amp;gt; k8s api server -&amp;gt; vault -&amp;gt; DB&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;a href=&#34;https://developer.hashicorp.com/vault/docs/platform/k8s/injector&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s vault injector&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;app è·‘åœ¨ Podï¼ŒPod å–å¾— k8s service account çŸ­æœŸ jwt token&lt;/li&gt;
&lt;li&gt;app é€é jwt token çµ¦ vault è²ç¨±è‡ªå·±æ˜¯ app
&lt;ul&gt;
&lt;li&gt;vault ä½¿ç”¨ jwt token èˆ‡ k8s api server æ ¸å° pod service account&lt;/li&gt;
&lt;li&gt;k8s æ ¸å°æˆåŠŸï¼Œvault èªç‚º app æ˜¯ k8s ä¸­çš„ app&lt;/li&gt;
&lt;li&gt;vault æä¾›çŸ­æœŸ database credential çµ¦ app&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;app ä½¿ç”¨çŸ­æœŸ database credential å­˜å–è³‡æ–™åº«&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/èªè­‰/Vault Auth method/å°çµ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ¬åœ°å­˜æ”¾ password çš„é¢¨éšª&lt;/li&gt;
&lt;li&gt;å¦‚æœæœ‰å…¬æœ‰é›²ï¼Œå­˜æ”¾é›²ç«¯æœå‹™
&lt;ul&gt;
&lt;li&gt;é€šéæª¢é©—ä¸”åˆè¦çš„å®‰å…¨ç³»çµ±&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¦‚æœæ˜¯åœ°ç«¯ï¼Œä½¿ç”¨ vault ä¾†ç®¡ç†å¸³è™Ÿå¯†ç¢¼
&lt;ul&gt;
&lt;li&gt;å­˜æ”¾ admin&lt;/li&gt;
&lt;li&gt;å‹•æ…‹ç”¢ç”Ÿ db user&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æœ€å®¹æ˜“è¢«é§­çš„ï¼Œä¸æ˜¯åœ°ç«¯ç¶²è·¯è¢«æ‰“ç©¿ï¼Œè€Œæ˜¯ admin çš„é–‹ç™¼æ©Ÿå™¨å­˜æ”¾å¸³è™Ÿå¯†ç¢¼ï¼Œè¢«é‡£é­šè¢«å´éŒ„è¢«ç«Šå–
ç”¨äº†å¾ˆå¥½çš„é˜²ç«ç‰†ï¼Œä½†æ˜¯ admin çš„é–‹ç™¼æ©Ÿå™¨å­˜æ”¾å¸³è™Ÿå¯†ç¢¼ï¼Œæˆ–æ˜¯ 1password
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;User Story (v?)&lt;/p&gt;
&lt;p&gt;éœ€æ±‚æœƒä¸€ç›´æ”¹è®Š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;app å­˜å–è³‡æ–™ï¼Œè®Šæˆ&lt;/li&gt;
&lt;li&gt;app + admin + metabase ä¸åŒæ¬Šé™&lt;/li&gt;
&lt;/ol&gt;
&lt;aside class=&#34;notes&#34;&gt;
  éœ€æ±‚æœƒä¸€ç›´æ”¹è®Šï¼Œç›®å‰ç®¡ç†æ–¹å¼æœ‰è¶³å¤ çš„å½ˆæ€§å»é¢å°éœ€æ±‚çš„æ”¹è®Šå—ï¼Ÿ
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/æˆæ¬Š&lt;/p&gt;
&lt;p&gt;MySQL ç‚ºä¾‹ï¼Œä½¿ç”¨ sql ç®¡ç†æˆæ¬Š&lt;/p&gt;
&lt;p&gt;user based access control&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;grant&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mydb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;%&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;grant&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;all&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mydb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;admin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;%&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;grant&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mydb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metabase&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;%&amp;#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;role based access control&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;create&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;role&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;myrole&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;grant&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;all&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;on&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mydb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;myrole&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;grant&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;myrole&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;to&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;%&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/æˆæ¬Š/Scale up&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Scale upï¼Œ100 å€‹ user x 100 å€‹ database&lt;/li&gt;
&lt;li&gt;æ¬Šé™è®Šæ›´é›£ review&lt;/li&gt;
&lt;li&gt;è®Šæ›´æˆæ¬Šçš„admin useræ¬ŠåŠ›å¾ˆå¤§ï¼Œå¦‚ä½•å­˜æ”¾ç®¡ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  100 å€‹ userï¼Œå°±è¦ä¸‹ 100 æ¬¡ sql grant role
100 å€‹ databaseï¼Œå°±è¦ä¸‹ x100 æ¬¡ sql grant role
æœ‰äººé›¢è·å†é€²ä¾†ä¸‹ sql
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/æˆæ¬Š/Scale up&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-hcl&#34; data-lang=&#34;hcl&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;resource&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;mysql_role&amp;#34; &amp;#34;myrole&amp;#34;&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  for_each&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;roles&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  name&lt;/span&gt;     &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;each&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;key&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;resource&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;mysql_grant&amp;#34; &amp;#34;developer&amp;#34;&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  for_each&lt;/span&gt;   &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;roles&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  role&lt;/span&gt;       &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;each&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;key&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  database&lt;/span&gt;   &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;each&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;database&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  privileges&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;each&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;privilleges&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;//&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;SELECT&amp;#34;, &amp;#34;UPDATE&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  SQL ä¹Ÿå¯ä»¥å¯« loopï¼Œä¹Ÿå¯ä»¥å¯« unit test
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/æˆæ¬Š/PR Review&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Terraform ç®¡ç† MySQL æˆæ¬Š&lt;/li&gt;
&lt;li&gt;Terraform æœ‰æ¯”è¼ƒå¥½å—ï¼Ÿ
&lt;ul&gt;
&lt;li&gt;ç¨‹å¼åŒ–è¨­å®š&lt;/li&gt;
&lt;li&gt;Reviewable / Testable code&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è«‹è¦‹&lt;a href=&#34;https://ithelp.ithome.com.tw/users/20120327/ironman/4057&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾é›¶é–‹å§‹å­¸Terraformæ‰‹æŠŠæ‰‹å…¥é–€&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;é€é terraform ä¾†ç®¡ç†è³‡æ–™åº«çš„æˆæ¬Šï¼Œå¯ä»¥è®“æˆ‘å€‘æ›´æ–¹ä¾¿çš„ç®¡ç†æˆæ¬Š&lt;/p&gt;
&lt;p&gt;æŠŠ mysql admin username/password æ”¾åœ¨é›²ç«¯ ex. aws secret managerï¼Œé€é terraform ä¾†å–å¾—å¸³è™Ÿå¯†ç¢¼&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;é›£é¡Œ/æˆæ¬Š/Automation&lt;/p&gt;
&lt;p&gt;Vault ç®¡ç†æˆæ¬Š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Or Vault + Terraformï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;database_admin
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;database_readonly
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;database_write
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy read database_write
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;path &amp;#34;chechia-net-myapp/database/database&amp;#34; {
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  capabilities = [&amp;#34;create&amp;#34;, &amp;#34;read&amp;#34;, &amp;#34;update&amp;#34;, &amp;#34;patch&amp;#34;, &amp;#34;delete&amp;#34;, &amp;#34;list&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  å¾ˆé‡è¦æ‰€ä»¥å†èªªä¸€æ¬¡
å¦‚æœä½ æœ‰ç”¨é›²ç«¯æœå‹™ï¼Œå¯ä»¥è€ƒæ…®ä½¿ç”¨é›²ç«¯æœå‹™ä¾†ç®¡ç†å¸³è™Ÿå¯†ç¢¼
å¦‚æœä½ æ˜¯åœ°ç«¯ï¼Œå¯ä»¥è€ƒæ…®ä½¿ç”¨ vault ä¾†ç®¡ç†å¸³è™Ÿå¯†ç¢¼
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;Demo 3: Terraform è¨­å®š Vault èˆ‡ DB secret engine&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// destroy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd vault-playground/usage/03-terraform-lives
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;terragrunt destroy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd vault-playground/deploy/04-docker-and-db/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker-compose down
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// create new
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker-compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker ps
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd vault-playground/usage/03-terraform-lives
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;terragrunt apply
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;Demo 3: Terraform è¨­å®š Vault èˆ‡ DB secret engine&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¨‹å¼åŒ–æ¬Šé™æ§ç®¡
&lt;ul&gt;
&lt;li&gt;ä¸€éµè¨­å®šç’°å¢ƒ
&lt;ul&gt;
&lt;li&gt;CI/CD æ¸¬è©¦
&lt;ul&gt;
&lt;li&gt;fmt, lint, unit test&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;PR Review&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Automation planï¼Œapply
&lt;ul&gt;
&lt;li&gt;é¿å…äººå·¥æ“ä½œçš„å¤±èª¤èˆ‡é¢¨éšª&lt;/li&gt;
&lt;li&gt;DBA ä¸ç”¨å¯†ç¢¼æˆ– loginï¼Œå› ç‚ºæ ¹æœ¬ä¸é€£ prod DB&lt;/li&gt;
&lt;li&gt;incident ä¸€éµ roll back&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  sql ä¹Ÿéƒ½èƒ½åšï¼Œä¹Ÿéƒ½æœ‰å·¥å…·åœ¨åšï¼Œåªæ˜¯èªè¨€çš„æ€§è³ªå°è‡´é€™ä»¶äº‹å¥½ä¸å¥½åš
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;ç¸½çµ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Vault DB secret engine
&lt;ul&gt;
&lt;li&gt;ç®¡ç†è³‡æ–™åº«å¸³è™Ÿå¯†ç¢¼&lt;/li&gt;
&lt;li&gt;å‹•æ…‹ç”¢ç”Ÿ db user&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Vault auth method
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸‰æ–¹èªè­‰èº«ä»½&lt;/li&gt;
&lt;li&gt;Github / AWS IAM Role / Kubernetes Service Account&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Vault + Terraform
&lt;ul&gt;
&lt;li&gt;ç¨‹å¼åŒ–æ¬Šé™æ§ç®¡&lt;/li&gt;
&lt;li&gt;PR Review&lt;/li&gt;
&lt;li&gt;Automation planï¼Œapply&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;qa&#34;&gt;Q&amp;amp;A&lt;/h3&gt;
</description>
    </item>
    
    <item>
      <title>Kubernetes Summit: Get started with etcd &amp; Kubernetes</title>
      <link>https://chechia.net/zh-hant/slides/2024-10-24-etcd-workshop/</link>
      <pubDate>Mon, 05 Aug 2024 00:45:00 +0000</pubDate>
      <guid>https://chechia.net/zh-hant/slides/2024-10-24-etcd-workshop/</guid>
      <description>&lt;h3 id=&#34;etcd-workshop&#34;&gt;etcd Workshop&lt;/h3&gt;
&lt;h5 id=&#34;æœ¬æ¬¡-workshop-ä»¥-hands-on-çš„æ–¹å¼é€²è¡Œç´¯ç©æ“ä½œç¶“é©—ç‚ºä¸»è¬›è§£èˆ‡èªªæ˜ç‚ºè¼”è§€å¿µå…§å®¹æœ‰æº–å‚™æ•™æéœ€è¦åƒèˆ‡è€…è‡ªè¡Œé–±è®€&#34;&gt;æœ¬æ¬¡ workshop ä»¥ hands-on çš„æ–¹å¼é€²è¡Œï¼Œç´¯ç©æ“ä½œç¶“é©—ç‚ºä¸»ï¼Œè¬›è§£èˆ‡èªªæ˜ç‚ºè¼”ã€‚è§€å¿µå…§å®¹æœ‰æº–å‚™æ•™æï¼Œéœ€è¦åƒèˆ‡è€…è‡ªè¡Œé–±è®€&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;docker å•Ÿå‹• etcd&lt;/li&gt;
&lt;li&gt;etcdctl å­˜å– etcd&lt;/li&gt;
&lt;li&gt;docker å•Ÿå‹• etcd cluster&lt;/li&gt;
&lt;li&gt;docker å•Ÿå‹• k8s control plane&lt;/li&gt;
&lt;li&gt;kubectl å­˜å– k8s control plane&lt;/li&gt;
&lt;li&gt;ç¶­é‹ k8s æ‰€éœ€çš„ etcd operation&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;åƒèˆ‡è€…éœ€è¦ä¸€å°é›»è…¦å¯ä»¥ä¸Šç¶²èƒ½å¤ é»æ»‘é¼ å³éµ&#34;&gt;åƒèˆ‡è€…éœ€è¦ä¸€å°é›»è…¦ï¼Œå¯ä»¥ä¸Šç¶²ï¼Œèƒ½å¤ é»æ»‘é¼ å³éµ&lt;/h5&gt;
&lt;hr&gt;
&lt;h3 id=&#34;etcd-workshop-1&#34;&gt;etcd Workshop&lt;/h3&gt;
&lt;h3 id=&#34;æ‰‹æŠŠæ‰‹æ­å»º-etcd-èˆ‡-k8s-å·¥ä½œåŠ&#34;&gt;æ‰‹æŠŠæ‰‹æ­å»º etcd èˆ‡ K8s å·¥ä½œåŠ&lt;/h3&gt;
&lt;p&gt;Che Chia Chang
&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://chechia.net/&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;é—œæ–¼æˆ‘&#34;&gt;é—œæ–¼æˆ‘&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Che Chia Chang&lt;/li&gt;
&lt;li&gt;SRE @ &lt;a href=&#34;https://www.cake.me/companies/maicoin/jobs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Maicoin&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://mvp.microsoft.com/zh-TW/MVP/profile/e407d0b9-5c01-eb11-a815-000d3a8ccaf5&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Microsoft MVP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å€‹äººéƒ¨è½æ ¼&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;chechia.net&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;presentation and speaker notes&lt;/li&gt;
&lt;li&gt;éµäººè³½ (Terraform / Vault æ‰‹æŠŠæ‰‹å…¥é–€)&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;were-hiring&#34;&gt;We&amp;rsquo;re hiring!&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cake.me/companies/maicoin/jobs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.cake.me/companies/maicoin/jobs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2024-10-24-etcd-workshop/we-re-hiring_hu7224f98eba3fbc175440ef1f6bf665c9_15949_9da35ea5399dd4b247c69c19f4c75987.webp 400w,
               /zh-hant/slides/2024-10-24-etcd-workshop/we-re-hiring_hu7224f98eba3fbc175440ef1f6bf665c9_15949_55917817014d7ac627b45f9c4a791867.webp 760w,
               /zh-hant/slides/2024-10-24-etcd-workshop/we-re-hiring_hu7224f98eba3fbc175440ef1f6bf665c9_15949_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2024-10-24-etcd-workshop/we-re-hiring_hu7224f98eba3fbc175440ef1f6bf665c9_15949_9da35ea5399dd4b247c69c19f4c75987.webp&#34;
               width=&#34;400&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¤§ç¶±&#34;&gt;å¤§ç¶±&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;docker å•Ÿå‹• etcd&lt;/li&gt;
&lt;li&gt;etcdctl å­˜å– etcd&lt;/li&gt;
&lt;li&gt;docker å•Ÿå‹• etcd cluster&lt;/li&gt;
&lt;li&gt;docker å•Ÿå‹• k8s control plane&lt;/li&gt;
&lt;li&gt;ç¶­é‹ k8s æ‰€éœ€çš„ etcd operation&lt;/li&gt;
&lt;li&gt;(Optional) æ­å»º Worker Node&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¦‚ä½•é€²è¡Œ-workshop&#34;&gt;å¦‚ä½•é€²è¡Œ workshop&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¬›å¸«æœƒåœ¨å°ä¸Šå¸¶é ­å½±ç‰‡çš„å…§å®¹&lt;/li&gt;
&lt;li&gt;åƒèˆ‡è€…åœ¨è‡ªå·±çš„æ©Ÿå™¨ä¸Šæ“ä½œ&lt;/li&gt;
&lt;li&gt;åƒèˆ‡è€…å¯ä»¥è·Ÿå°ä¸Šçš„é€²åº¦ï¼Œä¹Ÿå¯ä»¥è¶…å‰é€²åº¦å‘å¾Œæ“ä½œ&lt;/li&gt;
&lt;li&gt;é€²åº¦è½å¾Œä¸å¤ªæœƒå½±éŸ¿å¾ŒçºŒæ“ä½œï¼Œä¸å¿…æ“”å¿ƒ&lt;/li&gt;
&lt;li&gt;åŠ åˆ†é¡Œæ˜¯é‡è¦ï¼Œä½†æ²’æ™‚é–“æ–¼ä»Šæ—¥å®Œæˆçš„å…§å®¹ï¼Œè«‹è‡ªè¡Œåƒè€ƒ&lt;/li&gt;
&lt;li&gt;æœ‰å¾ˆå¤šå•é¡Œä¹Ÿå¾ˆæ­£å¸¸ï¼Œç”¢ç”Ÿç–‘å•ä¹Ÿæ˜¯å·¥ä½œåŠçš„ç›®çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¦‚ä½•å­˜å–é ç«¯vm&#34;&gt;å¦‚ä½•å­˜å–é ç«¯VM&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;è‡³&lt;a href=&#34;https://workshop.chechia.net&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;workshop.chechia.net&lt;/a&gt; é ˜å–ä¸€å° VM ä¸¦ç°½å&lt;/li&gt;
&lt;li&gt;å¾è¬›å¸«å–å¾—ä½¿ç”¨è€…åç¨±èˆ‡å¯†ç¢¼&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç€è¦½å™¨ï¼Œé€é url é€£ç·šè‡³ä½ çš„ VMï¼Œè¼¸å…¥ä½¿ç”¨è€…åç¨±èˆ‡å¯†ç¢¼ç™»å…¥&lt;/li&gt;
&lt;li&gt;Protocol: SSHï¼Œport 22ï¼Œauthentication type: password&lt;/li&gt;
&lt;li&gt;ä¸‹è¼‰æ•™æï¼ˆæ»‘é¼ è¤‡è£½åº•ä¸‹æŒ‡ä»¤ï¼Œæ»‘é¼ å³éµå°±èƒ½è²¼åˆ° terminal ä¸­ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone https://github.com/chechiachang/etcd-playground.git
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;å›å®¶å¦‚ä½•è‡ªå»º-workshop-ç’°å¢ƒ&#34;&gt;å›å®¶å¦‚ä½•è‡ªå»º workshop ç’°å¢ƒ&lt;/h3&gt;
&lt;p&gt;workshop æä¾›çš„æ©Ÿå™¨&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ubuntu&lt;/li&gt;
&lt;li&gt;å®‰è£é€™äº›æ±è¥¿ &lt;a href=&#34;https://github.com/chechiachang/terraform-azure/blob/main/templates/cloud_config/workshop.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;github.com/chechiachang/terraform-azure&lt;/a&gt;
mac å®‰è£ä»¥ä¸‹å·¥å…·&lt;/li&gt;
&lt;li&gt;docker &lt;a href=&#34;https://docs.docker.com/desktop/install/mac-install/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.docker.com/desktop/install/mac-install/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å®‰è£ &lt;a href=&#34;https://jqlang.github.io/jq/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;jq&lt;/a&gt; èˆ‡ &lt;a href=&#34;https://github.com/mikefarah/yq/releases/tag/v4.44.3&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;yq&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å›å®¶å¦‚ä½•è‡ªå»º-workshop-ç’°å¢ƒ-1&#34;&gt;å›å®¶å¦‚ä½•è‡ªå»º workshop ç’°å¢ƒ&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;VERSION=v4.44.3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;BINARY=yq_darwin_amd64
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wget https://github.com/mikefarah/yq/releases/download/${VERSION}/${BINARY} -O yq
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;chmod +x yq
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo mv yq /usr/bin/yq
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-åŸºç¤æ“ä½œ-å•Ÿå‹•ä¸€å°-etcd&#34;&gt;etcd åŸºç¤æ“ä½œ: å•Ÿå‹•ä¸€å° etcd&lt;/h3&gt;
&lt;p&gt;ä¸€è¡Œä¸€è¡ŒåŸ·è¡Œåº•ä¸‹æŒ‡ä»¤ï¼Œä¾†å•Ÿå‹•ä¸€å° etcd&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd etcd-playground
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ls
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd 00-prerequsites/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat docker-compose.yaml 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker ps
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker logs -f etcd-0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¡ä½æ™‚ ctrl + c to exit&lt;/p&gt;
&lt;p&gt;åªé ˜æ‰“ä¸€åŠå¯ä»¥æŒ‰ tab auto complete&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;etcd-åŸºç¤æ“ä½œ-etcdctl&#34;&gt;etcd åŸºç¤æ“ä½œ: etcdctl&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/tutorials/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/tutorials/&lt;/a&gt; ä¸­çš„å¹¾å€‹ç¯„ä¾‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Reading from etcd&lt;/li&gt;
&lt;li&gt;Writing to etcd&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get foo
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl put foo &amp;#34;Hello World&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get foo
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-åŸºç¤æ“ä½œ-etcdctl-1&#34;&gt;etcd åŸºç¤æ“ä½œ: etcdctl&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/tutorials/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/tutorials/&lt;/a&gt; ä¸­çš„å¹¾å€‹ç¯„ä¾‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How to get keys by prefix&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get --prefix &amp;#34;&amp;#34; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get &amp;#34;&amp;#34; --prefix --keys-only
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl put foo2 2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl put foo5 5
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl put foo4 4
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl put foo3 3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get foo --prefix --keys-only
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get foo --prefix --keys-only --sort-by=KEY --limit=5
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get foo --prefix --keys-only --sort-by=MODIFY --limit=5
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-åŸºç¤æ“ä½œ-etcdctl-2&#34;&gt;etcd åŸºç¤æ“ä½œ: etcdctl&lt;/h3&gt;
&lt;p&gt;è«‹å˜—è©¦æ“ä½œ &lt;a href=&#34;https://etcd.io/docs/v3.5/tutorials/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/tutorials/&lt;/a&gt; ä¸­çš„å¹¾å€‹ç¯„ä¾‹&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How to delete keys&lt;/li&gt;
&lt;li&gt;How to watch keys&lt;/li&gt;
&lt;li&gt;How to check Cluster status&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl del foo
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl put k1 value1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl put k2 value2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl del --prefix k
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-åŸºç¤æ“ä½œ-é‡å•Ÿ-etcd&#34;&gt;etcd åŸºç¤æ“ä½œ: é‡å•Ÿ etcd&lt;/h3&gt;
&lt;p&gt;é€éä»¥ä¸‹ command é‡å•Ÿ etcd&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;docker ps&lt;/code&gt; ç¢ºèª etcd æ˜¯å¦é‚„åœ¨é‹è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker ps
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose down
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker ps
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-åŸºç¤æ“ä½œ-quiz&#34;&gt;etcd åŸºç¤æ“ä½œ: Quiz&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;é‡å•Ÿ etcd å¾Œï¼Œæ˜¯å¦é‚„èƒ½è®€å–åˆ° foo çš„å€¼ï¼Ÿç‚ºä»€éº¼ï¼Ÿ&lt;/li&gt;
&lt;li&gt;è«‹ç”¨50å€‹å­—ï¼Œæè¿°ä½ ç›®å‰è¦ºå¾— etcd æ˜¯ä»€éº¼ï¼Ÿ
&lt;ul&gt;
&lt;li&gt;æŠŠç­”æ¡ˆå¡«åˆ° &lt;a href=&#34;https://workshop.chechia.net&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;workshop.chechia.net&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä¸æ˜¯è€ƒè©¦ï¼Œéš¨æ„ç™¼æ®ï¼Œé‡é»åœ¨ä¿ƒé€²å¤§å®¶æ€è€ƒ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl put foo bar
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose down
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get foo
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-åŸºç¤æ“ä½œ-answer&#34;&gt;etcd åŸºç¤æ“ä½œ: Answer&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æœ¬ workshop çš„ docker-compose.yml ä¸­ï¼Œetcd çš„è³‡æ–™æ˜¯å­˜æ”¾åœ¨æœ¬åœ°çš„ etcd0 è³‡æ–™å¤¾ä¸­ï¼Œå› æ­¤é‡å•Ÿå¾Œï¼Œè³‡æ–™ä¸æœƒéºå¤±ã€‚é€éä»¥ä¸‹æŒ‡ä»¤å¯ä»¥æ¸…é™¤ etcd0 è³‡æ–™å¤¾ä¸­çš„è³‡æ–™&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/learning/why/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/learning/why/&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd 00-prerequsites/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo ls etcd0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo ls etcd0/member
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose down --volumes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo rm -rf etcd0/*
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# æ–°çš„ etcd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ls etcd0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;é–±è®€è³‡æ–™&#34;&gt;é–±è®€è³‡æ–™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/learning/why/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/learning/why/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/chechiachang/etcd-playground/blob/main/00-prerequsites/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/chechiachang/etcd-playground/blob/main/00-prerequsites/README.md&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†authentication&#34;&gt;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†ï¼šauthentication&lt;/h3&gt;
&lt;p&gt;å•Ÿç”¨ etcd çš„ authentication&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ userA ç™»å…¥ etcd&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ userA å¯«å…¥è³‡æ–™&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ userB è®€å–è³‡æ–™&lt;/li&gt;
&lt;li&gt;é—œé–‰åŒ¿åå­˜å–&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/op-guide/authentication/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/op-guide/authentication/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;å¡ä½ä¹ƒå…µå®¶å¸¸äº‹å¤§ä¿ è«‹é‡æ–°ä¾†éå³å¯&#34;&gt;å¡ä½ä¹ƒå…µå®¶å¸¸äº‹ï¼Œå¤§ä¿ è«‹é‡æ–°ä¾†éå³å¯&lt;/h5&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose down --volumes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo rm -rf etcd0/*
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†authentication-1&#34;&gt;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†ï¼šauthentication&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# å¯èƒ½æœƒç”¨åˆ°çš„ cmd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl role add
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl role grant-permission
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl user add
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl user list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl auth status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl auth enable
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-clusters-ç§»é™¤èˆŠçš„-etcd&#34;&gt;etcd Clusters: ç§»é™¤èˆŠçš„ etcd&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆé—œé–‰ 01-prerequsites çš„ etcd&lt;/li&gt;
&lt;li&gt;é€é &lt;code&gt;--volumes&lt;/code&gt; åˆªé™¤ docker volume&lt;/li&gt;
&lt;li&gt;åˆªé™¤ etcd local volume è³‡æ–™å¤¾&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose down --volumes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo rm -rf etcd0/*
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-clusters-å•Ÿå‹•å¤šå°-etcd&#34;&gt;etcd Clusters: å•Ÿå‹•å¤šå° etcd&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd ../
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd 01-cluster/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat docker-compose.yaml 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker ps
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-clusters-æª¢è¦–ç‹€æ…‹&#34;&gt;etcd Clusters: æª¢è¦–ç‹€æ…‹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é è¨­ etcdctl æœƒé€£ç·šåˆ° &amp;ndash;endpoints=[127.0.0.1:2379]&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &amp;ndash;endpoints æŒ‡å®šè¦é€£ç·šåˆ°çš„ etcd&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ export ETCDCTL_ENDPOINTS æŒ‡å®šè¦é€£ç·šåˆ°çš„ etcd&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl --endpoints &amp;#34;http://127.0.0.1:2379,http://127.0.0.1:2380&amp;#34; endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl --endpoints &amp;#34;http://127.0.0.1:2379,http://127.0.0.1:2380,http://127.0.0.1:2381&amp;#34; endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;export ETCDCTL_ENDPOINTS=&amp;#34;http://127.0.0.1:2379,http://127.0.0.1:2380,http://127.0.0.1:2381&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl --endpoints $ETCDCTL_ENDPOINTS endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-clusters-æª¢è¦–ç‹€æ…‹-1&#34;&gt;etcd Clusters: æª¢è¦–ç‹€æ…‹&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/tutorials/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/tutorials/&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How to check Cluster status&lt;/li&gt;
&lt;li&gt;é€é &lt;code&gt;--help&lt;/code&gt; æª¢æŸ¥æ¯å€‹æ¬„ä½çš„æ„ç¾©&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl endpoint status --help
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl endpoint health
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl endpoint health --help
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl endpoint hashkv
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl endpoint hashkv --help
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-clusters-æ“ä½œ-member&#34;&gt;etcd Clusters: æ“ä½œ Member&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;member æ˜¯ etcd cluster ä¸­çš„ä¸€å€‹ç¯€é»&lt;/li&gt;
&lt;li&gt;leader æ˜¯ etcd cluster ä¸­çš„ä¸€å€‹ member&lt;/li&gt;
&lt;li&gt;é€é &lt;code&gt;move-leader&lt;/code&gt; æŒ‡ä»¤ï¼Œå¯ä»¥äº¤æ¥ leader&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl --write-out=table endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker exec -it etcd-1 etcdctl move-leader 88d11e2649dad027
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl --write-out=table endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;etcd-clusters-member&#34;&gt;etcd Clusters: Member&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/tutorials/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/tutorials/&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;How to Add and Remove Members&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;ç§»é™¤ä¸€å€‹ memberï¼Œname: etcd-3 id: c3697a4fd7a20dcd&lt;/li&gt;
&lt;li&gt;æ·»åŠ å›ä¾†&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#replacing-a-failed-etcd-member&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#replacing-a-failed-etcd-member&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member remove
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member remove c3697a4fd7a20dcd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member add c3697a4fd7a20dcd --peer-urls=&amp;#34;http://etcd-3:2380&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo rm -rf etcd3/member
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker start etcd-3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member list
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;é–±è®€è³‡æ–™-1&#34;&gt;é–±è®€è³‡æ–™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/faq/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/faq/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/learning/design-learner/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/learning/design-learner/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/learning/persistent-storage-files/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/learning/persistent-storage-files/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†authentication-2&#34;&gt;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†ï¼šauthentication&lt;/h3&gt;
&lt;p&gt;å•Ÿç”¨ etcd cluster çš„ tlsï¼Œä¸¦è®“ etcdcetl é€é tls é€£ç·š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/op-guide/clustering/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/op-guide/clustering/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;é—œé–‰æœå‹™&lt;/li&gt;
&lt;li&gt;ç”¢ç”Ÿ ca èˆ‡ certs&lt;/li&gt;
&lt;li&gt;é…ç½®åˆ° etcd* è³‡æ–™å¤¾ä¸­&lt;/li&gt;
&lt;li&gt;æ›´æ”¹ 01-cluster/docker-compose.yaml&lt;/li&gt;
&lt;li&gt;docker compose é‡å•Ÿæœå‹™&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;k8s-æ­å»º-k8s-control-plane&#34;&gt;K8s: æ­å»º K8s Control Plane&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç¢ºå®š etcd cluster éƒ½æ­£å¸¸é‹è¡Œ
&lt;ul&gt;
&lt;li&gt;è£¡é¢æ²’æœ‰è³‡æ–™ï¼Œæœ‰çš„è©±å¯ä»¥åˆªé™¤ï¼Œå•Ÿå‹•æ–°çš„ etcd&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é€é docker å•Ÿå‹• K8s Control Plane
&lt;ul&gt;
&lt;li&gt;kube-apiserver&lt;/li&gt;
&lt;li&gt;kube-controller-manager&lt;/li&gt;
&lt;li&gt;kube-scheduler&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker ps -a
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get &amp;#34;&amp;#34; --prefix --keys-only
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;k8s-æ­å»º-k8s-control-plane-1&#34;&gt;K8s: æ­å»º K8s Control Plane&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é€éåº•ä¸‹æŒ‡ä»¤ï¼Œå•Ÿå‹• k8s control plane
&lt;ul&gt;
&lt;li&gt;é€™æ˜¯ä¸€å€‹æ¥µåº¦ç°¡åŒ–çš„ k8s control plane&lt;/li&gt;
&lt;li&gt;æ­£å¼ç’°å¢ƒä¸æœƒé•·é€™æ¨£&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd 02-control-panel
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd certs
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;./generate.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd ../
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat docker-compose.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker ps
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker logs kube-apiserver
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker logs kube-controller-manager
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker logs kube-scheduler
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/overview/components/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/concepts/overview/components/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kubernetes.io/images/docs/components-of-kubernetes.svg&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;k8s-kubectl&#34;&gt;K8s: kubectl&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é€é etcdctl æª¢æŸ¥ç›®å‰çš„ etcd è³‡æ–™å…§å®¹&lt;/li&gt;
&lt;li&gt;kubectl æ˜¯ Kubernetes çš„ CLI å·¥å…·ï¼Œå¯ä»¥é€é kubectl å­˜å– k8s control plane&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get &amp;#34;&amp;#34; --prefix --keys-only
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig=certs/admin.kubeconfig cluster-info
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig=certs/admin.kubeconfig get all -A
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;k8s-data-in-etcd&#34;&gt;K8s: data in etcd&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ etcdctl å­˜å– k8s çš„è³‡æ–™&lt;/li&gt;
&lt;li&gt;jq&lt;/li&gt;
&lt;li&gt;yq&lt;/li&gt;
&lt;li&gt;é¸å¹¾å€‹ &lt;code&gt;/registry&lt;/code&gt; çš„ keyï¼Œæ¢ç´¢æ›´å¤š k8s å…§å®¹&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get &amp;#34;/&amp;#34; --prefix --keys-only --sort-by=KEY
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get /registry/namespaces/default -w json | jq
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get /registry/namespaces/default -w json | yq -P
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;k8s-data-in-etcd-1&#34;&gt;K8s: data in etcd&lt;/h3&gt;
&lt;p&gt;k8s é‹è¡Œæ™‚ï¼Œæœƒå°‡è³‡æ–™å­˜æ”¾åœ¨ etcd ä¸­&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€é kubectl create namespace workshop å‰µå»ºä¸€å€‹ namespace&lt;/li&gt;
&lt;li&gt;é€é etcdctl å­˜å– workshop namespace çš„è³‡æ–™&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get &amp;#34;/registry/namespaces&amp;#34; --prefix --keys-only --sort-by=KEY
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig=certs/admin.kubeconfig create namespace workshop
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl get /registry/namespaces/workshop -w json | yq -P
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;k8s-the-hard-way&#34;&gt;K8s: the hard way&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/kelseyhightower/kubernetes-the-hard-way/tree/master&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;kelseyhightower/kubernetes-the-hard-way&lt;/a&gt; æ˜¯ä¸€å€‹å¾ˆæ£’çš„å­¸ç¿’è³‡æºï¼Œå¯ä»¥è®“ä½ äº†è§£åˆ° Kubernetes çš„æ¯å€‹ç´°ç¯€&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€™æ¬¡é‡é»åœ¨æ–¼ etcdï¼Œæˆ‘å€‘åªæ“ä½œåˆ° etcd çš„éƒ¨åˆ†&lt;/li&gt;
&lt;li&gt;k8s çš„éƒ¨åˆ†ï¼Œåœ¨æ–¼ k8s è·Ÿ etcd çš„äº’å‹•&lt;/li&gt;
&lt;li&gt;æœ‰åŠŸèƒ½çš„ k8s é‚„éœ€è¦éƒ¨ç½² node&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;k8s-generatesh&#34;&gt;K8s: ./generate.sh&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/chechiachang/etcd-playground/blob/main/02-control-panel/certs/generate.sh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;certs/generate.sh&lt;/a&gt; æœ‰é™„ä¸Šå°æ‡‰çš„ k8s-the-hard-way çš„èªªæ˜æ–‡ä»¶&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ca èˆ‡ certs æ˜¯éƒ¨ç½² k8s control plane çš„å¿…è¦æª”æ¡ˆ&lt;/li&gt;
&lt;li&gt;éå¸¸èŠ±æ™‚é–“ï¼Œæœ¬ workshop æœƒç›´æ¥ä½¿ç”¨è…³æœ¬ç”¢ç”Ÿ&lt;/li&gt;
&lt;li&gt;åŠ åˆ†é¡Œï¼šé¼“å‹µå¤§å®¶è‡ªå·±æ“ä½œéä¸€æ¬¡ certs çš„ç”¢ç”Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vi certs/generate.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ls certs
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;k8s-èªè­˜-control-plane-components&#34;&gt;K8s: èªè­˜ control plane components&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/overview/components/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/concepts/overview/components/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ls apiserver
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ls controller-manager
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ls scheduler
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;k8s-etcd-operations-for-k8s&#34;&gt;K8s: etcd operations for k8s&lt;/h3&gt;
&lt;p&gt;k8s å®˜æ–¹æ–‡ä»¶ä¸­ï¼Œå¾ç¶­é‹ k8s è§’åº¦ï¼Œè¬›è¿°å¦‚ä½•ç¶­é‹ etcd&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#securing-etcd-clusters&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Securing etcd Clusters&lt;/a&gt; æ”¾åœ¨åŠ åˆ†é¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;k8s-etcd-backup-and-restore&#34;&gt;K8s: etcd backup and restore&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#backing-up-an-etcd-cluster&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;backing-up-an-etcd-cluster&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;etcdctl ç¢ºå®š leader èˆ‡ raft index&lt;/li&gt;
&lt;li&gt;å‘ leader node ç™¼é€ snapshot request&lt;/li&gt;
&lt;li&gt;è¼¸å‡ºåˆ° /etcd_data/snapshot.dbï¼Œæœƒé¡¯ç¤ºåœ¨ etcd1 è³‡æ–™å¤¾ä¸­&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl --write-out=table endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker exec -it etcd-1 etcdctl snapshot save /etcd_data/snapshot.db
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ls etcd1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;k8s-etcd-backup-and-restore-1&#34;&gt;K8s: etcd backup and restore&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#restoring-an-etcd-cluster&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;restoring-an-etcd-cluster&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœæ­¢ k8s control plane (apiserver)&lt;/li&gt;
&lt;li&gt;è¤‡è£½ snapshot.db åˆ° etcd2 èˆ‡ etcd3 è³‡æ–™å¤¾ä¸­&lt;/li&gt;
&lt;li&gt;å°æ¯ä¸€å€‹ etcd member åŸ·è¡Œ restore&lt;/li&gt;
&lt;li&gt;æˆ–æ˜¯é‡å° leader åŸ·è¡Œ restore&lt;/li&gt;
&lt;li&gt;è§€å¯Ÿ raft index çš„è®ŠåŒ–&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker stop kube-apiserver
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cp etcd1/snapshot.db etcd2/snapshot.db
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cp etcd1/snapshot.db etcd3/snapshot.db
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker exec -it etcd-1 etcdctl snapshot restore /etcd_data/snapshot.db
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker exec -it etcd-2 etcdctl snapshot restore /etcd_data/snapshot.db
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker exec -it etcd-3 etcdctl snapshot restore /etcd_data/snapshot.db
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl --write-out=table endpoint status
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†å¢åŠ -etcd-member&#34;&gt;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†ï¼šå¢åŠ  etcd member&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/#scaling-out-etcd-clusters&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;scaling-out-etcd-clusters&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¿®æ”¹ 01-cluster/docker-compose.yaml&lt;/li&gt;
&lt;li&gt;èª¿æ•´åº•ä¸‹ comment ä¸­çš„éƒ¨åˆ†ï¼Œä¿®æ”¹ ? çš„åœ°æ–¹&lt;/li&gt;
&lt;li&gt;å¢åŠ å…©å° etcd member åˆ° cluster ä¸­&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# å¯èƒ½æœƒç”¨åˆ°çš„ cmd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member add &amp;lt;id&amp;gt; --peer-urls=
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;etcdctl member list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker compose up -d
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†è‡ªå·±åš-ca-and-tls-certs&#34;&gt;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†ï¼šè‡ªå·±åš ca and tls certs&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ä½¿ç”¨ generate.sh ç”¢ç”Ÿ certsï¼Œæ‹‰èµ· k8s control plane&lt;/li&gt;
&lt;li&gt;é–±è®€ generate.sh çš„ comment éƒ¨åˆ†ç¶²é é€£çµ&lt;/li&gt;
&lt;li&gt;å°‡ generate.sh çš„å…§å®¹ï¼Œåˆ° terminal ä¸­ä¸€æ®µä¸€æ®µ copy paste åŸ·è¡Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†-å¢åŠ -apiserver&#34;&gt;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†: å¢åŠ  apiserver&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ›´æ”¹ 02-control-panel/docker-compose.yaml&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹åº•ä¸‹ comment ä¸­çš„éƒ¨åˆ† kube-apiserver-1 çš„éƒ¨åˆ†&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ docker compose up å•Ÿå‹•æœå‹™&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ kubectl å­˜å– kube-apiserver-1
&lt;ul&gt;
&lt;li&gt;éœ€è¦ä¿®æ”¹ generate.shï¼Œèª¿æ•´ certs/admin.kubeconfig&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†-æ­å»º-k8s-node&#34;&gt;åŠ åˆ†é¡Œç‚ºè‡ªå·±åŠ åˆ†: æ­å»º K8s Node&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/kelseyhightower/kubernetes-the-hard-way/blob/master/docs/09-bootstrapping-kubernetes-workers.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/kelseyhightower/kubernetes-the-hard-way/blob/master/docs/09-bootstrapping-kubernetes-workers.md&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;åƒè€ƒè³‡æ–™&#34;&gt;åƒè€ƒè³‡æ–™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;etcd
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/learning/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/learning/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://play.etcd.io/play&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://play.etcd.io/play&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/tasks/administer-cluster/configure-upgrade-etcd/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;kubernetes
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/overview/components/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/concepts/overview/components/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä¸­æ–‡ &lt;a href=&#34;https://kubernetes.feisky.xyz/concepts/components/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.feisky.xyz/concepts/components/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kelseyhightower/kubernetes-the-hard-way&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/kelseyhightower/kubernetes-the-hard-way&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Kubernetes Summit: Upgrade A VM Based Cluster</title>
      <link>https://chechia.net/zh-hant/slides/2024-10-23-upgrade-k8s-cluster/</link>
      <pubDate>Sun, 04 Aug 2024 12:45:00 +0000</pubDate>
      <guid>https://chechia.net/zh-hant/slides/2024-10-23-upgrade-k8s-cluster/</guid>
      <description>&lt;h3 id=&#34;upgrade-a-vm-based-cluster&#34;&gt;Upgrade A VM Based Cluster&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Che Chia Chang&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;é—œæ–¼æˆ‘&#34;&gt;é—œæ–¼æˆ‘&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Che Chia Chang&lt;/li&gt;
&lt;li&gt;SRE @ &lt;a href=&#34;https://www.cake.me/companies/maicoin/jobs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Maicoin&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://mvp.microsoft.com/zh-TW/MVP/profile/e407d0b9-5c01-eb11-a815-000d3a8ccaf5&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Microsoft MVP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æŠ•å½±ç‰‡èˆ‡è¬›ç¨¿éƒ½åœ¨ &lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;chechia.net&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://chechia.net/zh-hant/talk/kubernetes-summit-get-started-with-etcd-kubernetes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Etcd Workshop&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;éµäººè³½ (Terraform / Vault æ‰‹æŠŠæ‰‹å…¥é–€)&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä»Šå¤©çš„ä¸»é¡Œ&#34;&gt;ä»Šå¤©çš„ä¸»é¡Œ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç‚ºä½•è¦ AWS è‡ªæ¶ K8s&lt;/li&gt;
&lt;li&gt;å‡ç´šäº‹å‰é–±è®€æ–‡ä»¶èˆ‡è¦åŠƒ&lt;/li&gt;
&lt;li&gt;éœ€è¦å‡ç´šçš„å…ƒä»¶&lt;/li&gt;
&lt;li&gt;å¯¦éš›å‡ç´šçš„æ­¥é©Ÿ&lt;/li&gt;
&lt;li&gt;è‡ªå‹•åŒ– k8s å‡ç´š&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä»Šå¤©çš„ç›®çš„&#34;&gt;ä»Šå¤©çš„ç›®çš„&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;çµ±æ•´æ•£è½çš„è³‡è¨Š&lt;/li&gt;
&lt;li&gt;å‡ç´šéœ€è¦è€ƒæ…®çš„äº‹æƒ…&lt;/li&gt;
&lt;li&gt;å¯èƒ½å“ªäº›åœ°æ–¹æœ‰é›·ï¼Œå°è‡´å‡ç´šå‡ºéŒ¯&lt;/li&gt;
&lt;li&gt;ç”¢ç”Ÿè‡ªå·±åœ˜éšŠçš„å‡ç´š SOP&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;èƒŒæ™¯ä»€éº¼æ˜¯-vm-based-cluster&#34;&gt;èƒŒæ™¯ï¼šä»€éº¼æ˜¯ VM-based Cluster&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Managed Kubernetes Service (GKE, EKS, AKS)
&lt;ul&gt;
&lt;li&gt;å…¬æœ‰é›²è¨—ç®¡ control planeï¼Œé€éé›²æä¾›çš„ä»‹é¢æ§åˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;self-hosted Kubernetes
&lt;ul&gt;
&lt;li&gt;cloud formation template ec2 node&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://docs.aws.amazon.com/images/whitepapers/latest/overview-deployment-options/images/image6.png&#34; alt=&#34;Self-hosted K8s&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä»€éº¼æ˜¯-vm-based-cluster&#34;&gt;ä»€éº¼æ˜¯ VM-based Cluster&lt;/h3&gt;
&lt;p&gt;å…¬æœ‰é›²åªæä¾› VMï¼Œè‡ªå·±ç”¨å…¶å®ƒå·¥å…·æ­ K8s Components&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;kubeadm, kops, kubespray / docker, containerd, cri-o / container or systemd / &amp;hellip;&lt;/li&gt;
&lt;li&gt;è‡ªå·±ç®¡ç† control planeï¼ŒåŒ…å« etcd, apiserver, controller-manager, scheduler&lt;/li&gt;
&lt;li&gt;ä¾éœ€æ±‚é¸ç”¨å…¬æœ‰é›²æä¾›çš„æ¶æ§‹ï¼Œex VPC, ELB, EBS, S3, RDS, IAM, Route53, CloudWatch, CloudTrail&amp;hellip;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;Self-hosted control plane&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/self-hosted-k8s_hu426d0c2559fd3fd4ffe742ab5f7664a0_303564_eb8f55efbce8d718a4ef759ab3132d6a.webp 400w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/self-hosted-k8s_hu426d0c2559fd3fd4ffe742ab5f7664a0_303564_6e1c278b9cf5a58db30db69224462074.webp 760w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/self-hosted-k8s_hu426d0c2559fd3fd4ffe742ab5f7664a0_303564_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2024-10-23-upgrade-k8s-cluster/self-hosted-k8s_hu426d0c2559fd3fd4ffe742ab5f7664a0_303564_eb8f55efbce8d718a4ef759ab3132d6a.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ‰€ä»¥ç‚ºä½•è¦åœ¨awsä¸Šè‡ªæ¶-k8s&#34;&gt;æ‰€ä»¥ç‚ºä½•è¦åœ¨AWSä¸Šè‡ªæ¶ K8sï¼Ÿ&lt;/h3&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å› ç‚º-2016-å¹´çš„æ™‚å€™æ²’æœ‰-eks&#34;&gt;å› ç‚º 2016 å¹´çš„æ™‚å€™æ²’æœ‰ eks&lt;/h3&gt;
&lt;hr&gt;
&lt;h3 id=&#34;2015--å¹´æœ‰å¾ˆå¤š-self-hosted-k8s-è§£æ±ºæ–¹æ¡ˆ&#34;&gt;2015- å¹´æœ‰å¾ˆå¤š self-hosted k8s è§£æ±ºæ–¹æ¡ˆ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;2014/10/15 kubernetes v0.4 &lt;a href=&#34;https://github.com/kubernetes/kubernetes/releases/tag/v0.4&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;github&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;2014/11/04 &lt;a href=&#34;https://cloud.google.com/kubernetes-engine/docs/release-notes-archive#november_4_2014&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GKE release for 0.4.2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç•¶æ™‚æœ‰å¾ˆå¤šè§£æ±ºæ–¹æ¡ˆå†æä¾› self-hosted k8sï¼ŒåŸºæ–¼é€™äº›æ–¹æ¡ˆï¼Œç”¢ç”Ÿ VM-based k8s
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/getamis/vishwakarma&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;github.com/getamis/vishwakarma&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;2017/10/24 &lt;a href=&#34;https://azure.microsoft.com/en-us/blog/introducing-azure-container-service-aks-managed-kubernetes-and-azure-container-registry-geo-replication/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AKS generally available&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;2018/06/05 &lt;a href=&#34;https://aws.amazon.com/blogs/aws/amazon-eks-now-generally-available/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;EKS generally available&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;self-hosted-control-plane&#34;&gt;Self-hosted control plane&lt;/h3&gt;
&lt;p&gt;self-hosted control plane å…¶å¯¦ä¸é›£ï¼Œé‚£æ™‚æœ‰å¾ˆå¤šæˆç†Ÿçš„è§£æ±ºæ–¹æ¡ˆ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://chechia.net/zh-hant/talk/kubernetes-summit-get-started-with-etcd-kubernetes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s summit Etcd Workshop&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;é™ä½æœå‹™å•†ä¾è³´&lt;/li&gt;
&lt;li&gt;å¯ä»¥è·¨é›²ï¼Œè·¨åœ°ç«¯ï¼Œæ··åˆé›²&lt;/li&gt;
&lt;li&gt;è‡ªè¨‚åŒ–ï¼Œæ› VM disk imageï¼ŒCNIï¼ŒCSIï¼ŒIngress Controller&lt;/li&gt;
&lt;li&gt;æˆæœ¬æ§åˆ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;self-hosted-control-plane-å£è™•&#34;&gt;Self-hosted control plane: å£è™•&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;åœ˜éšŠå¤šåšä¸€äº›äº‹æƒ…&lt;/li&gt;
&lt;li&gt;å·¥ç¨‹å¸«å€‹äººå¯ä»¥(å¿…é ˆ)å­¸åˆ°å¾ˆå¤šæ±è¥¿&lt;/li&gt;
&lt;li&gt;cloud managed k8s è¶Šåšè¶Šå¥½ï¼Œè‡ªå·±æ¶çš„ç†ç”±è¶Šä¾†è¶Šå°‘&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;self-hosted-å¤šäº†è¦å‡ç´šçš„æ±è¥¿&#34;&gt;Self-hosted å¤šäº†è¦å‡ç´šçš„æ±è¥¿&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;VM: based image / package / CVEs (ä¸åœ¨ä»Šå¤©çš„ç¯„åœ)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/#manual-deployments&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s doc å»ºè­°çš„å‡ç´šé †åº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Etcd Cluster&lt;/li&gt;
&lt;li&gt;Control Plane
&lt;ul&gt;
&lt;li&gt;apiserver&lt;/li&gt;
&lt;li&gt;controller manager&lt;/li&gt;
&lt;li&gt;scheduler&lt;/li&gt;
&lt;li&gt;cloud controller manager&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kubernetes.io/images/docs/components-of-kubernetes.svg&#34; alt=&#34;https://kubernetes.io/images/docs/components-of-kubernetes.svg&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¯¦éš›ä¾†çœ‹å‡ç´šçš„æ­¥é©Ÿ&#34;&gt;å¯¦éš›ä¾†çœ‹å‡ç´šçš„æ­¥é©Ÿ&lt;/h3&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¯¦éš›å‡ç´šçš„é †åº&#34;&gt;å¯¦éš›å‡ç´šçš„é †åº&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç ”ç©¶æ±ºå®šå‡ç‰ˆç›®æ¨™
&lt;ul&gt;
&lt;li&gt;å¿…è®€ K8s CHANGELOG / Urgent Upgrade Notes&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æª¢æŸ¥ app çš„ç‰ˆæœ¬ä¾è³´ (i.e å‡ k8s æœƒå£çš„ app)
&lt;ul&gt;
&lt;li&gt;K8s resource API Deprecated&lt;/li&gt;
&lt;li&gt;App Controllers&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Etcd Cluster&lt;/li&gt;
&lt;li&gt;Apiserver
&lt;ul&gt;
&lt;li&gt;Controller Manager&lt;/li&gt;
&lt;li&gt;Scheduler&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Node (kubelet, kube-proxy, CNI agent)&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;äº‹å‰ç ”ç©¶è·Ÿè¦åŠƒ&#34;&gt;äº‹å‰ç ”ç©¶è·Ÿè¦åŠƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç¢ºèªç›®å‰ç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;ç›®æ¨™ç‰ˆæœ¬
&lt;ul&gt;
&lt;li&gt;å‡ç‰ˆçš„ç›®çš„ï¼š(feature, EOL, &amp;hellip;)&lt;/li&gt;
&lt;li&gt;å…ƒä»¶å½¼æ­¤ç›¸å®¹çš„ç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;æ¯å€‹å°ç‰ˆè™Ÿ Release Cycle ~ 4 months&lt;/li&gt;
&lt;li&gt;æœ‰é‡ç–Šæ™‚é–“ï¼Œæ‰€ä»¥å¤§æ¦‚æ˜¯ 3 å€‹æœˆå‡ºä¸€ç‰ˆæ–°çš„&lt;/li&gt;
&lt;li&gt;path release ~ 8 months&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;k8s-release-cycle--4-months&#34;&gt;K8s Release Cycle ~ 4 months&lt;/h3&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kubernetes.io/images/releases/release-cycle.jpg&#34; alt=&#34;https://kubernetes.io/images/releases/release-cycle.jpg&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åŠ ä¸Š ~ 8 months patch release&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kubernetes.io/images/releases/release-lifecycle.jpg&#34; alt=&#34;https://kubernetes.io/images/releases/release-lifecycle.jpg&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¤šä¹…å‡ç´šä¸€æ¬¡-k8s&#34;&gt;å¤šä¹…å‡ç´šä¸€æ¬¡ k8s&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ¯å­£æ›´æ–°ä¸€æ¬¡
&lt;ul&gt;
&lt;li&gt;è·Ÿ featureï¼Œæ¯æ¬¡å‡ N+1 ç‰ˆ&lt;/li&gt;
&lt;li&gt;è·Ÿ EOLï¼Œæ¯æ¬¡å‡ N+1 ç‰ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ¯å¹´æ›´ï¼Œç¶­æŒåœ¨ EOL å‰ï¼Œæ¯æ¬¡å‡ N+3 ç‰ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å‡ç´šè®Šæˆ-routine&#34;&gt;å‡ç´šè®Šæˆ routine&lt;/h3&gt;
&lt;p&gt;æ›´æ–° k8s ä¹Ÿä¸æ˜¯çŸ­çŸ­å¹¾å¤©çš„å·¥ä½œï¼Œè¦æœ‰æ™‚é–“è¦åŠƒï¼Œæ¸¬è©¦ï¼Œæª¢æŸ¥&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é™¤äº†ç‰ˆæœ¬ä¸åŒï¼Œæ¯æ¬¡è¦åšçš„æµç¨‹é¡ä¼¼&lt;/li&gt;
&lt;li&gt;èˆ‡å…¶æ˜¯ä¸€å€‹ task æ›´åƒæ˜¯ä¸€å€‹ routine çš„å·¥ä½œ&lt;/li&gt;
&lt;li&gt;é‡é»è®Šæˆä¸æ˜¯å¤šä¹…æ›´æ–°ä¸€æ¬¡&lt;/li&gt;
&lt;li&gt;è€Œæ˜¯å¹¾ç„¶éœ€è¦å¸¸åšï¼Œè©²å¦‚ä½•&lt;strong&gt;æœ‰æ•ˆç‡(è‡ªå‹•åŒ–)çš„å®Œæˆå‡ç´š&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¿…è®€æ–‡ä»¶-k8s-changelog&#34;&gt;å¿…è®€æ–‡ä»¶ K8s CHANGELOG&lt;/h3&gt;
&lt;p&gt;Urgent Upgrade Notes (No, really, you MUST read this before you upgrade)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.31.md#urgent-upgrade-notes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CHANGELOG-1.31.md&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æœ€å°‘è¦çœ‹ Urgent Upgrade Notes è·Ÿ action required&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä¸çœ‹-changelog-çœŸçš„ä¸è¡Œå—&#34;&gt;ä¸çœ‹ CHANGELOG çœŸçš„ä¸è¡Œå—ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;å¯ä»¥ï¼Œæµç¨‹æœƒè®Šæˆ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;k8s å‡ç´šä¸Šå»&lt;/li&gt;
&lt;li&gt;ç™¼ç¾æœ‰æ±è¥¿å£æ‰ï¼Œé–‹å§‹ debug&lt;/li&gt;
&lt;li&gt;ä¸€è·¯å¾ app, infra, k8s resource, æŸ¥åˆ° k8s ä¸Šçš„å•é¡Œ&lt;/li&gt;
&lt;li&gt;æœ€å¾Œé‚„æ˜¯çœ‹äº† CHANGELOG&lt;/li&gt;
&lt;li&gt;ä½ ä»¥å¾Œå°±æœƒä¹–ä¹–çš„æŠŠ CHANGELOG çœ‹å®Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å‡ç´šäº‹å‰ç ”ç©¶è·Ÿè¦åŠƒ&#34;&gt;å‡ç´šäº‹å‰ç ”ç©¶è·Ÿè¦åŠƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;äº†è§£ k8s release lifecycle&lt;/li&gt;
&lt;li&gt;ä¾æ“šåœ˜éšŠæ”¿ç­–ï¼Œè¨­å®šæ›´æ–°é€±æœŸ&lt;/li&gt;
&lt;li&gt;äº†è§£ç›®å‰ç‰ˆæœ¬èˆ‡ç›®æ¨™ç‰ˆæœ¬çš„å·®ç•°&lt;/li&gt;
&lt;li&gt;ä¸Šè¿°å·¥ä½œè½‰ç‚ºé€±æœŸæ€§çš„å¸¸æ…‹å·¥ä½œ&lt;/li&gt;
&lt;li&gt;åŠ é€Ÿå‡ç´šçš„é€Ÿåº¦&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;éœ€è¦å‡ç´šçš„-k8s-components&#34;&gt;éœ€è¦å‡ç´šçš„ K8s Components&lt;/h3&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kubernetes.io/images/docs/components-of-kubernetes.svg&#34; alt=&#34;https://kubernetes.io/images/docs/components-of-kubernetes.svg&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;etcd-upgrade-å®˜æ–¹æ–‡ä»¶&#34;&gt;Etcd Upgrade å®˜æ–¹æ–‡ä»¶&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://etcd.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;åˆ†æ•£å¼ key-value store
&lt;ul&gt;
&lt;li&gt;å¯ä»¥ zero downtime rolling upgrade&lt;/li&gt;
&lt;li&gt;å¯ä»¥ zero downtime rolling downgrade&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;etcd-upgrade-æ­¥é©Ÿ&#34;&gt;Etcd Upgrade æ­¥é©Ÿ&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/upgrades/upgrade_3_5/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/upgrades/upgrade_3_5/&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;etcd åœ¨ minor version å‡ç´šæ™‚ï¼Œå¯ä»¥ zero downtime rolling upgrade&lt;/li&gt;
&lt;li&gt;ç¶­æŒ etcd cluster quorum&lt;/li&gt;
&lt;li&gt;delete then add member (ç¶­æŒ quorum å…ˆæ¸›å¾Œå¢ï¼‰&lt;/li&gt;
&lt;li&gt;ä¿ç•™ etcd data èˆ‡ endpoint ipï¼Œé–‹å›å¾Œç›´æ¥ä¸Šç·š&lt;/li&gt;
&lt;li&gt;åªéœ€ sync delete -&amp;gt; add ä¸­é–“çš„è³‡æ–™å·®&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;terraform-for-iac&#34;&gt;terraform for IaC&lt;/h3&gt;
&lt;p&gt;è¦æ›çš„ etcd VM å¯ä»¥æ‹†è§£æˆ terraform module&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;VM -&amp;gt; EC2&lt;/li&gt;
&lt;li&gt;base os -&amp;gt; AMI&lt;/li&gt;
&lt;li&gt;data disk (etcd data) -&amp;gt; EBS&lt;/li&gt;
&lt;li&gt;ip (etcd endpoint) -&amp;gt; ENI&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;etcd binary -&amp;gt; S3&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;etcd config / flags -&amp;gt; launch template / cloud init&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;terraform-gitflow&#34;&gt;terraform gitflow&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;PR æ”¹ binary etcd:v3.4.34 -&amp;gt; etcd:v3.5.4&lt;/li&gt;
&lt;li&gt;PR review -&amp;gt; è‡ªå‹• trigger terraform plan&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PR merge&lt;/strong&gt; -&amp;gt; è‡ªå‹• apply dev / stag&lt;/li&gt;
&lt;li&gt;è‡ªå‹•åŒ–åŸ·è¡Œæ¸¬è©¦&lt;/li&gt;
&lt;li&gt;Monitoring ç›£æ¸¬ä¸€ç›´éƒ½åœ¨&lt;/li&gt;
&lt;li&gt;æœ‰å•é¡Œ: revert PR è‡ªå‹• rollback&lt;/li&gt;
&lt;li&gt;æ²’å•é¡Œ: &lt;strong&gt;äººå·¥ç¢ºèªä¸Šè¿°æ­¥é©Ÿï¼Œé–‹å‡º prod PR&lt;/strong&gt; -&amp;gt; è‡ªå‹• apply prod&lt;/li&gt;
&lt;li&gt;æœ‰å•é¡Œ: revert PR è‡ªå‹• rollback&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h5 id=&#34;å¾å°ˆæ³¨å®Œæˆå‡ç´šè®Šæˆå°ˆæ³¨åœ¨è‡ªå‹•åŒ–æµç¨‹&#34;&gt;å¾å°ˆæ³¨å®Œæˆå‡ç´šï¼Œè®Šæˆå°ˆæ³¨åœ¨è‡ªå‹•åŒ–æµç¨‹&lt;/h5&gt;
&lt;p&gt;å…¶ä»– k8s å…ƒä»¶çš„ç®¡ç†ä¹Ÿæ˜¯åŒæ¨£æ–¹å¼ï¼Œå°‡äººå·¥é™åˆ°æœ€ä½&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;etcd-upgrade-è©²æ³¨æ„&#34;&gt;Etcd Upgrade è©²æ³¨æ„&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://etcd.io/docs/v3.5/op-guide/failures/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://etcd.io/docs/v3.5/op-guide/failures/&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Majority of members are unreachable&lt;/li&gt;
&lt;li&gt;Network partition&lt;/li&gt;
&lt;li&gt;éµå®ˆ SOP å…ˆæ¸›å¾Œå¢&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;kube-apiserver&#34;&gt;kube-apiserver&lt;/h3&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kubernetes.io/images/docs/components-of-kubernetes.svg&#34; alt=&#34;https://kubernetes.io/images/docs/components-of-kubernetes.svg&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;apiserver-doc&#34;&gt;apiserver doc&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/#manual-deployments&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/#manual-deployments&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆå‡ç´š kubectl&lt;/li&gt;
&lt;li&gt;apiserver å°ç‰ˆè™Ÿ rolling upgrade zero downtime&lt;/li&gt;
&lt;li&gt;å¦‚æœå»ºç«‹ k8s æ™‚æœ‰ç”¨å·¥å…·/å¹³å°ï¼Œex kubeadm, kops, kubesprayï¼Œæœƒæœ‰å°æ‡‰çš„å‡ç´šæŒ‡ä»¤&lt;/li&gt;
&lt;li&gt;terraform ç›´æ¥æ›´æ› apiserver ç¯€é»&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;supported-version-skew&#34;&gt;Supported Version Skew&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/releases/version-skew-policy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/releases/version-skew-policy/&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;kube-apiserver å½¼æ­¤æœ€å¤šå·® 1 å€‹å°ç‰ˆè™Ÿ
&lt;ul&gt;
&lt;li&gt;1.30 å‡ 1.31 éç¨‹å¯ä»¥ç„¡ç—›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;controller manager, scheduler, cloud controller manager
&lt;ul&gt;
&lt;li&gt;(vs apiserver) æœ€å¤šå·® 1 å€‹å°ç‰ˆè™Ÿ&lt;/li&gt;
&lt;li&gt;å‡ç´š apiserver å¾Œï¼Œè·Ÿè‘—å‡ç´šåŒæ¿&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;kubelet, kube-proxy
&lt;ul&gt;
&lt;li&gt;(vs apiserver) æœ€å¤šå·® 3 å€‹å°ç‰ˆè™Ÿ&lt;/li&gt;
&lt;li&gt;apiserver 1.30 å‡ 1.31 æ™‚ï¼Œnode 1.28, 1.29, 1.30 å¯ä»¥ç„¡ç—›&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;api-deprecated&#34;&gt;api deprecated&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/reference/using-api/deprecation-guide/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Deprecated API Migration Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/reference/using-api/deprecation-policy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Deprecation policy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä½¿ç”¨å·¥å…·æƒæ-k8s-resource&#34;&gt;ä½¿ç”¨å·¥å…·æƒæ k8s resource&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•ç¢ºèª app çš„ k8s resource æœ‰æ²’æœ‰ä½¿ç”¨åˆ° deprecated API&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/doitintl/kube-no-trouble&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/doitintl/kube-no-trouble&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;åŠ å…¥åˆ°å‡ç´šæµç¨‹ï¼Œè‡ªå‹•åŒ–
&lt;ul&gt;
&lt;li&gt;ï¼ˆæ²’å‡ç´šçš„æ™‚å€™ï¼‰é€±æœŸæ€§çš„æƒæ&lt;/li&gt;
&lt;li&gt;app é–‹ç™¼çš„ CI æ‡‰è©²å°å…¥ &lt;code&gt;lint --kube-version&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœæœ‰ app ä½¿ç”¨åˆ° deprecated APIï¼Œé€šçŸ¥ app owner ææ—©æ›´æ–°&lt;/li&gt;
&lt;li&gt;å‡ç´šå‰å†æƒæä¸€æ¬¡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;kube-no-trouble&#34;&gt;kube-no-trouble&lt;/h3&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/kube-no-trouble_huae4424a7ba0c58768cc463bb0b5fb679_352975_5f8ff898c063224b5b8bd4b5d3a8e711.webp 400w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/kube-no-trouble_huae4424a7ba0c58768cc463bb0b5fb679_352975_a0b87251be297a9a21bc74efd5176e4f.webp 760w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/kube-no-trouble_huae4424a7ba0c58768cc463bb0b5fb679_352975_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2024-10-23-upgrade-k8s-cluster/kube-no-trouble_huae4424a7ba0c58768cc463bb0b5fb679_352975_5f8ff898c063224b5b8bd4b5d3a8e711.webp&#34;
               width=&#34;760&#34;
               height=&#34;451&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç”¢ç”Ÿæ–°ç‰ˆ-apiserver-vm&#34;&gt;ç”¢ç”Ÿæ–°ç‰ˆ apiserver VM&lt;/h3&gt;
&lt;p&gt;è¦æ›çš„ apiserver VM&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;VM -&amp;gt; EC2&lt;/li&gt;
&lt;li&gt;base os -&amp;gt; AMI&lt;/li&gt;
&lt;li&gt;Auto Scaling Group + Load balancer&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ›´æ–°apiserver binary&lt;/strong&gt; -&amp;gt; S3 launch template / cloud formation&lt;/li&gt;
&lt;li&gt;apiserver config / flags -&amp;gt; launch template / cloud init&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç§»é™¤èˆŠç‰ˆ-apiserver-graceful-shutdown&#34;&gt;ç§»é™¤èˆŠç‰ˆ apiserver graceful shutdown&lt;/h3&gt;
&lt;p&gt;load balancer -&amp;gt; auto scaling group -&amp;gt; EC2 instance&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€é load balancer çš„è¨­å®šï¼Œç¢ºä¿ apiserver æœ‰è¶³å¤ çš„æ™‚é–“é›¢ç·š
&lt;ul&gt;
&lt;li&gt;request éƒ½å·²è™•ç†å®Œ&lt;/li&gt;
&lt;li&gt;load balancer é—œé–‰é€£å…¥&lt;/li&gt;
&lt;li&gt;ç­‰å¾… graceful periodï¼Œç¢ºèªæ²’æœ‰ request&lt;/li&gt;
&lt;li&gt;é—œé–‰æœå‹™ï¼Œé—œé–‰ EC2 instance&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç›£æ¸¬ apiserver çš„ metricsï¼ŒéŒ¯èª¤ç‡æé«˜è‡ªå‹•å‘Šè­¦&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;scheduler-and-controller-manager&#34;&gt;scheduler and controller manager&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœæ˜¯ master VM (api-server, scheduler, controller manager, cloud controller manager)
&lt;ul&gt;
&lt;li&gt;ä¸€èµ·å‡ç´š&lt;/li&gt;
&lt;li&gt;ä¸€èµ·å»ºç«‹æ–°ç‰ˆ VM&lt;/li&gt;
&lt;li&gt;ä¸€èµ·ç§»é™¤èˆŠç‰ˆ VM&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¦‚æœæ˜¯å…¶ä»–æ–¹å¼ applyï¼Œä¾ç…§å°æ‡‰çš„å‡ç´šæŒ‡ä»¤&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä¾è³´-k8s-api-çš„-app&#34;&gt;ä¾è³´ k8s api çš„ app&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/architecture/controller/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/concepts/architecture/controller/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;è¨±å¤š controller æœƒéœ€è¦ä¾è³´ç‰¹å®šçš„ k8s api
&lt;ul&gt;
&lt;li&gt;é€²è€Œä¾è³´ç‰¹å®šç‰ˆæœ¬çš„ k8s&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æœƒæ‰“ k8s api çš„ app
&lt;ul&gt;
&lt;li&gt;è‡ªå®¶å¯«çš„ app æœ‰ç”¨ k8s &lt;a href=&#34;https://github.com/kubernetes/client-go&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;client-go&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;app-å‡ç´šæª¢æŸ¥&#34;&gt;app å‡ç´šæª¢æŸ¥&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æƒæ k8s resource ä½¿ç”¨çš„ api version å¤§éƒ¨åˆ†æƒå¾—å‡ºä¾†&lt;/li&gt;
&lt;li&gt;å„ controller çš„æ–‡ä»¶æ‰æœƒæè¿°ç‚ºä½•æœ‰ç‰ˆæœ¬ä¾è³´
&lt;ul&gt;
&lt;li&gt;ä»¥åŠå¦‚ä½•å‡ç´š app controller åˆ°æ–°ç‰ˆçš„ k8s api&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åœ˜éšŠæ‡‰ç¶­è­·&lt;strong&gt;ä¾è³´ k8s api çš„æœå‹™åˆ—è¡¨&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æˆ–æ˜¯ä½¿ç”¨å·¥å…· or script å¿«é€Ÿåˆ—å‡º cluster å…§éƒ¨çš„æœå‹™&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.nginx.com/nginx-ingress-controller/technical-specifications/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.nginx.com/nginx-ingress-controller/technical-specifications/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/nginx-ingress-controller_hucf9b38e708dc650dbc3b047c0d0220b8_521288_3369f589e454621284e1b163a93cee54.webp 400w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/nginx-ingress-controller_hucf9b38e708dc650dbc3b047c0d0220b8_521288_19bbcde2d15f9dfcd645bda783e6b053.webp 760w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/nginx-ingress-controller_hucf9b38e708dc650dbc3b047c0d0220b8_521288_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2024-10-23-upgrade-k8s-cluster/nginx-ingress-controller_hucf9b38e708dc650dbc3b047c0d0220b8_521288_3369f589e454621284e1b163a93cee54.webp&#34;
               width=&#34;760&#34;
               height=&#34;372&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.nginx.com/nginx-ingress-controller/technical-specifications/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.nginx.com/nginx-ingress-controller/technical-specifications/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/nginx-ingress-controller-support-version_hufbac6fd8436dc2c38d9f2e682a695f69_247330_65c4a048be66873d995726b0b6cb1534.webp 400w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/nginx-ingress-controller-support-version_hufbac6fd8436dc2c38d9f2e682a695f69_247330_c10047e257b9ad72be0e9309ef297c93.webp 760w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/nginx-ingress-controller-support-version_hufbac6fd8436dc2c38d9f2e682a695f69_247330_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2024-10-23-upgrade-k8s-cluster/nginx-ingress-controller-support-version_hufbac6fd8436dc2c38d9f2e682a695f69_247330_65c4a048be66873d995726b0b6cb1534.webp&#34;
               width=&#34;760&#34;
               height=&#34;674&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°çµk8s-control-plane-å‡ç´š&#34;&gt;å°çµï¼šk8s control plane å‡ç´š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;etcd&lt;/li&gt;
&lt;li&gt;changelog&lt;/li&gt;
&lt;li&gt;apiserver
&lt;ul&gt;
&lt;li&gt;api deprecation&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;scheduler, controller manager&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;node-å‡ç´š&#34;&gt;Node å‡ç´š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;kubelet, kube-proxy å‡ç´šæœ¬èº«ä¸æ˜¯å•é¡Œ&lt;/li&gt;
&lt;li&gt;éœ€è¦æ¬ç§» worklaod&lt;/li&gt;
&lt;li&gt;æœ‰æ²’æœ‰ worklaod ä¾è³´ k8s api (ex. &lt;a href=&#34;https://github.com/kubernetes/client-go&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;client-go&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰çš„è©±æ‡‰è©²æ”¶éŒ„ä¸Šå‡ç´šçš„æœå‹™åˆ—è¡¨ï¼Œæ¯æ¬¡å‡ç´šéƒ½éœ€è¦æª¢æŸ¥&lt;/li&gt;
&lt;li&gt;æœ‰ç›´æ¥èˆ‡ k8s api äº’å‹•çš„ appï¼Œå¼·çƒˆå»ºè­°è¦å¯« unit test&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;node-å‡ç´šç°¡å–®ä¾†èªªæ˜¯å»ºæ–°æ‹†èˆŠ&#34;&gt;Node å‡ç´šç°¡å–®ä¾†èªªæ˜¯å»ºæ–°æ‹†èˆŠ&lt;/h3&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kubernetes.io/images/docs/components-of-kubernetes.svg&#34; alt=&#34;https://kubernetes.io/images/docs/components-of-kubernetes.svg&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;node-å‡ç´šéœ€è¦æ¬ç§»-worklaod&#34;&gt;Node å‡ç´šéœ€è¦æ¬ç§» worklaod&lt;/h3&gt;
&lt;p&gt;é–‹æ–°çš„ nodeï¼ŒèˆŠçš„ node ä¸Šçš„ workload éœ€è¦è½‰ç§»&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æº–å‚™ç©º node&lt;/li&gt;
&lt;li&gt;èˆŠ node æ‰“ä¸Š node taintï¼Œé¿å… worklaod è·‘ä¸Šå»&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¾åº&lt;/strong&gt;é‡å•Ÿ workload
&lt;ul&gt;
&lt;li&gt;app å½¼æ­¤å¯èƒ½æœƒæœ‰ä¾è³´é—œä¿‚ï¼Œi.e. é‡å•Ÿ a æ™‚ b æœƒå™´éŒ¯&lt;/li&gt;
&lt;li&gt;ex. backend + in-k8s redis&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æˆ–æ˜¯ä¾ç…§ node drain node&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;workload-retry&#34;&gt;Workload retry&lt;/h3&gt;
&lt;p&gt;app è¦å¯¦ä½œ auto retryï¼Œä¾†è™•ç†æš«æ™‚æ–·ç·šèˆ‡é”åˆ° auto recovery&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é‡å•Ÿ workload å¯èƒ½é€ æˆå¤§é‡çš„é‡å•Ÿ&lt;/li&gt;
&lt;li&gt;åŒæ™‚å¤§é‡ connect + retry æœ‰å¯èƒ½æœƒæ‰“å£è¢«ä¾è³´çš„æœå‹™
&lt;ul&gt;
&lt;li&gt;ex. backend + in-k8s redisï¼Œå¤§é‡çš„ backend pod åŒæ™‚é‡å•Ÿï¼Œæœƒæ‰“å£ redis&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ‰€ä»¥é‚„è¦å¯¦ä½œ retry delay, timeout backoff&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¦‚ä½•é‡å•Ÿæœ‰ä¾è³´çš„-workload&#34;&gt;å¦‚ä½•é‡å•Ÿæœ‰ä¾è³´çš„ Workload&lt;/h3&gt;
&lt;p&gt;ä¾æ“šåœ˜éšŠçš„ç›®æ¨™è€Œå®š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ex ç›®æ¨™æ˜¯æœ€å°‘æ•´é«”é‡å•Ÿæ¬¡æ•¸&lt;/li&gt;
&lt;li&gt;å…ˆé‡å•Ÿè¢«ä¾è³´çš„æœå‹™ ex. redis&lt;/li&gt;
&lt;li&gt;åœ¨é‡å•Ÿä¾è³´çš„æœå‹™ ex. backend&lt;/li&gt;
&lt;li&gt;è€ƒé©—æœå‹™çš„ replication æ•¸é‡æ˜¯å¦è¶³å¤ ï¼Œèƒ½å¦æ”¯æ’å¤§é‡é‡å•Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;ä¾åºé‡å•Ÿ-workloadæ‡‰è©²è®Šæˆè‡ªå‹•åŒ–çš„è…³æœ¬&#34;&gt;ä¾åºé‡å•Ÿ workloadï¼Œæ‡‰è©²è®Šæˆè‡ªå‹•åŒ–çš„è…³æœ¬&lt;/h5&gt;
&lt;hr&gt;
&lt;h3 id=&#34;é©—è­‰&#34;&gt;é©—è­‰&lt;/h3&gt;
&lt;p&gt;Workload è½‰ç§»åˆ°æ–°ç‰ˆæœ¬ï¼Œæ¸¬è©¦ worklaod æ˜¯å¦æ­£å¸¸é‹ä½œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é‡å° worklaod æœ‰è¨­å®š monitoring èˆ‡ metrics&lt;/li&gt;
&lt;li&gt;ex. cpu, memory å‡ç´šå¾Œå¢åŠ å¤ªå¤šï¼Œæˆ–æ˜¯ç”¨çš„å¤ªå°‘&lt;/li&gt;
&lt;li&gt;ex. api åœ¨é‡å•Ÿéç¨‹ä¸­å™´ 5xxï¼Œ5xx çš„æ¬¡æ•¸ç•°å¸¸å¢åŠ ï¼Œè‡ªå‹• alert&lt;/li&gt;
&lt;li&gt;ex. api, websocket éŒ¯èª¤æ¯”ä¾‹å¢åŠ &lt;/li&gt;
&lt;li&gt;ex. non 2xx çš„ access log é‡å¢åŠ &lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;èˆ‡å…¶èªªæ˜¯æ¸¬è©¦æ›´åƒæ˜¯æŠŠæŒçºŒç›£æ§åšå€‹æ›´å®Œæ•´&#34;&gt;èˆ‡å…¶èªªæ˜¯æ¸¬è©¦ï¼Œæ›´åƒæ˜¯æŠŠæŒçºŒç›£æ§åšå€‹æ›´å®Œæ•´&lt;/h5&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å‡ç´šå¾Œè·¨ç’°å¢ƒæ¸¬è©¦&#34;&gt;å‡ç´šå¾Œè·¨ç’°å¢ƒæ¸¬è©¦&lt;/h3&gt;
&lt;p&gt;åœ¨æ¸¬è©¦ç’°å¢ƒå°å…¥æ›´å¤šæ¸¬è©¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;chaos engineering åœ¨å¹³æ™‚å°±æŒçºŒæ³¨å…¥ errorï¼Œæ ¹æ“š scenario è¨­å®š k8s çš„åæ‡‰
&lt;ul&gt;
&lt;li&gt;ex. chaos monkey, chaos mesh&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;load testing æ¸¬è©¦ app åœ¨æ–°ç‰ˆæœ¬ k8s ä¸Šçš„æ•ˆèƒ½
&lt;ul&gt;
&lt;li&gt;ex. &lt;a href=&#34;https://github.com/grafana/k6&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/grafana/k6&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;éå»çš„ incident çš„æ¸¬è©¦ script&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;ä¸æ˜¯ç‚ºäº†å‡ç´šå°å…¥é€™äº›æ¸¬è©¦è€Œæ˜¯å› ç‚ºæœ‰äº†é€™äº›æ¸¬è©¦è®“å‡ç´šæ›´æœ‰ä¿¡å¿ƒ&#34;&gt;ä¸æ˜¯ç‚ºäº†å‡ç´šå°å…¥é€™äº›æ¸¬è©¦ï¼Œè€Œæ˜¯å› ç‚ºæœ‰äº†é€™äº›æ¸¬è©¦ï¼Œè®“å‡ç´šæ›´æœ‰ä¿¡å¿ƒ&lt;/h5&gt;
&lt;hr&gt;
&lt;h5 id=&#34;k8s-å‡ç´šæœ‰å•é¡Œä¸æ˜¯æœ‰å•é¡Œ&#34;&gt;K8s å‡ç´šæœ‰å•é¡Œï¼Œä¸æ˜¯æœ‰å•é¡Œ&lt;/h5&gt;
&lt;h5 id=&#34;å¤ªæ™šç™¼ç¾æ‰æ˜¯å•é¡Œ&#34;&gt;å¤ªæ™šç™¼ç¾æ‰æ˜¯å•é¡Œ&lt;/h5&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¥½çš„ç›£æ¸¬æ˜¯å‡ç´šçš„ä¿è­·å‚˜&#34;&gt;å¥½çš„ç›£æ¸¬æ˜¯å‡ç´šçš„ä¿è­·å‚˜&lt;/h3&gt;
&lt;hr&gt;
&lt;p&gt;æ€éº¼çŸ¥é“ k8s å‡ç´šæœ‰æ²’æœ‰å£ï¼Ÿç”¨ kubectl æ‰“çœ‹çœ‹&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;while true; do
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    kubectl get pods -n kube-system; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    sleep 2;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;done
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;ç›£æ¸¬&#34;&gt;ç›£æ¸¬&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢çš„å„å€‹æ­¥é©Ÿéƒ½ä»°è³´ç›£æ¸¬è‡ªå‹•å‘Šè­¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…ƒä»¶å£äº†ï¼Œè¦æœ‰ç›£æ¸¬ç´€éŒ„&lt;/li&gt;
&lt;li&gt;é‡è¦å…ƒä»¶å£äº†ï¼Œè¦ä¸»å‹•å‘Šè­¦&lt;/li&gt;
&lt;li&gt;æ²’å£ä½†æ˜¯æœ‰ç•°å¸¸è®Šå‹•ï¼Œè¦ä¸»å‹•å‘Šè­¦&lt;/li&gt;
&lt;li&gt;å‡ºéŒ¯æ²’ç›£æ¸¬åˆ°ï¼Œè£œä¸Šç›£æ¸¬è·Ÿæ¸¬è©¦ï¼Œå†ä¾†ä¸€æ¬¡ï¼Œç´¯ç©æ–°ç‰ˆæœ¬çš„ä¿¡å¿ƒ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç›£æ¸¬åƒè€ƒå·¥å…·&#34;&gt;ç›£æ¸¬åƒè€ƒå·¥å…·&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/prometheus-operator/prometheus-operator&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;prometheus-operator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;prometheus&lt;/li&gt;
&lt;li&gt;grafana&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes-monitoring/kubernetes-mixin/tree/master/dashboards&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;kubernetes-mixin&lt;/a&gt; alert, rule, dashboards
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://samber.github.io/awesome-prometheus-alerts/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://samber.github.io/awesome-prometheus-alerts/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;é¡˜æ™¯è‡ªå‹•åŒ–-k8s-å‡ç´š&#34;&gt;é¡˜æ™¯ï¼šè‡ªå‹•åŒ– k8s å‡ç´š&lt;/h3&gt;
&lt;p&gt;ä»Šå¤©è¨è«–çš„æ­¥é©Ÿï¼Œæœ‰å“ªäº›å¯ä»¥é€²ä¸€æ­¥å†è‡ªå‹•åŒ–çš„&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çœ‹ CHANGELOGï¼Œé¸å®šç›®æ¨™ç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;æƒææœå‹™ k8s api version&lt;/li&gt;
&lt;li&gt;æ’ç¨‹å‡ç´šçš„æ™‚é–“&lt;/li&gt;
&lt;li&gt;å‡ç´š etcd&lt;/li&gt;
&lt;li&gt;å‡ç´š kube-apiserver, scheduler, controller manager&lt;/li&gt;
&lt;li&gt;å‡ç´š node&lt;/li&gt;
&lt;li&gt;é·ç§» workload&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;were-hiring&#34;&gt;We&amp;rsquo;re hiring!&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cake.me/companies/maicoin/jobs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.cake.me/companies/maicoin/jobs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/we-re-hiring_hu7224f98eba3fbc175440ef1f6bf665c9_15949_9da35ea5399dd4b247c69c19f4c75987.webp 400w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/we-re-hiring_hu7224f98eba3fbc175440ef1f6bf665c9_15949_55917817014d7ac627b45f9c4a791867.webp 760w,
               /zh-hant/slides/2024-10-23-upgrade-k8s-cluster/we-re-hiring_hu7224f98eba3fbc175440ef1f6bf665c9_15949_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2024-10-23-upgrade-k8s-cluster/we-re-hiring_hu7224f98eba3fbc175440ef1f6bf665c9_15949_9da35ea5399dd4b247c69c19f4c75987.webp&#34;
               width=&#34;400&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;åƒè€ƒè³‡æ–™&#34;&gt;åƒè€ƒè³‡æ–™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/cluster-upgrade/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Overview: Official doc&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Cloud Summit: Cloud Infrastructure Saving Engineering  é›²ç«¯çœéŒ¢å·¥ç¨‹</title>
      <link>https://chechia.net/zh-hant/slides/2024-07-03-saving-money-on-cloud-k8s/</link>
      <pubDate>Mon, 01 Jul 2024 12:45:00 +0000</pubDate>
      <guid>https://chechia.net/zh-hant/slides/2024-07-03-saving-money-on-cloud-k8s/</guid>
      <description>
&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;onepiece.png&#34;
  &gt;

&lt;aside class=&#34;notes&#34;&gt;
  æŠ•å½±ç‰‡è·Ÿè¬›ç¨¿æˆ‘éƒ½æ”¾åœ¨æˆ‘çš„ç¶²ç«™ä¸Šï¼Œå¦‚æœæœ‰èˆˆè¶£å¯ä»¥åƒè€ƒ
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;é›²ç«¯k8sçœéŒ¢å·¥ç¨‹&#34;&gt;é›²ç«¯K8sçœéŒ¢å·¥ç¨‹&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Che Chia Chang&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  å…©å€‹é—œéµå­—ï¼šé›²ç«¯ / k8s
å¦‚æœä½ æœ‰åœ¨ä½¿ç”¨å…¬æœ‰é›²ï¼Œè€Œä¸”æœ‰åœ¨è·‘ k8sï¼Œä½ æ˜¯é€™ç¯‡æ¼”è¬›çš„æœ€ä¸»è¦å°è±¡
å¦‚æœä½ æ˜¯ç§æœ‰é›² k8sï¼Œæˆ–æ˜¯å…¶ä»–çš„é›²ç«¯æœå‹™ï¼Œæœ‰ä¸€äº›ç›¸é€šçš„æ¦‚å¿µï¼Œæœƒæœ‰ä¸€äº›åƒè€ƒåƒ¹å€¼
å¦‚æœä½ æ˜¯åœ°ç«¯çš„æ©Ÿå™¨ï¼Œé›–ç„¶æ¦‚å¿µç›¸åŒï¼Œä½†æˆæœ¬æ§åˆ¶çš„åšæ³•å®Œå…¨æ˜¯å¦å¤–ä¸€å€‹æ•…äº‹ï¼Œä½ å¯ä»¥ç•¶åˆä¼‘æ™‚é–“çš„æ•…äº‹è½è½çœ‹
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;é—œæ–¼æˆ‘&#34;&gt;é—œæ–¼æˆ‘&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Che Chia Chang&lt;/li&gt;
&lt;li&gt;SRE @ &lt;a href=&#34;https://www.linkedin.com/company/maicoin/jobs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Maicoin&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://mvp.microsoft.com/zh-TW/MVP/profile/e407d0b9-5c01-eb11-a815-000d3a8ccaf5&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Microsoft MVP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å€‹äººéƒ¨è½æ ¼&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;chechia.net&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;presentation and speaker notes&lt;/li&gt;
&lt;li&gt;éµäººè³½ (Terraform / Vault æ‰‹æŠŠæ‰‹å…¥é–€)&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¤§ç¶±&#34;&gt;å¤§ç¶±&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å…¬æœ‰é›²çš„è²»ç”¨&lt;/li&gt;
&lt;li&gt;ç¯€çœç®—åŠ›æˆæœ¬&lt;/li&gt;
&lt;li&gt;ç›£æ§æ˜¯æˆæœ¬æ§ç®¡çš„åŸºç¤&lt;/li&gt;
&lt;li&gt;å°å…¥æˆæœ¬åˆ†æèˆ‡é æ¸¬å·¥å…·&lt;/li&gt;
&lt;li&gt;è‡ªå‹•åŒ–è³‡æºä½¿ç”¨å»ºè­°&lt;/li&gt;
&lt;li&gt;Saving Plan/Committed Usage&lt;/li&gt;
&lt;li&gt;Spot Instance èˆ‡å¾®æœå‹™&lt;/li&gt;
&lt;li&gt;Autoscaling: HPA / VPA&lt;/li&gt;
&lt;li&gt;Q&amp;amp;A&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;é€™æ˜¯æˆ‘å€‘ä»Šå¤©çš„å¤§ç¶±&lt;/p&gt;
&lt;p&gt;æˆ‘å€‘æœƒå…ˆè¬›ä¸€ä¸‹åœ¨å…¬æœ‰é›²ä¸Šçš„æˆæœ¬
ç„¶å¾Œè¬›ä¸€ä¸‹ k8s çš„é‹ç®—è³‡æºç®¡ç†
æ¥è‘—è¬›ä¸€ä¸‹ç›£æ§ï¼Œç‚ºä½•æˆæœ¬æ§ç®¡çš„åŸºç¤æ˜¯ç›£æ§
å¦‚ä½•ä½¿ç”¨å·¥å…·æˆæœ¬åˆ†æï¼Œæœªä¾†æˆæœ¬é æ¸¬
ç„¶å¾Œä½¿ç”¨å·¥å…·å»ºè­°åˆé©çš„è³‡æº
æœ€å¾Œè¬›å¯¦å‹™ä¸Šè¦å¦‚ä½•é™ä½æˆæœ¬ï¼Œä¾‹å¦‚ saving plan / spot instance / HPA / VPAï¼Œä¾ç…§åŸ·è¡Œçš„é›£åº¦æ’åºï¼Œæœ‰æ™‚é–“çš„è©±ä¹Ÿæœƒè¬›å¦‚ä½•å¾ç„¡åˆ°æœ‰é–‹å§‹é€²è¡Œ&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å‹•æ©Ÿ&#34;&gt;å‹•æ©Ÿ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å…¬å¸å¸Œæœ›è³ºéŒ¢ï¼Œç¯€çœæˆæœ¬&lt;/li&gt;
&lt;li&gt;åœ˜éšŠå¸Œæœ›æ§åˆ¶æˆæœ¬&lt;/li&gt;
&lt;li&gt;å€‹äººç”¢ç”Ÿ Credit èˆ‡åœ˜éšŠ Impact&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  åœ˜éšŠè€Œè¨€ï¼Œæˆæœ¬æ§åˆ¶æ˜¯ä¸€å€‹å¾ˆé‡è¦çš„è­°é¡Œï¼Œå› ç‚ºæˆæœ¬æ§åˆ¶æ˜¯ä¸€å€‹å¾ˆç›´æ¥çš„å½±éŸ¿å…¬å¸ç²åˆ©çš„æ–¹å¼
å€‹äººï¼Œå¦‚æœç‚ºå…¬å¸ç¯€çœè¶…éå€‹äººçš„è–ªæ°´ï¼Œé‚£å…¬å¸è˜ç”¨ä½ å°±æ˜¯æ·¨è³º
ç¯€çœå…¬å¸é›²ç«¯æˆæœ¬ 50% è·æ¶¯ä¸Šå±¥æ­·å¾ˆå¥½çœ‹
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å…¬æœ‰é›²çš„è²»ç”¨&#34;&gt;å…¬æœ‰é›²çš„è²»ç”¨&lt;/h3&gt;
&lt;p&gt;æ‰“é–‹å…¬æœ‰é›²çš„ billing&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®—åŠ›æˆæœ¬ Compute Resource (cpu, memory)&lt;/li&gt;
&lt;li&gt;å„²å­˜æˆæœ¬ Storage (Disk, EBS, S3&amp;hellip;)&lt;/li&gt;
&lt;li&gt;ç¶²è·¯ Networking&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æœ‰åœ¨ä½¿ç”¨å…¬æœ‰é›²çš„äººï¼ŒæŠŠå…¬æœ‰é›²çš„ billing å¸³å–®æ‰“é–‹ä¾†çœ‹ï¼Œå¯èƒ½çœ‹åˆ°çš„å¤§æ¦‚æ˜¯é€™å¹¾å€‹é …ç›®
ç•¶ç„¶å› ç‚ºä¸åŒåœ˜éšŠçš„æœå‹™ä¸åŒï¼Œå¯èƒ½æœƒæœ‰ä¸€äº›å‡ºå…¥ï¼Œä½†å¦‚æœä½ çš„å…¬å¸çš„ç”¢å“æ˜¯ web serviceï¼Œæ‡‰è©²æœƒæœ‰é€™å¹¾å€‹é …ç›®
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä»Šå¤©åªæœƒè¬›é€™å€‹ç®—åŠ›æˆæœ¬&#34;&gt;ä»Šå¤©åªæœƒè¬›é€™å€‹ç®—åŠ›æˆæœ¬&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç®—åŠ›æˆæœ¬ Compute Resource (cpu, memory)&lt;/li&gt;
&lt;li&gt;ä»Šå¤©åªæœƒè¬›é€™å€‹&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;Storage ä¸å¤ªå¥½èªªçœå°±çœï¼Œå› ç‚ºä½ çš„è³‡æ–™é‡å°±åœ¨é‚£é‚Šï¼Œæ”¾ä¸ä¸‹å°±æ˜¯è¦å†è²·ï¼Œæ‰€ä»¥ storage çš„æˆæœ¬æ§åˆ¶ï¼Œå¯èƒ½æ˜¯åœ¨è³‡æ–™çš„ä½¿ç”¨ä¸Šï¼Œä¾‹å¦‚è³‡æ–™çš„å£“ç¸®ï¼Œæˆ–æ˜¯è³‡æ–™çš„å‚™ä»½ï¼Œæˆ–æ˜¯è³‡æ–™çš„å­˜å–æ–¹å¼ï¼Œé€™äº›æ˜¯å¦å¤–ä¸€å€‹æ•…äº‹
ä½¿ç”¨å…¬æœ‰é›²çš„æœå‹™ï¼ŒåŸºæœ¬ä¸Š storage éƒ½æ˜¯ä¾æ“šä½¿ç”¨çš„å¤§å°è¨ˆåƒ¹ï¼Œè€Œä¸”éœ€å¤šæœå‹™éƒ½å¯ä»¥å‹•æ…‹å¢é•·ï¼Œä¾‹å¦‚å‹•æ…‹å¢åŠ  disk&lt;/p&gt;
&lt;p&gt;Storage / Database / Networking é€™å¹¾å€‹é …ç›®ï¼Œæˆ‘å€‘ä¸‹é›†å†ä¾†è«‡&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç®—åŠ›æˆæœ¬&#34;&gt;ç®—åŠ›æˆæœ¬&lt;/h3&gt;
&lt;p&gt;ç¶²é æœå‹™çš„å¾®æœå‹™ç³»çµ±ï¼Œéƒ½éœ€è¦ç®—åŠ›&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;api server&lt;/li&gt;
&lt;li&gt;cronjob&lt;/li&gt;
&lt;li&gt;business logic job&lt;/li&gt;
&lt;li&gt;database
å¦‚éœ€ç¯€çœï¼Œä¹Ÿå¯ä»¥å¾é€™è£¡ä¸‹æ‰‹&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¦‚æœä½ è·Ÿæ•ç¤¾ä¸€æ¨£æ˜¯ web serviceï¼Œé‚£éº¼ cpu / memory å¯èƒ½æ˜¯ä½ æœ€å¤§çš„ä¸€ç­†æˆæœ¬&lt;/p&gt;
&lt;p&gt;ä½ éœ€è¦è¶³å¤ é‹ç®—èƒ½åŠ› serve å®¢æˆ¶ï¼Œä¸ç®¡æ˜¯æ”¯æŒç”¨æˆ¶çš„requestï¼Œé€²è¡Œå•†æ¥­é‚è¼¯çš„é‹ç®—ï¼Œç„¶å¾ŒæŠŠé‹ç®—å®Œæˆçš„ç‹€æ…‹å›å‚³çµ¦å®¢æˆ¶ï¼Œæˆ–æ˜¯å­˜åœ¨è³‡æ–™åº«ä¸­ï¼Œæ¯ä¸€å€‹å‹•ä½œéƒ½éœ€è¦ç®—åŠ›&lt;/p&gt;
&lt;p&gt;è¶³å¤ çš„ cpu è·Ÿ memoryï¼Œä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œè€Œæ˜¯è¶³å¤ ï¼Œä¸æœƒæµªè²»ï¼Œä¹Ÿä¸æœƒå› ç‚ºä¸è¶³è€Œå½±éŸ¿æœå‹™å“è³ª
æˆ‘å€‘è¦çœéŒ¢ï¼Œå°±è¦å¾é€™è£¡ä¸‹æ‰‹&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°‹æ‰¾å¤šé¤˜çš„ç®—åŠ›&#34;&gt;å°‹æ‰¾å¤šé¤˜çš„ç®—åŠ›&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å·²æœ‰è¶³å¤ çš„ cpu / memoryï¼Œå¤šçµ¦ä¹Ÿä¸æœƒå¢åŠ æœå‹™å“è³ªçš„å¤šé¤˜ç®—åŠ›&lt;/li&gt;
&lt;li&gt;å¤šå°‘æ‰æ˜¯å¤ ï¼Ÿ&lt;/li&gt;
&lt;li&gt;æ¸›å»å¤šå°‘ cpu / memoryï¼Œä¾ç„¶ä¸æ”¹è®Šæœå‹™å“è³ª&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¤šå°‘æ‰æ˜¯å¤ ï¼Ÿé€™æ˜¯ä¸€å€‹è¤‡é›œçš„å•é¡Œï¼Œå¯¦å‹™ä¸Šé€šå¸¸ä½¿ç”¨ SLA / SLO ä¾†è¡¡é‡æœå‹™å“è³ªï¼Œç„¶å¾Œæ ¹æ“šæœå‹™å“è³ªçš„è¦æ±‚ï¼Œä¾†è¨­å®š cpu / memory çš„é…é¡&lt;/p&gt;
&lt;p&gt;æˆ‘å€‘ä»Šå¤©è¦åšçš„æ˜¯æˆæœ¬å„ªåŒ–ï¼Œç™½è©±çš„èªªæ˜¯é™ä½ cpu / memory çš„è¨­å®šé…é¡ï¼Œä½†æ˜¯æˆ‘å€‘ä¸èƒ½é™ä½åˆ°å½±éŸ¿æœå‹™å“è³ª
ç”šè‡³é€€ä¸€ç™¾æ­¥ï¼Œé˜²å®ˆæ€§çš„ä¾†èªªï¼Œæˆ‘å€‘ä¸å¸Œæœ›å› ç‚ºé™ä½ cpu / memory çš„è¨­å®šé…é¡ï¼Œç‚ºäº†çœéŒ¢è€Œå°è‡´è² é¢çš„çµæœï¼Œç”šè‡³ç‚ºæœå‹™çš„ç©©å®šåº¦èƒŒé‹ã€‚&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¶­æŒslo&#34;&gt;ç¶­æŒSLO&lt;/h3&gt;
&lt;p&gt;ä»¥ç¶­æŒå„å€‹æœå‹™å…ƒä»¶çš„ SLOç‚ºå‰æï¼Œé™ä½ cpu / memory ä½¿ç”¨é‡&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;ç¶­æŒå€‹å€‹æœå‹™å…ƒä»¶çš„ SLO
æ˜¯ä¸€å€‹å¾ˆå¥½çš„æŒ‡æ¨™ï¼Œå¦‚æœä½ çš„æœå‹™æ˜¯ 99.9% çš„ SLAï¼Œé‚£éº¼ä½ çš„æœå‹™å°±è¦ä¿è­‰ 99.9% çš„æ™‚é–“éƒ½æ˜¯æ­£å¸¸é‹ä½œçš„ï¼Œé‚£éº¼ä½ çš„ cpu / memory å°±è¦è¶³å¤ æ”¯æŒé€™å€‹ SLA&lt;/p&gt;
&lt;p&gt;è«‡ SLO ä¹‹å‰ï¼Œä½ è¦å…ˆçŸ¥é“ä½ çš„æœå‹™çš„ SLA æ˜¯å¤šå°‘ï¼Œä½ è¦å…ˆçŸ¥é“ç•¶å‰çš„ç‹€æ…‹æ˜¯å¤šå°‘
é€™å€‹åœ¨ç¨å¾Œçš„ monitoring æœƒæåˆ°ï¼Œç‚ºä»€éº¼ç›£æ§æ˜¯æˆæœ¬ç®¡ç†çš„åŸºç¤&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;åŸºæ–¼-slo-çš„æˆæœ¬èª¿é™&#34;&gt;åŸºæ–¼ SLO çš„æˆæœ¬èª¿é™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è² è¼‰ç©©å®šçš„å…ƒä»¶ï¼Œå¯ä»¥æŠ“éå» 30d çš„ p99 cpu time æˆ– p99 memory usage + buffer&lt;/li&gt;
&lt;li&gt;è² è¼‰ä¸ç©©å®šçš„å…ƒä»¶ï¼Œä¾‹å¦‚ cpu usage èˆ‡å—æ´»èºç”¨æˆ¶æ•¸é‡æ­£æ¯”ï¼Œéœ€è¦æ­é… HPA æ°´å¹³æ‹“å±•&lt;/li&gt;
&lt;li&gt;è² è¼‰ä¸ç©©å®šçš„å…ƒä»¶ï¼Œä½†åˆä¸èƒ½æ°´å¹³æ‹“å±•ï¼Œä¾‹å¦‚ stateful serviceï¼Œå¯ä»¥è€ƒæ…® VPA&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  è² è¼‰ç©©å®šçš„å…ƒä»¶ï¼Œå›ºå®šåƒå¤šå°‘ cpu / memoryï¼Œä»–çš„é™„è¼‰ä¸å¤ªå®¹æ˜“éš¨å¤–éƒ¨å› ç´ æ³¢å‹•çš„æœå‹™ï¼Œå¯ä»¥æŠ“éå» 30d çš„ p99 cpu time æˆ– p99 memory usage + bufferï¼Œç„¶å¾Œé™ä½ cpu / memory çš„è¨­å®šé…é¡
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°çµæˆæœ¬æ§ç®¡çš„åŸºæœ¬æ¦‚å¿µ&#34;&gt;å°çµï¼šæˆæœ¬æ§ç®¡çš„åŸºæœ¬æ¦‚å¿µ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å°‹æ‰¾æœå‹™ä¸­å¤šé¤˜ç®—åŠ›&lt;/li&gt;
&lt;li&gt;ä»¥ç¶­æŒ SLO ç‚ºå‰æ&lt;/li&gt;
&lt;li&gt;é™ä½ cpu / memory ä½¿ç”¨é‡&lt;/li&gt;
&lt;li&gt;ä¾æ“šå…ƒä»¶è² è¼‰ç‰¹æ€§ï¼Œé¸æ“‡é©ç•¶çš„èª¿é™æ–¹å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;k8s-cpu--memory-managementhttpskubernetesiodocsconceptsconfigurationmanage-resources-containers&#34;&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/manage-resources-containers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s cpu / memory management&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/manage-resources-containers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/concepts/configuration/manage-resources-containers&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;k8s å¦‚ä½•ç®¡ç† workload çš„ cpu èˆ‡ memory&lt;/li&gt;
&lt;li&gt;èª¿é™å¤šå°‘æœƒå½±éŸ¿æœå‹™å“è³ª&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;é€™è£¡é¢å†è¬›ä¸€ä¸‹ k8s å¦‚ä½•ç®¡ç† cpu / memory&lt;/p&gt;
&lt;p&gt;é€™é‚Šçš„é‡é»æ˜¯ï¼Œæ€éº¼æ¨£çš„èª¿æ•´æœƒå½±éŸ¿åˆ°æœå‹™å“è³ªï¼Œé‚£æˆ‘å€‘åšæˆæœ¬æ§åˆ¶çš„æ™‚å€™ï¼Œå°±ä¸è¦å»è¸©åˆ°é€™å€‹åº•ç·š&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;how-k8s-manage-cpu--memoryhttpskubernetesiodocsconceptsconfigurationmanage-resources-containershow-pods-with-resource-limits-are-run&#34;&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#how-pods-with-resource-limits-are-run&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;How k8s manage cpu / memory&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;scheduler ä¾æ“š cpu / memory request èª¿åº¦ pod&lt;/li&gt;
&lt;li&gt;container runtime è¨­å®š cgroup
&lt;ul&gt;
&lt;li&gt;cpu ä½¿ç”¨é‡ä¾æ“š request ä½” node æ¯”ä¾‹åˆ†é…&lt;/li&gt;
&lt;li&gt;æ§åˆ¶ cpu ç”¨é‡ä¸è¶…é limit&lt;/li&gt;
&lt;li&gt;memory ä½¿ç”¨ limitï¼Œè¶…é limit æœƒè¢« oomkillï¼Œä¸¦ä¾æ“šè¨­å®šé‡å•Ÿ&lt;/li&gt;
&lt;li&gt;ç•¶å‰ node memory ä¸è¶³æ™‚ï¼Œæœƒä¾æ“š pod request Evict pod&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æ–‡ä»¶è¬›å¾—å¾ˆæ¸…æ¥š
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä¸Šé¢éƒ½æ˜¯æ¦‚å¿µåº•ä¸‹é€²å¯¦ä½œ&#34;&gt;ä¸Šé¢éƒ½æ˜¯æ¦‚å¿µï¼Œåº•ä¸‹é€²å¯¦ä½œ&lt;/h3&gt;
&lt;hr&gt;
&lt;h3 id=&#34;monitoring-ç›£æ§æ˜¯æˆæœ¬æ§ç®¡çš„åŸºç¤&#34;&gt;Monitoring ç›£æ§æ˜¯æˆæœ¬æ§ç®¡çš„åŸºç¤&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç›£æ¸¬æ˜¯æˆæœ¬æ§ç®¡çš„åŸºç¤&lt;/li&gt;
&lt;li&gt;æ²’æœ‰ç›£æ¸¬å°±æ²’æœ‰ p99 cpu time / memory usageï¼Œä¹Ÿæ²’æœ‰ SLI/SLO&lt;/li&gt;
&lt;li&gt;æ²’æœ‰æª¢æ¸¬ä¸‹åšæˆæœ¬ç²¾ç°¡ï¼Œæœƒç¢°å£æœå‹™&lt;/li&gt;
&lt;li&gt;å¦‚æœæ²’æœ‰ç›£æ¸¬å…ˆè£œæª¢æ¸¬&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¦‚æœæ²’æœ‰ monitoringï¼Œä¸Šé¢çš„å…©å¤§å‰æéƒ½ä¸å­˜åœ¨
ç›®å‰çš„ cpu / memory usageï¼Œruntime utilization çš„è³‡æ–™
ç›®å‰SLOï¼Œèª¿é™ä¹‹å¾Œæ–°çš„SLO&lt;/p&gt;
&lt;p&gt;æ²’æœ‰æª¢æ¸¬ä¸‹ï¼Œé‚„æ˜¯å¯ä»¥åšæˆæœ¬ç²¾ç°¡
ç„¶è€Œè¦é¦¬å…’å¥½åˆè¦è€Œä¸åƒè‰ï¼Œä»Šå¤©å¦‚æœæŠŠ cpu / memory é™ä¸‹ä¾†ï¼Œæœ‰å¯èƒ½æœƒé¤“åˆ°æœå‹™
cpu throttling / memory oomkillï¼Œé€™äº›éƒ½æ˜¯å¯èƒ½ç™¼ç”Ÿçš„äº‹æƒ…
æœƒç¢°å£æœå‹™&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;grafana-dashboard.png&#34;
  &gt;

&lt;hr&gt;
&lt;h3 id=&#34;ç›£æ¸¬èª¿æ•´å‰è¨­å®šç›®æ¨™åŸºæº–ç·š&#34;&gt;ç›£æ¸¬ï¼šèª¿æ•´å‰è¨­å®šç›®æ¨™åŸºæº–ç·š&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¨­å®šç¯€çœç›®æ¨™ï¼šex. éå» 3 å€‹æœˆçš„ p99 è³‡æºç”¨é‡
&lt;ul&gt;
&lt;li&gt;99% çš„æ™‚é–“ï¼Œmemory ä½¿ç”¨é‡éƒ½åœ¨é€™æ¢ç·šä»¥ä¸‹&lt;/li&gt;
&lt;li&gt;99% çš„æ™‚é–“ï¼Œcpu throttling åœ¨é€™æ¢ç·šä»¥ä¸‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¤šé¤˜çš„ç®—åŠ› = (åˆ†é…çš„ resource - p99)&lt;/li&gt;
&lt;li&gt;é‚£å¦‚æœæˆ‘å€‘æŠŠ cpu / memory é™ä½åˆ° p99 / p99.9 æœå‹™å“è³ªæœƒå—åˆ°å½±éŸ¿å—ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;åšä¹‹å‰è¦èƒ½è©•ä¼°åšå®Œå¤§æ¦‚èƒ½çœå¤šå°‘
ä¾‹å¦‚è©•ä¼°å®Œå¾Œ&lt;/p&gt;
&lt;p&gt;å¦‚æœè©•ä¼°å®Œç™¼ç¾çœä¸äº†ä»€éº¼éŒ¢ï¼Œé‚£ç•¶ç„¶åœ˜éšŠå°±ä¸ä¸€å®šè¦åšé€™ä»¶äº‹&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;grafana-cpu-dashboard.png&#34;
  &gt;

&lt;hr&gt;
&lt;h3 id=&#34;ç›£æ¸¬-èª¿æ•´å¾Œ&#34;&gt;ç›£æ¸¬: èª¿æ•´å¾Œ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è³‡æºç”¨é‡æ˜¯å¦æœ‰è®ŠåŒ–&lt;/li&gt;
&lt;li&gt;ç¢ºå®šæ²’æœ‰æ”¹å£æ±è¥¿ï¼Œæœ‰å£è¦æœ‰åŠæ™‚çš„ alert&lt;/li&gt;
&lt;li&gt;æ•ˆèƒ½è¡¨ç¾ï¼šæœ‰å¯èƒ½æ²’å£ï¼Œä½†æ˜¯è®Šå¾ˆæ…¢&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¦‚æœä½ æ”¹å£äº†ï¼ŒåŠæ™‚çš„ alert æœƒæ•‘ä½ ä¸€å‘½&lt;/p&gt;
&lt;p&gt;performance ç›£æ¸¬å¾ˆé‡è¦&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ¨è–¦ç›£æ¸¬å·¥å…·&#34;&gt;æ¨è–¦ç›£æ¸¬å·¥å…·&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://prometheus.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;prometheus.io&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.kubecost.com/using-kubecost&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubecost / Opencost&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;prometheus.png&#34;
  &gt;

&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¤§å®¶éƒ½çŸ¥é“ prometheus æ˜¯ä»€éº¼å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;çŸ¥é“çš„äººè«‹èˆ‰å€‹æ‰‹
ä¸çŸ¥é“çš„æˆ‘å¾ˆç°¡å–®èªªä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;æˆ‘å€‘æƒ³è¦çŸ¥é“ä¸€å€‹ pod æœƒéœ€è¦èŠ±å¤šå°‘ cpu / memoryï¼Œä½ å°±æŠŠå®ƒè·‘èµ·ä¾†ï¼Œç„¶å¾Œå»ç´€éŒ„è·‘èµ·ä¾†çš„ pod ç”¨äº†å¤šå°‘ cpu / memoryï¼Œç„¶å¾Œæ ¹æ“šæ™‚é–“çµ±è¨ˆï¼Œä½ å°±å¯ä»¥æ‹‰å‡ºä¸€å¼µåœ–ï¼Œçœ‹åˆ°é€™å€‹ pod ç”¨äº†å¤šå°‘ cpu / memory
ä½ çš„ kubelet / cadvisor / container runtime æœƒçŸ¥é“ä½ çš„ container çš„ cpu / memory ä½¿ç”¨é‡ï¼ŒåŒ…å« request &amp;amp; limit ç„¶å¾Œæ˜¯å¦æœ‰ throttling æˆ–æ˜¯ oomkillï¼Œé€™äº›è³‡è¨Šéƒ½æœƒè¢« prometheus æ”¶é›†èµ·ä¾†ï¼Œç„¶å¾Œä½ å¯ä»¥é€éå…¶ä»–å·¥å…·ï¼Œä¾‹å¦‚ kubecost çœ‹åˆ°é€™äº›è³‡è¨Š&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;grafana-cpu-usage.png&#34;
  &gt;

&lt;p&gt;&lt;a href=&#34;https://grafana.com/grafana/dashboards/17375-k8s-resource-monitoring/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://grafana.com/grafana/dashboards/17375-k8s-resource-monitoring/&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  é€™æ˜¯ prometheus æ”¶é›†çš„è³‡æ–™ï¼Œvm çš„ resource ä½¿ç”¨é‡çš„ grafana dashboard
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°å…¥æˆæœ¬åˆ†æèˆ‡é æ¸¬å·¥å…·&#34;&gt;å°å…¥æˆæœ¬åˆ†æèˆ‡é æ¸¬å·¥å…·&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰äº† prometheus å¾Œï¼Œæˆ‘å€‘çŸ¥é“çŸ­æœŸ/é•·æœŸçš„è³‡æºä½¿ç”¨ç‹€æ³&lt;/li&gt;
&lt;li&gt;è¦æŠŠè³‡æºä½¿ç”¨è½‰æˆæˆæœ¬ï¼Œéœ€è¦ä¸€å€‹æˆæœ¬è¨ˆç®—å·¥å…·&lt;/li&gt;
&lt;li&gt;è©•ä¼°æ˜¯å¦è¦åšæˆæœ¬ç²¾ç°¡ï¼Œèƒ½å¤ æ¸›å°‘å¤šå°‘éŒ¢&lt;/li&gt;
&lt;li&gt;ç®¡ç†ä¸Šçš„è€ƒé‡ï¼šæŠ•è³‡äººåŠ›æˆæœ¬ï¼Œèˆ‡é æœŸå›å ±&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;æ”¿æ²»ä¸Šçš„è€ƒé‡ï¼Œåšæˆæœ¬ç¯€çœéœ€è¦æ™‚é–“è·ŸäººåŠ›è³‡æº
æœ‰ä¸€å€‹ç²¾æº–çš„æˆæœ¬åˆ†æï¼Œç¯€çœç©ºé–“ä¼°ç®—çš„å·¥å…·ååˆ†æœ‰èªªæœåŠ›&lt;/p&gt;
&lt;p&gt;æœ‰é€™äº›è³‡æ–™ï¼Œæ‰å¯ä»¥ç§‘å­¸åŒ–æ±ºç­–è¦ä¸è¦åšï¼Œè©²æ€éº¼åš
åšä¹‹å‰å°±èƒ½è©•ä¼°åšå®Œå¤§æ¦‚èƒ½çœå¤šå°‘&lt;/p&gt;
&lt;p&gt;å¦‚æœè©•ä¼°å®Œç™¼ç¾çœä¸äº†ä»€éº¼éŒ¢ï¼Œé‚£ç•¶ç„¶åœ˜éšŠå°±ä¸ä¸€å®šè¦åšé€™ä»¶äº‹&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æˆæœ¬åˆ†æ&#34;&gt;æˆæœ¬åˆ†æ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;VM å¯ä»¥ç”¨å„å®¶å…¬æœ‰é›²çš„è²»ç”¨è¨ˆç®—å·¥å…·&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://azure.microsoft.com/en-us/products/cost-management&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Azure Cost Management&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/aws-cost-management/aws-cost-explorer/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS Cost Explorer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cloud.google.com/billing/docs/how-to/cost-breakdown&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GCP Cost Breakdown&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;azure-cost-management.jpeg&#34;
  &gt;

&lt;hr&gt;
&lt;h3 id=&#34;æˆæœ¬åˆ†æå…¬æœ‰é›²-billing&#34;&gt;æˆæœ¬åˆ†æï¼šå…¬æœ‰é›² billing&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¨ˆç®—é•·æ™‚é–“çš„è²»ç”¨è¶¨å‹¢&lt;/li&gt;
&lt;li&gt;é©åˆç•¶ä½œæˆæœ¬ç²¾ç°¡å¾Œçš„æˆæœå›å ±&lt;/li&gt;
&lt;li&gt;ä¸é©åˆç•¶åšèª¿æ•´çš„ä¾æ“š&lt;/li&gt;
&lt;li&gt;æ™‚é–“è¨ˆç®—è¼ƒé•·ï¼Œåé¥‹æ™‚é–“é•·ï¼Œä¸åŠæ™‚ï¼Œé …ç›®ä¸å¤ ç²¾ç´°&lt;/li&gt;
&lt;li&gt;æœ‰ç„¡æ›´å³æ™‚çš„æˆæœ¬åˆ†æå·¥å…·ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æˆæœ¬åˆ†æ-kubecost--opencosthttpsdocskubecostcomusing-kubecost&#34;&gt;æˆæœ¬åˆ†æ: &lt;a href=&#34;https://docs.kubecost.com/using-kubecost/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubecost / Opencost&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰æä¾› UI&lt;/li&gt;
&lt;li&gt;åŸºæ–¼ prometheus&lt;/li&gt;
&lt;li&gt;å¯ä»¥é‡å° allocation åšæˆæœ¬åˆ†æ &lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cost Allocation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¯ä»¥é€é cloud provider å»æ’ˆé›²ç«¯çš„ä½¿ç”¨è³‡æ–™&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;kubecost.jpeg&#34;
  &gt;

&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;kubecost-allocation.jpeg&#34;
  &gt;

&lt;p&gt;&lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;kubecost-efficiency.png&#34;
  &gt;

&lt;p&gt;&lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation/efficiency-idle&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation/efficiency-idle&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ¨è–¦å·¥å…·&#34;&gt;æ¨è–¦å·¥å…·&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/robusta-dev/krr&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/robusta-dev/krr&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/savings&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubecost / Opencost Savings&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/pkg/recommender/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VPA recommendator&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ¨è–¦å·¥å…·-kubecost--opencost-savingshttpsdocskubecostcomusing-kubecostnavigating-the-kubecost-uisavings&#34;&gt;æ¨è–¦å·¥å…·: &lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/savings&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubecost / Opencost Savings&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¨­å®š target utilization
&lt;ul&gt;
&lt;li&gt;request / allocatable&lt;/li&gt;
&lt;li&gt;dev 80%+&lt;/li&gt;
&lt;li&gt;prod 60%&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æ ¹æ“šæœå‹™å“è³ªçš„è¦æ±‚ï¼Œä»¥åŠå…¬å¸æ”¿ç­–å»åšè¨­å®š
SLA/SLO
é–‹ç™¼èˆ‡æ¸¬è©¦ç’°å¢ƒï¼Œåœ¨ä¸å½±éŸ¿å·¥ä½œçš„å‰æï¼Œéƒ½å¯ä»¥æ‹‰åˆ° overcommit
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ¨è–¦å·¥å…·-krr&#34;&gt;æ¨è–¦å·¥å…·: KRR&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/robusta-dev/krr&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/robusta-dev/krr&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å…å®‰è£ï¼Œä¸å½±éŸ¿ k8s æœ¬èº«&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¤–éƒ¨å·¥å…·è®€å– prometheus è³‡æ–™&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ¨è–¦å·¥å…·-krr-1&#34;&gt;æ¨è–¦å·¥å…·: KRR&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl port-forward svc/prometheus 9090
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone https://github.com/robusta-dev/krr.git
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;source .venv/bin/activate
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python krr.py simple \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -p http://127.0.0.1:9090 \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --mem-min 10 \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --cpu-min 10 \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --history_duration 720 -q
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;krr.jpeg&#34;
  &gt;

&lt;hr&gt;
&lt;h3 id=&#34;æ¨è–¦å·¥å…·-krr-2&#34;&gt;æ¨è–¦å·¥å…·: KRR&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ ¹æ“š krr è¨ˆç®—çš„çµæœï¼Œæ‰‹å‹•èª¿æ•´&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€äº›å·¥å…·æœ‰æä¾›è‡ªå‹•èª¿æ•´ ex VPA&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;è‡ªå‹•å·¥å…·æ¯”æ‰‹å‹•éœ€è¦è€ƒé‡æ›´å¤šå› ç´ ï¼Œé€™å€‹æˆ‘å€‘ç¨å€™ VPA å†æ&lt;/p&gt;
&lt;p&gt;è«‹è©³é–±å·¥å…·èªªæ˜å†æœç”¨&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ¨è–¦å·¥å…·-vpa-recommendatorhttpsgithubcomkubernetesautoscalerblobmastervertical-pod-autoscalerpkgrecommenderreadmemd&#34;&gt;æ¨è–¦å·¥å…·: &lt;a href=&#34;https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/pkg/recommender/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VPA recommendator&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦å…ˆçŸ¥é“ VPA æ˜¯ä»€éº¼&lt;/li&gt;
&lt;li&gt;ç›´æ¥å®‰è£åœ¨ k8s cluster å…§&lt;/li&gt;
&lt;li&gt;é€é Prometheus è³‡æ–™ï¼Œæ¨è–¦é©ç•¶çš„è³‡æº&lt;/li&gt;
&lt;li&gt;å¯ä»¥è‡ªå‹•åŒ–æ¨è–¦è³‡æºï¼Œèª¿æ•´é‹è¡Œä¸­çš„ podï¼Œä¾ç…§è¨­å®šé‡å•Ÿ pod &lt;a href=&#34;https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/README.md#quick-start&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VPA mode&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;éœ€è¦å¯ä»¥åƒè€ƒ &lt;a href=&#34;https://github.com/cowboysysop/charts/tree/master/charts/vertical-pod-autoscaler&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;helm chart&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  krr æ˜¯å¯ä»¥ç„¡è…¦ç”¨çš„å·¥å…·ï¼Œä½†æ˜¯ VPA å°±ä¸æ˜¯äº†
è«‹è¨­å®š VPA mode Off
è«‹å‹™å¿…éœ€è¦ç ”ç©¶ä¸€ä¸‹åœ¨ä½¿ç”¨
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ¨è–¦å·¥å…·-æ¯”è¼ƒ&#34;&gt;æ¨è–¦å·¥å…·: æ¯”è¼ƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;kubecost éœ€è¦ helm installï¼Œkrr ä¸éœ€è¦&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;kubecost ç”¢ç”Ÿä¸€å€‹æ¼‚äº®çš„ UIï¼Œkrr ç”¢ç”Ÿ command line å ±è¡¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;VPA éœ€è¦ helm installï¼Œä¸¦ä¸”æœƒéœ€è¦ cluster æ¬Šé™&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;VPA å¯ä»¥åšåˆ°è‡ªå‹•åŒ–èª¿æ•´ï¼Œé‚è¼¯æ›´è¤‡é›œï¼Œæœ‰ä¾µå…¥æ€§ï¼Œè¨­å®šæœ‰å•é¡Œæœƒå‡ºäº‹&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å‰›ä¸Šæ‰‹çš„åšæ³•&#34;&gt;å‰›ä¸Šæ‰‹çš„åšæ³•&lt;/h3&gt;
&lt;p&gt;æ²’æ™‚é–“ç´°éƒ¨ç ”ç©¶ç ”ç©¶å…ƒä»¶çš„è¡Œç‚ºï¼Œç›´æ¥èª¿æ•´ request èˆ‡ limit&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆèª¿é™ requestï¼Œä¸å‹• limitï¼Œå°æœå‹™è¡æ“Šè¼ƒå°&lt;/li&gt;
&lt;li&gt;ç”¨æŠ“æ¯”ä¾‹çš„æ–¹å¼å‹•æ…‹èª¿æ•´ï¼Œä¾‹å¦‚ç›®å‰ request è·é›¢ p99 request å·®è· 1000Miï¼Œä½ å…ˆæ”¶ 500Mi å›ä¾†è©¦å€‹æ°´æº«&lt;/li&gt;
&lt;li&gt;p99 ç›´æ¥ä½¿ç”¨ tool è¨ˆç®—ï¼Œç´°ç¯€åœ¨å¾Œé¢&lt;/li&gt;
&lt;li&gt;æ¸¬è©¦ç’°å¢ƒå…ˆè¡Œï¼Œæœ‰ä¿¡å¿ƒåœ¨ä¸Š production&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¦‚æœä½ ç¬¬ä¸€æ¬¡åšï¼Œä½†å°æœå‹™å…ƒä»¶æ²’æœ‰ç†Ÿåˆ°é€™ç¨®ç¨‹åº¦ï¼Œé€™æ˜¯æ¯”è¼ƒå®‰å…¨çš„åšæ³•
å…¬å¸è¦æ¨¡å¤§æœå‹™å…ƒä»¶è¤‡é›œï¼Œèº«ç‚º SRE ä½ åªèƒ½ä»°è³´ metrics ä¾†åˆ¤æ–·æœå‹™å“è³ªæ˜¯å¦å—å½±éŸ¿ï¼Œä½†å¾ˆå¤šè¤‡é›œçš„æœå‹™ï¼Œä»¥åŠä¸ç†Ÿæ‚‰çš„æœå‹™ï¼Œæœƒå¾ˆé›£è©•ä¼°&lt;/p&gt;
&lt;p&gt;å…ˆèª¿é™ requestï¼Œæå‡å–®ä¸€ node ä¸Šçš„ pod æ•¸é‡ï¼Œç„¶å¾Œè§€å¯Ÿæœå‹™å“è³ªï¼Œå¦‚æœæœå‹™å“è³ªæ²’æœ‰å—åˆ°å½±éŸ¿ï¼Œé‚£éº¼ä½ å¯ä»¥é€²ä¸€æ­¥èª¿é™ limit
å¸‚å ´å–Šåƒ¹ï¼Œå…ˆå–Šå€‹ä¸€åŠï¼Œåœ¨çœ‹èƒ½ç¹¼çºŒå£“åˆ°ä»€éº¼ç¨‹åº¦&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°çµ&#34;&gt;å°çµ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ”¶é›†ç›®å‰è³‡æºä½¿ç”¨è³‡æ–™&lt;/li&gt;
&lt;li&gt;è½‰åŒ–æˆå…¬æœ‰é›²çš„æˆæœ¬&lt;/li&gt;
&lt;li&gt;é€é tool å»ºè­°é©ç•¶çš„è³‡æº&lt;/li&gt;
&lt;li&gt;æ ¹æ“šæœå‹™å“è³ªçš„è¦æ±‚ï¼Œèª¿é™ cpu / memory&lt;/li&gt;
&lt;li&gt;å›é ­æª¢æŸ¥ SLO æ˜¯å¦æœ‰å—åˆ°å½±éŸ¿&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;è‡ªå‹•æ‹“å±•hpa&#34;&gt;è‡ªå‹•æ‹“å±•ï¼šHPA&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s/horizontal-pod-autoscale&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ HPA åœ¨æˆæœ¬ç²¾ç°¡çš„æ„ç¾©ï¼šå› ç‚ºå¤–éƒ¨å› ç´ æ”¹è®Šè² è¼‰çš„å…ƒä»¶&lt;/li&gt;
&lt;li&gt;ä½è² è¼‰æ™‚ä¸è¦é–‹å¤ªå¤šï¼Œé«˜è² è¼‰æ™‚è‡ªå‹•åŠ é–‹ pod&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;è‡ªå‹•æ‹“å±•hpa-çš„è€ƒé‡&#34;&gt;è‡ªå‹•æ‹“å±•ï¼šHPA çš„è€ƒé‡&lt;/h3&gt;
&lt;p&gt;å…ƒä»¶æ˜¯å¦èƒ½å¤ æ°´å¹³æ‹“å±•&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å•Ÿå‹•çš„ liveness check / readiness check&lt;/li&gt;
&lt;li&gt;laod balancer&lt;/li&gt;
&lt;li&gt;éœ€è¦æŒçºŒèª¿æ•´ scale up / down çš„æ¢ä»¶èˆ‡ time windows&lt;/li&gt;
&lt;li&gt;scale up å°ä¾è³´æœå‹™çš„ loading æœƒæœ‰å½±éŸ¿ ex. å¾Œé¢çš„ db&lt;/li&gt;
&lt;li&gt;é€€å ´æ©Ÿåˆ¶ï¼Œè¦å¦‚ä½•å®‰å…¨çš„ä¸­æ–·é€£ç·šï¼Œç´€éŒ„ state&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;è¦èƒ½å®‰å…¨åœ°é€²å‡ºå ´&lt;/p&gt;
&lt;p&gt;é€²å ´ï¼Œpod readiness / liveness
loading å¢åŠ æ™‚ scale up time windows
scale out å°å¾Œæ–¹æœå‹™çš„å½±éŸ¿ï¼Œæ˜¯å¦æœƒå‡ºç¾æ–°çš„ç“¶é ¸&lt;/p&gt;
&lt;p&gt;loading é™ä½æ™‚ scale down æ˜¯å¦æœƒå½±éŸ¿æœå‹™&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;è‡ªå‹•æ‹“å±•vpa&#34;&gt;è‡ªå‹•æ‹“å±•ï¼šVPA&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/README.md#quick-start&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s/autoscaler/vertical-pod-autoscaler&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä¸èƒ½æ°´å¹³æ‹“å±•ï¼Œåªå¥½å…ˆå‚ç›´æ‹“å±•&lt;/li&gt;
&lt;li&gt;èª¿æ•´è³‡æºï¼Œæœ‰å¯èƒ½æœƒé‡å•Ÿ pod / container&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/blog/2023/05/12/in-place-pod-resize-alpha/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes 1.27: In-place Resource Resize for Kubernetes Pods (alpha)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes/kubernetes/issues/122760&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;In-Place Pod Resource Resizing always restarts pod&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœä½ çš„ workload ç„¶å¾Œä¸é©åˆåš HPAï¼Œä½†å¯ä»¥æ¥å— resize å¾Œé‡å•Ÿï¼Œé‚£å¯ä»¥è©¦è©¦VPA&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  1.27 ä½ å¯ä»¥æŠŠ InPlacePodVerticalScaling feature gate é–‹èµ·ä¾†
ä»–ä¸ä¿è­‰ resize å¾Œä¸æœƒé‡å•Ÿ podï¼Œé‚„æ˜¯è¦çœ‹ä½ çš„ container runtime æ”¯æ´ç¨‹åº¦
è«‹å…ˆåœ¨æ¸¬è©¦ç’°å¢ƒä¸­ç©ä¸€ç©
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;saving-plan--ri&#34;&gt;Saving Plan / RI&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;AWS Saving Plan / RI&lt;/li&gt;
&lt;li&gt;GCP Committed Use Discount&lt;/li&gt;
&lt;li&gt;Azure Saving Plan / Reservation&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;Saving Plan / RI æ˜¯ä¸€ç¨®é•·æœŸçš„åˆç´„ï¼Œä½ å¯ä»¥è·Ÿé›²ç«¯æœå‹™å•†ç°½ç´„ï¼Œä¿è­‰ä½ æœƒç”¨å¤šå°‘è³‡æºï¼Œç„¶å¾Œé›²ç«¯æœå‹™å•†æœƒçµ¦ä½ ä¸€å€‹æŠ˜æ‰£
ä¸ƒæŠ˜ä¸Šä¸‹ï¼Œå¾ˆé©åˆé•·æœŸä½¿ç”¨çš„å®¢æˆ¶&lt;/p&gt;
&lt;p&gt;æœ‰ monitoring + predictionï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¢ºå®šä½ æœƒç”¨å¤šå°‘è³‡æºï¼Œé€™æ™‚å€™å°±å¯ä»¥è€ƒæ…® saving plan / RI&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;spot-instance&#34;&gt;Spot Instance&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://azure.microsoft.com/en-us/products/virtual-machines/spot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;azure spot vm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/ec2/spot/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;aws spot intance&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cloud.google.com/spot-vms&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gcp spot vm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¸³é¢ä¸Šæœ€é«˜å¯çœ 90%&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;spot-instance-1&#34;&gt;Spot Instance&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¶…ä¾¿å®œï¼Œæ‰“ä¸€æŠ˜&lt;/li&gt;
&lt;li&gt;å¤šé¤˜çš„ç®—åŠ›&lt;/li&gt;
&lt;li&gt;interruptionï¼Œä¸ä¿è­‰ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/ec2/spot/instance-advisor/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://aws.amazon.com/ec2/spot/instance-advisor/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  å› ç‚ºä¸€æŠ˜çœŸçš„å¾ˆé¦™ï¼Œä¸€æŠ˜æ˜¯æœ‰é»æ‹¼ï¼Œä½†æ‰“å€‹ 3 æŠ˜é‚„æ˜¯å¾ˆæœ‰æ©Ÿæœƒ
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;spot-instance-å¦‚ä½•é–‹å§‹&#34;&gt;Spot Instance: å¦‚ä½•é–‹å§‹&lt;/h3&gt;
&lt;p&gt;é‡å•Ÿä¸å½±éŸ¿æœå‹™å“è³ªçš„&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;stateless&lt;/li&gt;
&lt;li&gt;batch job&lt;/li&gt;
&lt;li&gt;å°‡ worklaod å¾ monolithic æ‹†åˆ†æˆå°çš„ batch job&lt;/li&gt;
&lt;li&gt;æ¸¬è©¦ç’°å¢ƒ dev / stag&lt;/li&gt;
&lt;li&gt;CI/CD&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;ä¹çœ‹ä¹‹ä¸‹å¹¾å€‹å°æ™‚~24hr å…§æœƒè¢«é‡å•Ÿï¼Œå¥½åƒæ˜¯çŠ§ç‰²äº†æœå‹™å“è³ªï¼Œä½†å¦‚æœä½ çš„æœå‹™æ˜¯å¯ä»¥å®¹å¿ interruption çš„ï¼Œä¾‹å¦‚ batch jobï¼Œé‚£éº¼ spot instance å°±æ˜¯ä¸€å€‹å¾ˆå¥½çš„é¸æ“‡&lt;/p&gt;
&lt;p&gt;å°‡ worklaod å¾ monolithic æ‹†åˆ†æˆå°çš„ batch jobï¼Œä¾‹å¦‚ä½ æ˜¯ api server è™•ç†ä¸€å€‹ request æœƒæœ‰å¾ˆå¤šæ­¥é©Ÿï¼Œä½ å¯ä»¥æŠŠé€™äº›æ­¥é©Ÿæ‹†åˆ†æˆå°çš„ batch jobï¼Œç„¶å¾Œç”¨ queue ä¸²æ¥ï¼Œé€™æ¨£ä½ çš„ api server å°±å¯ä»¥ç”¨ spot instance ä¾†è·‘ï¼Œç„¶å¾Œä½ çš„ batch job ç”¨ spot instance è·‘ï¼Œé€™æ¨£ä½ çš„æœå‹™å°±å¯ä»¥çœå¾ˆå¤šéŒ¢&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°çµ-1&#34;&gt;å°çµ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;krr å·¥å…·èª¿æ•´è³‡æº&lt;/li&gt;
&lt;li&gt;HPA åšæ°´å¹³æ“´å±•&lt;/li&gt;
&lt;li&gt;VPA è‡ªå‹•åŒ–èª¿æ•´è³‡æº&lt;/li&gt;
&lt;li&gt;saving plan / RI é•·æœŸåˆç´„æ‰“ä¸ƒæŠ˜&lt;/li&gt;
&lt;li&gt;spot instance æ‰“ä¸€æŠ˜&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å±•æœ›&#34;&gt;å±•æœ›&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é‹è¡Œæˆæœ¬è½‰é”çµ¦é–‹ç™¼åœ˜éšŠ cost awareness development&lt;/li&gt;
&lt;li&gt;æ ¹æ“šå„åœ˜éšŠåˆ¶å®šç²¾ç°¡è¨ˆç•« find-grade optimization&lt;/li&gt;
&lt;li&gt;æˆæœ¬ç®¡ç†è‡ªå‹•åŒ– automation&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æœ‰äº†è³‡æºé æ¸¬ç³»çµ±ï¼Œå¯ä»¥åœ¨é–‹ç™¼éšæ®µå°±å°‡è³‡æºä½¿ç”¨å›é¥‹çµ¦é–‹ç™¼åœ˜éšŠ
æ ¹æ“šä¸åŒæœå‹™å…ƒä»¶çš„å“è³ªè¦æ±‚ï¼Œåšæ›´ç´°ç·»çš„è³‡æºç®¡æ§
è‡ªå‹•åŒ–èª¿æ•´ï¼Œè®“äººåŠ›å¯ä»¥å°ˆæ³¨åœ¨æ›´é‡è¦çš„äº‹æƒ…ä¸Š
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°çµ-2&#34;&gt;å°çµ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;cpu / memory&lt;/li&gt;
&lt;li&gt;ç›£æ¸¬æ˜¯åŸºç¤&lt;/li&gt;
&lt;li&gt;ä¾æ“šç›£æ¸¬åšé æ¸¬&lt;/li&gt;
&lt;li&gt;é–‹å§‹èª¿æ•´&lt;/li&gt;
&lt;li&gt;é•·æœŸåˆç´„æ‰“ä¸ƒæŠ˜&lt;/li&gt;
&lt;li&gt;spot instance æ‰“ä¸€æŠ˜&lt;/li&gt;
&lt;li&gt;HPA / VPA&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ„Ÿè¬&#34;&gt;æ„Ÿè¬&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;presentation and speaker notes &lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;chechia.net&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.linkedin.com/company/maicoin/jobs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Maicoin è·ç¼º&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¬å¸ç¦åˆ©ä¸éŒ¯ï¼Œæ¥­å‹™æˆé•·ä¸­ï¼Œæƒ³ä¸€èµ·å…±äº‹ï¼Œæ­¡è¿æ‰¾æˆ‘èŠ&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
</description>
    </item>
    
    <item>
      <title>SRE Conference: Cloud Infrastructure Saving Engineering  é›²ç«¯çœéŒ¢å·¥ç¨‹</title>
      <link>https://chechia.net/zh-hant/slides/2024-04-26-saving-money-on-cloud-k8s/</link>
      <pubDate>Tue, 26 Mar 2024 00:00:00 +0000</pubDate>
      <guid>https://chechia.net/zh-hant/slides/2024-04-26-saving-money-on-cloud-k8s/</guid>
      <description>
&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;onepiece.jpg&#34;
  &gt;

&lt;aside class=&#34;notes&#34;&gt;
  æŠ•å½±ç‰‡è·Ÿè¬›ç¨¿æˆ‘éƒ½æ”¾åœ¨æˆ‘çš„ç¶²ç«™ä¸Šï¼Œå¦‚æœæœ‰èˆˆè¶£å¯ä»¥åƒè€ƒ
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;cost-management-of-cloud-kubernetes&#34;&gt;Cost Management of Cloud Kubernetes&lt;/h3&gt;
&lt;h3 id=&#34;é›²ç«¯k8sçœéŒ¢å·¥ç¨‹&#34;&gt;é›²ç«¯K8sçœéŒ¢å·¥ç¨‹&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Che Chia Chang&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  å…©å€‹é—œéµå­—ï¼šé›²ç«¯ / k8s
å¦‚æœä½ æœ‰åœ¨ä½¿ç”¨å…¬æœ‰é›²ï¼Œè€Œä¸”æœ‰åœ¨è·‘ k8sï¼Œä½ æ˜¯é€™ç¯‡æ¼”è¬›çš„æœ€ä¸»è¦å°è±¡
å¦‚æœä½ æ˜¯ç§æœ‰é›² k8sï¼Œæˆ–æ˜¯å…¶ä»–çš„é›²ç«¯æœå‹™ï¼Œæœ‰ä¸€äº›ç›¸é€šçš„æ¦‚å¿µï¼Œæœƒæœ‰ä¸€äº›åƒè€ƒåƒ¹å€¼
å¦‚æœä½ æ˜¯åœ°ç«¯çš„æ©Ÿå™¨ï¼Œé›–ç„¶æ¦‚å¿µç›¸åŒï¼Œä½†æˆæœ¬æ§åˆ¶çš„åšæ³•å®Œå…¨æ˜¯å¦å¤–ä¸€å€‹æ•…äº‹ï¼Œä½ å¯ä»¥ç•¶åˆä¼‘æ™‚é–“çš„æ•…äº‹è½è½çœ‹
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;about-me&#34;&gt;About Me&lt;/h3&gt;
&lt;h3 id=&#34;che-chia-chang&#34;&gt;Che Chia Chang&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;SRE @ &lt;a href=&#34;https://www.linkedin.com/company/maicoin/jobs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Maicoin&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://mvp.microsoft.com/zh-TW/MVP/profile/e407d0b9-5c01-eb11-a815-000d3a8ccaf5&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Microsoft MVP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å€‹äººéƒ¨è½æ ¼&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;chechia.net&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;presentation and speaker notes&lt;/li&gt;
&lt;li&gt;éµäººè³½ (Terraform / Vault æ‰‹æŠŠæ‰‹å…¥é–€)&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;outline&#34;&gt;Outline&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Cost on Public Cloud&lt;/li&gt;
&lt;li&gt;K8s Compute Resource Management&lt;/li&gt;
&lt;li&gt;Monitoring&lt;/li&gt;
&lt;li&gt;Cost Analysis and Prediction&lt;/li&gt;
&lt;li&gt;Resource Recommendation&lt;/li&gt;
&lt;li&gt;Saving Plan&lt;/li&gt;
&lt;li&gt;Spot Instance&lt;/li&gt;
&lt;li&gt;HPA / VPA&lt;/li&gt;
&lt;li&gt;Q&amp;amp;A&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;é€™æ˜¯æˆ‘å€‘ä»Šå¤©çš„å¤§ç¶±&lt;/p&gt;
&lt;p&gt;æˆ‘å€‘æœƒå…ˆè¬›ä¸€ä¸‹åœ¨å…¬æœ‰é›²ä¸Šçš„æˆæœ¬
ç„¶å¾Œè¬›ä¸€ä¸‹ k8s çš„é‹ç®—è³‡æºç®¡ç†
æ¥è‘—è¬›ä¸€ä¸‹ç›£æ§ï¼Œç‚ºä½•æˆæœ¬æ§ç®¡çš„åŸºç¤æ˜¯ç›£æ§
å¦‚ä½•ä½¿ç”¨å·¥å…·æˆæœ¬åˆ†æï¼Œæœªä¾†æˆæœ¬é æ¸¬
ç„¶å¾Œä½¿ç”¨å·¥å…·å»ºè­°åˆé©çš„è³‡æº
æœ€å¾Œè¬›å¯¦å‹™ä¸Šè¦å¦‚ä½•é™ä½æˆæœ¬ï¼Œä¾‹å¦‚ saving plan / spot instance / HPA / VPAï¼Œä¾ç…§åŸ·è¡Œçš„é›£åº¦æ’åºï¼Œæœ‰æ™‚é–“çš„è©±ä¹Ÿæœƒè¬›å¦‚ä½•å¾ç„¡åˆ°æœ‰é–‹å§‹é€²è¡Œ&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;cost-on-public-cloud&#34;&gt;Cost on Public Cloud&lt;/h3&gt;
&lt;p&gt;open your cloud billing&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Compute Resource (cpu, memory)&lt;/li&gt;
&lt;li&gt;Storage (Disk, EBS, S3&amp;hellip;)&lt;/li&gt;
&lt;li&gt;Database (Compute Resource + Storage)&lt;/li&gt;
&lt;li&gt;Networking&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æœ‰åœ¨ä½¿ç”¨å…¬æœ‰é›²çš„äººï¼ŒæŠŠå…¬æœ‰é›²çš„ billing å¸³å–®æ‰“é–‹ä¾†çœ‹ï¼Œå¯èƒ½çœ‹åˆ°çš„å¤§æ¦‚æ˜¯é€™å¹¾å€‹é …ç›®
ç•¶ç„¶å› ç‚ºä¸åŒåœ˜éšŠçš„æœå‹™ä¸åŒï¼Œå¯èƒ½æœƒæœ‰ä¸€äº›å‡ºå…¥ï¼Œä½†å¦‚æœä½ çš„å…¬å¸çš„ç”¢å“æ˜¯ web serviceï¼Œæ‡‰è©²æœƒæœ‰é€™å¹¾å€‹é …ç›®
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;todays-topic&#34;&gt;Today&amp;rsquo;s topic&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Today&amp;rsquo;s topic&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Compute Resource&lt;/li&gt;
&lt;li&gt;cpu &amp;amp; memory&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Maybe next time&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Storage (Disk, EBS, S3&amp;hellip;)&lt;/li&gt;
&lt;li&gt;Database (Compute Resource + Storage)&lt;/li&gt;
&lt;li&gt;Networking&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;Storage ä¸å¤ªå¥½èªªçœå°±çœï¼Œå› ç‚ºä½ çš„è³‡æ–™é‡å°±åœ¨é‚£é‚Šï¼Œæ”¾ä¸ä¸‹å°±æ˜¯è¦å†è²·ï¼Œæ‰€ä»¥ storage çš„æˆæœ¬æ§åˆ¶ï¼Œå¯èƒ½æ˜¯åœ¨è³‡æ–™çš„ä½¿ç”¨ä¸Šï¼Œä¾‹å¦‚è³‡æ–™çš„å£“ç¸®ï¼Œæˆ–æ˜¯è³‡æ–™çš„å‚™ä»½ï¼Œæˆ–æ˜¯è³‡æ–™çš„å­˜å–æ–¹å¼ï¼Œé€™äº›æ˜¯å¦å¤–ä¸€å€‹æ•…äº‹
ä½¿ç”¨å…¬æœ‰é›²çš„æœå‹™ï¼ŒåŸºæœ¬ä¸Š storage éƒ½æ˜¯ä¾æ“šä½¿ç”¨çš„å¤§å°è¨ˆåƒ¹ï¼Œè€Œä¸”éœ€å¤šæœå‹™éƒ½å¯ä»¥å‹•æ…‹å¢é•·ï¼Œä¾‹å¦‚å‹•æ…‹å¢åŠ  disk&lt;/p&gt;
&lt;p&gt;Storage / Database / Networking é€™å¹¾å€‹é …ç›®ï¼Œæˆ‘å€‘ä¸‹é›†å†ä¾†è«‡&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;cost-on-public-cloud-1&#34;&gt;Cost on Public Cloud&lt;/h3&gt;
&lt;p&gt;CPU / memory intense web service&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RESTful api&lt;/li&gt;
&lt;li&gt;long-connetion service&lt;/li&gt;
&lt;li&gt;business logic&lt;/li&gt;
&lt;li&gt;save state to disk / database&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¦‚æœä½ è·Ÿæ•ç¤¾ä¸€æ¨£æ˜¯ web serviceï¼Œé‚£éº¼ cpu / memory å¯èƒ½æ˜¯ä½ æœ€å¤§çš„ä¸€ç­†æˆæœ¬&lt;/p&gt;
&lt;p&gt;ä½ éœ€è¦è¶³å¤ é‹ç®—èƒ½åŠ› serve å®¢æˆ¶ï¼Œä¸ç®¡æ˜¯æ”¯æŒç”¨æˆ¶çš„requestï¼Œé€²è¡Œå•†æ¥­é‚è¼¯çš„é‹ç®—ï¼Œç„¶å¾ŒæŠŠé‹ç®—å®Œæˆçš„ç‹€æ…‹å›å‚³çµ¦å®¢æˆ¶ï¼Œæˆ–æ˜¯å­˜åœ¨è³‡æ–™åº«ä¸­ï¼Œæ¯ä¸€å€‹å‹•ä½œéƒ½éœ€è¦ç®—åŠ›&lt;/p&gt;
&lt;p&gt;è¶³å¤ çš„ cpu è·Ÿ memoryï¼Œä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œè€Œæ˜¯è¶³å¤ ï¼Œä¸æœƒæµªè²»ï¼Œä¹Ÿä¸æœƒå› ç‚ºä¸è¶³è€Œå½±éŸ¿æœå‹™å“è³ª
æˆ‘å€‘è¦çœéŒ¢ï¼Œå°±è¦å¾é€™è£¡ä¸‹æ‰‹&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°‹æ‰¾å¤šé¤˜çš„ç®—åŠ›&#34;&gt;å°‹æ‰¾å¤šé¤˜çš„ç®—åŠ›&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å·²æœ‰è¶³å¤ çš„ cpu / memoryï¼Œå¤šçµ¦ä¹Ÿä¸æœƒå¢åŠ æœå‹™å“è³ªçš„å¤šé¤˜ç®—åŠ›&lt;/li&gt;
&lt;li&gt;å¤šå°‘æ‰æ˜¯å¤ ï¼Ÿ&lt;/li&gt;
&lt;li&gt;æ¸›å»å¤šå°‘ cpu / memoryï¼Œä¾ç„¶ä¸æ”¹è®Šæœå‹™å“è³ª&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¤šå°‘æ‰æ˜¯å¤ ï¼Ÿé€™æ˜¯ä¸€å€‹è¤‡é›œçš„å•é¡Œï¼Œå¯¦å‹™ä¸Šé€šå¸¸ä½¿ç”¨ SLA / SLO ä¾†è¡¡é‡æœå‹™å“è³ªï¼Œç„¶å¾Œæ ¹æ“šæœå‹™å“è³ªçš„è¦æ±‚ï¼Œä¾†è¨­å®š cpu / memory çš„é…é¡&lt;/p&gt;
&lt;p&gt;æˆ‘å€‘ä»Šå¤©è¦åšçš„æ˜¯æˆæœ¬å„ªåŒ–ï¼Œç™½è©±çš„èªªæ˜¯é™ä½ cpu / memory çš„è¨­å®šé…é¡ï¼Œä½†æ˜¯æˆ‘å€‘ä¸èƒ½é™ä½åˆ°å½±éŸ¿æœå‹™å“è³ª
ç”šè‡³é€€ä¸€ç™¾æ­¥ï¼Œé˜²å®ˆæ€§çš„ä¾†èªªï¼Œæˆ‘å€‘ä¸å¸Œæœ›å› ç‚ºé™ä½ cpu / memory çš„è¨­å®šé…é¡ï¼Œç‚ºäº†çœéŒ¢è€Œå°è‡´è² é¢çš„çµæœï¼Œç”šè‡³ç‚ºæœå‹™çš„ç©©å®šåº¦èƒŒé‹ã€‚&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¶­æŒslo&#34;&gt;ç¶­æŒSLO&lt;/h3&gt;
&lt;p&gt;ä»¥ç¶­æŒå„å€‹æœå‹™å…ƒä»¶çš„ SLOç‚ºå‰æï¼Œé™ä½ cpu / memory ä½¿ç”¨é‡&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;ç¶­æŒå€‹å€‹æœå‹™å…ƒä»¶çš„ SLO
æ˜¯ä¸€å€‹å¾ˆå¥½çš„æŒ‡æ¨™ï¼Œå¦‚æœä½ çš„æœå‹™æ˜¯ 99.9% çš„ SLAï¼Œé‚£éº¼ä½ çš„æœå‹™å°±è¦ä¿è­‰ 99.9% çš„æ™‚é–“éƒ½æ˜¯æ­£å¸¸é‹ä½œçš„ï¼Œé‚£éº¼ä½ çš„ cpu / memory å°±è¦è¶³å¤ æ”¯æŒé€™å€‹ SLA&lt;/p&gt;
&lt;p&gt;è«‡ SLO ä¹‹å‰ï¼Œä½ è¦å…ˆçŸ¥é“ä½ çš„æœå‹™çš„ SLA æ˜¯å¤šå°‘ï¼Œä½ è¦å…ˆçŸ¥é“ç•¶å‰çš„ç‹€æ…‹æ˜¯å¤šå°‘
é€™å€‹åœ¨ç¨å¾Œçš„ monitoring æœƒæåˆ°ï¼Œç‚ºä»€éº¼ç›£æ§æ˜¯æˆæœ¬ç®¡ç†çš„åŸºç¤&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;åŸºæ–¼-slo-çš„æˆæœ¬èª¿é™&#34;&gt;åŸºæ–¼ SLO çš„æˆæœ¬èª¿é™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è² è¼‰ç©©å®šçš„å…ƒä»¶ï¼Œå¯ä»¥æŠ“éå» 30d çš„ p99 cpu time æˆ– p99 memory usage + buffer&lt;/li&gt;
&lt;li&gt;è² è¼‰ä¸ç©©å®šçš„å…ƒä»¶ï¼Œä¾‹å¦‚ cpu usage èˆ‡å—æ´»èºç”¨æˆ¶æ•¸é‡æ­£æ¯”ï¼Œéœ€è¦æ­é… HPA æ°´å¹³æ‹“å±•&lt;/li&gt;
&lt;li&gt;è² è¼‰ä¸ç©©å®šçš„å…ƒä»¶ï¼Œä½†åˆä¸èƒ½æ°´å¹³æ‹“å±•ï¼Œä¾‹å¦‚ stateful serviceï¼Œå¯ä»¥è€ƒæ…® VPA&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  è² è¼‰ç©©å®šçš„å…ƒä»¶ï¼Œå›ºå®šåƒå¤šå°‘ cpu / memoryï¼Œä»–çš„é™„è¼‰ä¸å¤ªå®¹æ˜“éš¨å¤–éƒ¨å› ç´ æ³¢å‹•çš„æœå‹™ï¼Œå¯ä»¥æŠ“éå» 30d çš„ p99 cpu time æˆ– p99 memory usage + bufferï¼Œç„¶å¾Œé™ä½ cpu / memory çš„è¨­å®šé…é¡
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°çµæˆæœ¬æ§ç®¡çš„åŸºæœ¬æ¦‚å¿µ&#34;&gt;å°çµï¼šæˆæœ¬æ§ç®¡çš„åŸºæœ¬æ¦‚å¿µ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å°‹æ‰¾æœå‹™ä¸­å¤šé¤˜ç®—åŠ›&lt;/li&gt;
&lt;li&gt;ä»¥ç¶­æŒ SLO ç‚ºå‰æ&lt;/li&gt;
&lt;li&gt;é™ä½ cpu / memory ä½¿ç”¨é‡&lt;/li&gt;
&lt;li&gt;ä¾æ“šå…ƒä»¶è² è¼‰ç‰¹æ€§ï¼Œé¸æ“‡é©ç•¶çš„èª¿é™æ–¹å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;background-knowledge&#34;&gt;Background Knowledge&lt;/h3&gt;
&lt;h3 id=&#34;k8s-cpu--memory-managementhttpskubernetesiodocsconceptsconfigurationmanage-resources-containers&#34;&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/manage-resources-containers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s cpu / memory management&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/manage-resources-containers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/concepts/configuration/manage-resources-containers&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;k8s å¦‚ä½•ç®¡ç† workload çš„ cpu èˆ‡ memory&lt;/li&gt;
&lt;li&gt;èª¿é™å¤šå°‘æœƒå½±éŸ¿æœå‹™å“è³ª&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;é€™è£¡é¢å†è¬›ä¸€ä¸‹ k8s å¦‚ä½•ç®¡ç† cpu / memory&lt;/p&gt;
&lt;p&gt;é€™é‚Šçš„é‡é»æ˜¯ï¼Œæ€éº¼æ¨£çš„èª¿æ•´æœƒå½±éŸ¿åˆ°æœå‹™å“è³ªï¼Œé‚£æˆ‘å€‘åšæˆæœ¬æ§åˆ¶çš„æ™‚å€™ï¼Œå°±ä¸è¦å»è¸©åˆ°é€™å€‹åº•ç·š&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;how-k8s-manage-cpu--memoryhttpskubernetesiodocsconceptsconfigurationmanage-resources-containershow-pods-with-resource-limits-are-run&#34;&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#how-pods-with-resource-limits-are-run&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;How k8s manage cpu / memory&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;scheduler ä¾æ“š cpu / memory request èª¿åº¦ pod&lt;/li&gt;
&lt;li&gt;container runtime è¨­å®š cgroup
&lt;ul&gt;
&lt;li&gt;cpu ä½¿ç”¨é‡ä¾æ“š request ä½” node æ¯”ä¾‹åˆ†é…&lt;/li&gt;
&lt;li&gt;æ§åˆ¶ cpu ç”¨é‡ä¸è¶…é limit&lt;/li&gt;
&lt;li&gt;memory ä½¿ç”¨ limitï¼Œè¶…é limit æœƒè¢« oomkillï¼Œä¸¦ä¾æ“šè¨­å®šé‡å•Ÿ&lt;/li&gt;
&lt;li&gt;ç•¶å‰ node memory ä¸è¶³æ™‚ï¼Œæœƒä¾æ“š pod request Evict pod&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æ–‡ä»¶è¬›å¾—å¾ˆæ¸…æ¥š
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ä¸Šé¢éƒ½æ˜¯æ¦‚å¿µåº•ä¸‹é€²å¯¦ä½œ&#34;&gt;ä¸Šé¢éƒ½æ˜¯æ¦‚å¿µï¼Œåº•ä¸‹é€²å¯¦ä½œ&lt;/h3&gt;
&lt;hr&gt;
&lt;h3 id=&#34;monitoring&#34;&gt;Monitoring&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Monitoring æ˜¯ cost management çš„åŸºç¤&lt;/li&gt;
&lt;li&gt;æ²’æœ‰ monitoring å°±æ²’æœ‰ p99 cpu time / p99 memory usageï¼Œä¹Ÿæ²’æœ‰ SLI/SLO&lt;/li&gt;
&lt;li&gt;å¦‚æœæ²’æœ‰ monitoring å…ˆè£œ monitoring&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  å¦‚æœæ²’æœ‰ monitoringï¼Œä¸Šé¢çš„å…©å¤§å‰æéƒ½ä¸å­˜åœ¨
ç›®å‰çš„ cpu / memory usageï¼Œruntime utilization çš„è³‡æ–™
ç›®å‰SLOï¼Œèª¿é™ä¹‹å¾Œæ–°çš„SLO
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;grafana-dashboard.png&#34;
  &gt;

&lt;hr&gt;
&lt;h3 id=&#34;monitoring-èª¿æ•´å‰&#34;&gt;Monitoring: èª¿æ•´å‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;éå»çš„ p99 è³‡æºç”¨é‡&lt;/li&gt;
&lt;li&gt;ç›®å‰çš„æ•ˆèƒ½è¡¨ç¾&lt;/li&gt;
&lt;li&gt;å¤šé¤˜çš„ç®—åŠ› = (åˆ†é…çš„ resource - p99)&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;åšä¹‹å‰è¦èƒ½è©•ä¼°åšå®Œå¤§æ¦‚èƒ½çœå¤šå°‘
ä¾‹å¦‚è©•ä¼°å®Œå¾Œ&lt;/p&gt;
&lt;p&gt;å¦‚æœè©•ä¼°å®Œç™¼ç¾çœä¸äº†ä»€éº¼éŒ¢ï¼Œé‚£ç•¶ç„¶åœ˜éšŠå°±ä¸ä¸€å®šè¦åšé€™ä»¶äº‹&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;monitoring-èª¿æ•´å¾Œ&#34;&gt;Monitoring: èª¿æ•´å¾Œ&lt;/h3&gt;
&lt;p&gt;èª¿æ•´å‰å¾Œæ¯”è¼ƒ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è³‡æºç”¨é‡&lt;/li&gt;
&lt;li&gt;ç›®å‰çš„æ•ˆèƒ½è¡¨ç¾&lt;/li&gt;
&lt;li&gt;ç¢ºå®šæ²’æœ‰æ”¹å£æ±è¥¿&lt;/li&gt;
&lt;li&gt;æœ‰æ”¹å£ï¼Œè¦æœ‰åŠæ™‚çš„ alert&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  å¦‚æœä½ æ”¹å£äº†ï¼ŒåŠæ™‚çš„ alert æœƒæ•‘ä½ ä¸€å‘½
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;monitoring-tools&#34;&gt;Monitoring Tools&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://prometheus.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;prometheus.io&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.kubecost.com/using-kubecost&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubecost / Opencost&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;prometheus.png&#34;
  &gt;

&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¤§å®¶éƒ½çŸ¥é“ prometheus æ˜¯ä»€éº¼å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;çŸ¥é“çš„äººè«‹èˆ‰å€‹æ‰‹
ä¸çŸ¥é“çš„æˆ‘å¾ˆç°¡å–®èªªä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;æˆ‘å€‘æƒ³è¦çŸ¥é“ä¸€å€‹ pod æœƒéœ€è¦èŠ±å¤šå°‘ cpu / memoryï¼Œä½ å°±æŠŠå®ƒè·‘èµ·ä¾†ï¼Œç„¶å¾Œå»ç´€éŒ„è·‘èµ·ä¾†çš„ pod ç”¨äº†å¤šå°‘ cpu / memoryï¼Œç„¶å¾Œæ ¹æ“šæ™‚é–“çµ±è¨ˆï¼Œä½ å°±å¯ä»¥æ‹‰å‡ºä¸€å¼µåœ–ï¼Œçœ‹åˆ°é€™å€‹ pod ç”¨äº†å¤šå°‘ cpu / memory
ä½ çš„ kubelet / cadvisor / container runtime æœƒçŸ¥é“ä½ çš„ container çš„ cpu / memory ä½¿ç”¨é‡ï¼ŒåŒ…å« request &amp;amp; limit ç„¶å¾Œæ˜¯å¦æœ‰ throttling æˆ–æ˜¯ oomkillï¼Œé€™äº›è³‡è¨Šéƒ½æœƒè¢« prometheus æ”¶é›†èµ·ä¾†ï¼Œç„¶å¾Œä½ å¯ä»¥é€éå…¶ä»–å·¥å…·ï¼Œä¾‹å¦‚ kubecost çœ‹åˆ°é€™äº›è³‡è¨Š&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;grafana-cpu-usage.png&#34;
  &gt;

&lt;p&gt;&lt;a href=&#34;https://grafana.com/grafana/dashboards/17375-k8s-resource-monitoring/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://grafana.com/grafana/dashboards/17375-k8s-resource-monitoring/&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  é€™æ˜¯ prometheus æ”¶é›†çš„è³‡æ–™ï¼Œvm çš„ resource ä½¿ç”¨é‡çš„ grafana dashboard
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;cost-analysis-and-prediction&#34;&gt;Cost Analysis and Prediction&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰äº† prometheus å¾Œï¼Œæˆ‘å€‘çŸ¥é“çŸ­æœŸ/é•·æœŸçš„è³‡æºä½¿ç”¨ç‹€æ³&lt;/li&gt;
&lt;li&gt;è¦æŠŠè³‡æºä½¿ç”¨è½‰æˆæˆæœ¬ï¼Œéœ€è¦ä¸€å€‹æˆæœ¬è¨ˆç®—å·¥å…·&lt;/li&gt;
&lt;li&gt;è©•ä¼°æ˜¯å¦è¦åšæˆæœ¬ç²¾ç°¡ï¼Œèƒ½å¤ æ¸›å°‘å¤šå°‘éŒ¢&lt;/li&gt;
&lt;li&gt;ç®¡ç†ä¸Šçš„è€ƒé‡ï¼šæŠ•è³‡äººåŠ›æˆæœ¬ï¼Œèˆ‡é æœŸå›å ±&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;æ”¿æ²»ä¸Šçš„è€ƒé‡ï¼Œåšæˆæœ¬ç¯€çœéœ€è¦æ™‚é–“è·ŸäººåŠ›è³‡æº
æœ‰ä¸€å€‹ç²¾æº–çš„æˆæœ¬åˆ†æï¼Œç¯€çœç©ºé–“ä¼°ç®—çš„å·¥å…·ååˆ†æœ‰èªªæœåŠ›&lt;/p&gt;
&lt;p&gt;æœ‰é€™äº›è³‡æ–™ï¼Œæ‰å¯ä»¥ç§‘å­¸åŒ–æ±ºç­–è¦ä¸è¦åšï¼Œè©²æ€éº¼åš
åšä¹‹å‰å°±èƒ½è©•ä¼°åšå®Œå¤§æ¦‚èƒ½çœå¤šå°‘&lt;/p&gt;
&lt;p&gt;å¦‚æœè©•ä¼°å®Œç™¼ç¾çœä¸äº†ä»€éº¼éŒ¢ï¼Œé‚£ç•¶ç„¶åœ˜éšŠå°±ä¸ä¸€å®šè¦åšé€™ä»¶äº‹&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;cost-analysis--billing&#34;&gt;Cost Analysis:  billing&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å„å®¶å…¬æœ‰å…ƒéƒ½æœ‰è‡ªå·±çš„è²»ç”¨è¨ˆç®—å·¥å…·&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://azure.microsoft.com/en-us/products/cost-management&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Azure Cost Management&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/aws-cost-management/aws-cost-explorer/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS Cost Explorer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cloud.google.com/billing/docs/how-to/cost-breakdown&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GCP Cost Breakdown&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;azure-cost-management.jpeg&#34;
  &gt;

&lt;hr&gt;
&lt;h3 id=&#34;cost-analysis-cloud-billing&#34;&gt;Cost Analysis: Cloud billing&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¨ˆç®—é•·æ™‚é–“çš„è²»ç”¨è¶¨å‹¢&lt;/li&gt;
&lt;li&gt;é©åˆç•¶ä½œæˆæœ¬ç²¾ç°¡å¾Œçš„æˆæœå›å ±&lt;/li&gt;
&lt;li&gt;ä¸é©åˆç•¶åšèª¿æ•´çš„ä¾æ“š&lt;/li&gt;
&lt;li&gt;æ™‚é–“è¨ˆç®—è¼ƒé•·ï¼Œåé¥‹æ™‚é–“é•·ï¼Œä¸åŠæ™‚ï¼Œé …ç›®ä¸å¤ ç²¾ç´°&lt;/li&gt;
&lt;li&gt;æœ‰ç„¡æ›´å³æ™‚çš„æˆæœ¬åˆ†æå·¥å…·ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;cost-analysis-kubecost--opencosthttpsdocskubecostcomusing-kubecost&#34;&gt;Cost Analysis: &lt;a href=&#34;https://docs.kubecost.com/using-kubecost/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubecost / Opencost&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰æä¾› UI&lt;/li&gt;
&lt;li&gt;åŸºæ–¼ prometheus&lt;/li&gt;
&lt;li&gt;å¯ä»¥é‡å° allocation åšæˆæœ¬åˆ†æ &lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cost Allocation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¯ä»¥é€é cloud provider å»æ’ˆé›²ç«¯çš„ä½¿ç”¨è³‡æ–™&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;kubecost.jpeg&#34;
  &gt;

&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;kubecost-allocation.jpeg&#34;
  &gt;

&lt;p&gt;&lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;kubecost-efficiency.png&#34;
  &gt;

&lt;p&gt;&lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation/efficiency-idle&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/cost-allocation/efficiency-idle&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;recommedation-tools&#34;&gt;Recommedation Tools&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/robusta-dev/krr&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/robusta-dev/krr&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/savings&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubecost / Opencost Savings&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/pkg/recommender/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VPA recommendator&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;recommedation-tools-kubecost--opencost-savingshttpsdocskubecostcomusing-kubecostnavigating-the-kubecost-uisavings&#34;&gt;Recommedation Tools: &lt;a href=&#34;https://docs.kubecost.com/using-kubecost/navigating-the-kubecost-ui/savings&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubecost / Opencost Savings&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¨­å®š target utilization
&lt;ul&gt;
&lt;li&gt;dev 80%+&lt;/li&gt;
&lt;li&gt;prod 60%&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æ ¹æ“šæœå‹™å“è³ªçš„è¦æ±‚ï¼Œä»¥åŠå…¬å¸æ”¿ç­–å»åšè¨­å®š
SLA/SLO
é–‹ç™¼èˆ‡æ¸¬è©¦ç’°å¢ƒï¼Œåœ¨ä¸å½±éŸ¿å·¥ä½œçš„å‰æï¼Œéƒ½å¯ä»¥æ‹‰åˆ° overcommit
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;recommedation-tools-krr&#34;&gt;Recommedation Tools: KRR&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/robusta-dev/krr&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/robusta-dev/krr&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å…å®‰è£ï¼Œä¸å½±éŸ¿ k8s æœ¬èº«&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¤–éƒ¨å·¥å…·è®€å– prometheus è³‡æ–™&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;recommedation-tools-krr-1&#34;&gt;Recommedation Tools: KRR&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl port-forward svc/prometheus 9090
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone https://github.com/robusta-dev/krr.git
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;source .venv/bin/activate
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python krr.py simple \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  -p http://127.0.0.1:9090 \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --mem-min 10 \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --cpu-min 10 \
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  --history_duration 720 -q
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;krr.jpeg&#34;
  &gt;

&lt;hr&gt;
&lt;h3 id=&#34;recommedation-tools-krr-2&#34;&gt;Recommedation Tools: KRR&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ ¹æ“š krr è¨ˆç®—çš„çµæœï¼Œæ‰‹å‹•èª¿æ•´&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€äº›å·¥å…·æœ‰æä¾›è‡ªå‹•èª¿æ•´ ex VPA&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;è‡ªå‹•å·¥å…·æ¯”æ‰‹å‹•éœ€è¦è€ƒé‡æ›´å¤šå› ç´ ï¼Œé€™å€‹æˆ‘å€‘ç¨å€™ VPA å†æ&lt;/p&gt;
&lt;p&gt;è«‹è©³é–±å·¥å…·èªªæ˜å†æœç”¨&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;recommedation-tools-vpa-recommendatorhttpsgithubcomkubernetesautoscalerblobmastervertical-pod-autoscalerpkgrecommenderreadmemd&#34;&gt;Recommedation Tools: &lt;a href=&#34;https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/pkg/recommender/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VPA recommendator&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;éœ€è¦å…ˆçŸ¥é“ VPA æ˜¯ä»€éº¼&lt;/li&gt;
&lt;li&gt;ç›´æ¥å®‰è£åœ¨ k8s cluster å…§&lt;/li&gt;
&lt;li&gt;é€é Prometheus è³‡æ–™ï¼Œæ¨è–¦é©ç•¶çš„è³‡æº&lt;/li&gt;
&lt;li&gt;å¯ä»¥è‡ªå‹•åŒ–æ¨è–¦è³‡æºï¼Œèª¿æ•´é‹è¡Œä¸­çš„ podï¼Œä¾ç…§è¨­å®šé‡å•Ÿ pod &lt;a href=&#34;https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/README.md#quick-start&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VPA mode&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;éœ€è¦å¯ä»¥åƒè€ƒ &lt;a href=&#34;https://github.com/cowboysysop/charts/tree/master/charts/vertical-pod-autoscaler&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;helm chart&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  krr æ˜¯å¯ä»¥ç„¡è…¦ç”¨çš„å·¥å…·ï¼Œä½†æ˜¯ VPA å°±ä¸æ˜¯äº†
è«‹è¨­å®š VPA mode Off
è«‹å‹™å¿…éœ€è¦ç ”ç©¶ä¸€ä¸‹åœ¨ä½¿ç”¨
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;recommedation-tools-æ¯”è¼ƒ&#34;&gt;Recommedation Tools: æ¯”è¼ƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;kubecost éœ€è¦ helm installï¼Œkrr ä¸éœ€è¦&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;kubecost ç”¢ç”Ÿä¸€å€‹æ¼‚äº®çš„ UIï¼Œkrr ç”¢ç”Ÿ command line å ±è¡¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;VPA éœ€è¦ helm installï¼Œä¸¦ä¸”æœƒéœ€è¦ cluster æ¬Šé™&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;VPA å¯ä»¥åšåˆ°è‡ªå‹•åŒ–èª¿æ•´ï¼Œé‚è¼¯æ›´è¤‡é›œï¼Œæœ‰ä¾µå…¥æ€§ï¼Œè¨­å®šæœ‰å•é¡Œæœƒå‡ºäº‹&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å‰›ä¸Šæ‰‹çš„åšæ³•&#34;&gt;å‰›ä¸Šæ‰‹çš„åšæ³•&lt;/h3&gt;
&lt;p&gt;æ²’æ™‚é–“ç´°éƒ¨ç ”ç©¶ç ”ç©¶å…ƒä»¶çš„è¡Œç‚ºï¼Œç›´æ¥èª¿æ•´ request èˆ‡ limit&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆèª¿é™ requestï¼Œä¸å‹• limitï¼Œå°æœå‹™è¡æ“Šè¼ƒå°&lt;/li&gt;
&lt;li&gt;ç”¨æŠ“æ¯”ä¾‹çš„æ–¹å¼å‹•æ…‹èª¿æ•´ï¼Œä¾‹å¦‚ç›®å‰ request è·é›¢ p99 request å·®è· 1000Miï¼Œä½ å…ˆæ”¶ 500Mi å›ä¾†è©¦å€‹æ°´æº«&lt;/li&gt;
&lt;li&gt;p99 ç›´æ¥ä½¿ç”¨ tool è¨ˆç®—ï¼Œç´°ç¯€åœ¨å¾Œé¢&lt;/li&gt;
&lt;li&gt;æ¸¬è©¦ç’°å¢ƒå…ˆè¡Œï¼Œæœ‰ä¿¡å¿ƒåœ¨ä¸Š production&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¦‚æœä½ ç¬¬ä¸€æ¬¡åšï¼Œä½†å°æœå‹™å…ƒä»¶æ²’æœ‰ç†Ÿåˆ°é€™ç¨®ç¨‹åº¦ï¼Œé€™æ˜¯æ¯”è¼ƒå®‰å…¨çš„åšæ³•
å…¬å¸è¦æ¨¡å¤§æœå‹™å…ƒä»¶è¤‡é›œï¼Œèº«ç‚º SRE ä½ åªèƒ½ä»°è³´ metrics ä¾†åˆ¤æ–·æœå‹™å“è³ªæ˜¯å¦å—å½±éŸ¿ï¼Œä½†å¾ˆå¤šè¤‡é›œçš„æœå‹™ï¼Œä»¥åŠä¸ç†Ÿæ‚‰çš„æœå‹™ï¼Œæœƒå¾ˆé›£è©•ä¼°&lt;/p&gt;
&lt;p&gt;å…ˆèª¿é™ requestï¼Œæå‡å–®ä¸€ node ä¸Šçš„ pod æ•¸é‡ï¼Œç„¶å¾Œè§€å¯Ÿæœå‹™å“è³ªï¼Œå¦‚æœæœå‹™å“è³ªæ²’æœ‰å—åˆ°å½±éŸ¿ï¼Œé‚£éº¼ä½ å¯ä»¥é€²ä¸€æ­¥èª¿é™ limit
å¸‚å ´å–Šåƒ¹ï¼Œå…ˆå–Šå€‹ä¸€åŠï¼Œåœ¨çœ‹èƒ½ç¹¼çºŒå£“åˆ°ä»€éº¼ç¨‹åº¦&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°çµ&#34;&gt;å°çµ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ”¶é›†ç›®å‰è³‡æºä½¿ç”¨è³‡æ–™&lt;/li&gt;
&lt;li&gt;è½‰åŒ–æˆå…¬æœ‰é›²çš„æˆæœ¬&lt;/li&gt;
&lt;li&gt;é€é tool å»ºè­°é©ç•¶çš„è³‡æº&lt;/li&gt;
&lt;li&gt;æ ¹æ“šæœå‹™å“è³ªçš„è¦æ±‚ï¼Œèª¿é™ cpu / memory&lt;/li&gt;
&lt;li&gt;å›é ­æª¢æŸ¥ SLO æ˜¯å¦æœ‰å—åˆ°å½±éŸ¿&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;hpa&#34;&gt;HPA&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s/horizontal-pod-autoscale&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ HPA åœ¨æˆæœ¬ç²¾ç°¡çš„æ„ç¾©ï¼šå› ç‚ºå¤–éƒ¨å› ç´ æ”¹è®Šè² è¼‰çš„å…ƒä»¶&lt;/li&gt;
&lt;li&gt;ä½è² è¼‰æ™‚ä¸è¦é–‹å¤ªå¤šï¼Œé«˜è² è¼‰æ™‚è‡ªå‹•åŠ é–‹ pod&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;hpa-è€ƒé‡&#34;&gt;HPA: è€ƒé‡&lt;/h3&gt;
&lt;p&gt;å…ƒä»¶æ˜¯å¦èƒ½å¤ æ°´å¹³æ‹“å±•&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å•Ÿå‹•çš„ liveness check / readiness check&lt;/li&gt;
&lt;li&gt;laod balancer&lt;/li&gt;
&lt;li&gt;éœ€è¦æŒçºŒèª¿æ•´ scale up / down çš„æ¢ä»¶èˆ‡ time windows&lt;/li&gt;
&lt;li&gt;scale up å°ä¾è³´æœå‹™çš„ loading æœƒæœ‰å½±éŸ¿ ex. å¾Œé¢çš„ db&lt;/li&gt;
&lt;li&gt;é€€å ´æ©Ÿåˆ¶ï¼Œè¦å¦‚ä½•å®‰å…¨çš„ä¸­æ–·é€£ç·šï¼Œç´€éŒ„ state&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;è¦èƒ½å®‰å…¨åœ°é€²å‡ºå ´&lt;/p&gt;
&lt;p&gt;é€²å ´ï¼Œpod readiness / liveness
loading å¢åŠ æ™‚ scale up time windows
scale out å°å¾Œæ–¹æœå‹™çš„å½±éŸ¿ï¼Œæ˜¯å¦æœƒå‡ºç¾æ–°çš„ç“¶é ¸&lt;/p&gt;
&lt;p&gt;loading é™ä½æ™‚ scale down æ˜¯å¦æœƒå½±éŸ¿æœå‹™&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;vpa&#34;&gt;VPA&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes/autoscaler/blob/master/vertical-pod-autoscaler/README.md#quick-start&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;k8s/autoscaler/vertical-pod-autoscaler&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ä¸èƒ½æ°´å¹³æ‹“å±•ï¼Œåªå¥½å…ˆå‚ç›´æ‹“å±•&lt;/li&gt;
&lt;li&gt;èª¿æ•´è³‡æºï¼Œæœ‰å¯èƒ½æœƒé‡å•Ÿ pod / container&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/blog/2023/05/12/in-place-pod-resize-alpha/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes 1.27: In-place Resource Resize for Kubernetes Pods (alpha)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes/kubernetes/issues/122760&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;In-Place Pod Resource Resizing always restarts pod&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¦‚æœä½ çš„ workload ç„¶å¾Œä¸é©åˆåš HPAï¼Œä½†å¯ä»¥æ¥å— resize å¾Œé‡å•Ÿï¼Œé‚£å¯ä»¥è©¦è©¦VPA&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  1.27 ä½ å¯ä»¥æŠŠ InPlacePodVerticalScaling feature gate é–‹èµ·ä¾†
ä»–ä¸ä¿è­‰ resize å¾Œä¸æœƒé‡å•Ÿ podï¼Œé‚„æ˜¯è¦çœ‹ä½ çš„ container runtime æ”¯æ´ç¨‹åº¦
è«‹å…ˆåœ¨æ¸¬è©¦ç’°å¢ƒä¸­ç©ä¸€ç©
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;saving-plan--ri&#34;&gt;Saving Plan / RI&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;AWS Saving Plan / RI&lt;/li&gt;
&lt;li&gt;GCP Committed Use Discount&lt;/li&gt;
&lt;li&gt;Azure Reservation&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;Saving Plan / RI æ˜¯ä¸€ç¨®é•·æœŸçš„åˆç´„ï¼Œä½ å¯ä»¥è·Ÿé›²ç«¯æœå‹™å•†ç°½ç´„ï¼Œä¿è­‰ä½ æœƒç”¨å¤šå°‘è³‡æºï¼Œç„¶å¾Œé›²ç«¯æœå‹™å•†æœƒçµ¦ä½ ä¸€å€‹æŠ˜æ‰£
ä¸ƒæŠ˜ä¸Šä¸‹ï¼Œå¾ˆé©åˆé•·æœŸä½¿ç”¨çš„å®¢æˆ¶&lt;/p&gt;
&lt;p&gt;æœ‰ monitoring + predictionï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç¢ºå®šä½ æœƒç”¨å¤šå°‘è³‡æºï¼Œé€™æ™‚å€™å°±å¯ä»¥è€ƒæ…® saving plan / RI&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;spot-instance&#34;&gt;Spot Instance&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://azure.microsoft.com/en-us/products/virtual-machines/spot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;azure spot vm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/ec2/spot/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;aws spot intance&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cloud.google.com/spot-vms&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gcp spot vm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¸³é¢ä¸Šæœ€é«˜å¯çœ 90%&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;spot-instance-1&#34;&gt;Spot Instance&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¶…ä¾¿å®œï¼Œæ‰“ä¸€æŠ˜&lt;/li&gt;
&lt;li&gt;å¤šé¤˜çš„ç®—åŠ›&lt;/li&gt;
&lt;li&gt;interruptionï¼Œä¸ä¿è­‰ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/ec2/spot/instance-advisor/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://aws.amazon.com/ec2/spot/instance-advisor/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  å› ç‚ºä¸€æŠ˜çœŸçš„å¾ˆé¦™ï¼Œä¸€æŠ˜æ˜¯æœ‰é»æ‹¼ï¼Œä½†æ‰“å€‹ 3 æŠ˜é‚„æ˜¯å¾ˆæœ‰æ©Ÿæœƒ
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;spot-instance-åˆ†é¡-workload&#34;&gt;Spot Instance: åˆ†é¡ workload&lt;/h3&gt;
&lt;p&gt;interruption ç›´æ¥å½±éŸ¿æœå‹™å“è³ªçš„å°±ä¸å®œ&lt;/p&gt;
&lt;p&gt;ä¸å½±éŸ¿æœå‹™å“è³ªçš„&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;stateless&lt;/li&gt;
&lt;li&gt;batch job&lt;/li&gt;
&lt;li&gt;å°‡ worklaod å¾ monolithic æ‹†åˆ†æˆå°çš„ batch job&lt;/li&gt;
&lt;li&gt;æ¸¬è©¦ç’°å¢ƒ dev / stag&lt;/li&gt;
&lt;li&gt;CI/CD&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;ä¹çœ‹ä¹‹ä¸‹å¹¾å€‹å°æ™‚~24hr å…§æœƒè¢«é‡å•Ÿï¼Œå¥½åƒæ˜¯çŠ§ç‰²äº†æœå‹™å“è³ªï¼Œä½†å¦‚æœä½ çš„æœå‹™æ˜¯å¯ä»¥å®¹å¿ interruption çš„ï¼Œä¾‹å¦‚ batch jobï¼Œé‚£éº¼ spot instance å°±æ˜¯ä¸€å€‹å¾ˆå¥½çš„é¸æ“‡&lt;/p&gt;
&lt;p&gt;å°‡ worklaod å¾ monolithic æ‹†åˆ†æˆå°çš„ batch jobï¼Œä¾‹å¦‚ä½ æ˜¯ api server è™•ç†ä¸€å€‹ request æœƒæœ‰å¾ˆå¤šæ­¥é©Ÿï¼Œä½ å¯ä»¥æŠŠé€™äº›æ­¥é©Ÿæ‹†åˆ†æˆå°çš„ batch jobï¼Œç„¶å¾Œç”¨ queue ä¸²æ¥ï¼Œé€™æ¨£ä½ çš„ api server å°±å¯ä»¥ç”¨ spot instance ä¾†è·‘ï¼Œç„¶å¾Œä½ çš„ batch job ç”¨ spot instance è·‘ï¼Œé€™æ¨£ä½ çš„æœå‹™å°±å¯ä»¥çœå¾ˆå¤šéŒ¢&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°çµ-1&#34;&gt;å°çµ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;krr å·¥å…·èª¿æ•´è³‡æº&lt;/li&gt;
&lt;li&gt;HPA åšæ°´å¹³æ“´å±•&lt;/li&gt;
&lt;li&gt;VPA è‡ªå‹•åŒ–èª¿æ•´è³‡æº&lt;/li&gt;
&lt;li&gt;saving plan / RI é•·æœŸåˆç´„æ‰“ä¸ƒæŠ˜&lt;/li&gt;
&lt;li&gt;spot instance æ‰“ä¸€æŠ˜&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å±•æœ›&#34;&gt;å±•æœ›&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;cost awareness development&lt;/li&gt;
&lt;li&gt;find-grade optimization&lt;/li&gt;
&lt;li&gt;automation&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æœ‰äº†è³‡æºé æ¸¬ç³»çµ±ï¼Œå¯ä»¥åœ¨é–‹ç™¼éšæ®µå°±å°‡è³‡æºä½¿ç”¨å›é¥‹çµ¦é–‹ç™¼åœ˜éšŠ
æ ¹æ“šä¸åŒæœå‹™å…ƒä»¶çš„å“è³ªè¦æ±‚ï¼Œåšæ›´ç´°ç·»çš„è³‡æºç®¡æ§
è‡ªå‹•åŒ–èª¿æ•´ï¼Œè®“äººåŠ›å¯ä»¥å°ˆæ³¨åœ¨æ›´é‡è¦çš„äº‹æƒ…ä¸Š
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å°çµ-2&#34;&gt;å°çµ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;cpu / memory&lt;/li&gt;
&lt;li&gt;ç›£æ¸¬æ˜¯åŸºç¤&lt;/li&gt;
&lt;li&gt;ä¾æ“šç›£æ¸¬åšé æ¸¬&lt;/li&gt;
&lt;li&gt;é–‹å§‹èª¿æ•´&lt;/li&gt;
&lt;li&gt;é•·æœŸåˆç´„æ‰“ä¸ƒæŠ˜&lt;/li&gt;
&lt;li&gt;spot instance æ‰“ä¸€æŠ˜&lt;/li&gt;
&lt;li&gt;HPA / VPA&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ„Ÿè¬&#34;&gt;æ„Ÿè¬&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;presentation and speaker notes &lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;chechia.net&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.linkedin.com/company/maicoin/jobs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Maicoin è·ç¼º&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¬å¸ç¦åˆ©ä¸éŒ¯ï¼Œæ¥­å‹™æˆé•·ä¸­ï¼Œæƒ³ä¸€èµ·å…±äº‹ï¼Œæ­¡è¿æ‰¾æˆ‘èŠ&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Kubernetes Summit: Resource as Code for Kubernetes: Stop kubectl apply</title>
      <link>https://chechia.net/zh-hant/slides/2023-10-25-k8s-resource-as-code/</link>
      <pubDate>Mon, 23 Oct 2023 00:00:00 +0000</pubDate>
      <guid>https://chechia.net/zh-hant/slides/2023-10-25-k8s-resource-as-code/</guid>
      <description>
&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;onepiece.jpg&#34;
  &gt;

&lt;aside class=&#34;notes&#34;&gt;
  Q1: æœ‰éä½¿ç”¨ helm è·Ÿ argocd çš„äººè«‹èˆ‰æ‰‹
Q2: k8s object èµ° gitflow ç®¡ç†çš„æ¯”ä¾‹æœ‰è¶…é 9 æˆçš„
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;resource-as-code-for-k8s-object&#34;&gt;Resource as Code for K8s Object&lt;/h3&gt;
&lt;h3 id=&#34;å¦‚ä½•ç®¡ç†-k8s-object&#34;&gt;å¦‚ä½•ç®¡ç† k8s object&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Che Chia Chang&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;outline&#34;&gt;Outline&lt;/h3&gt;
&lt;p&gt;Manage Kubernetes Objects in Gitflow&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;kubectl&lt;/li&gt;
&lt;li&gt;helm chart&lt;/li&gt;
&lt;li&gt;argocd (gitflow)
&lt;ul&gt;
&lt;li&gt;applicationset&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;test&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;ä»Šå¤©çš„å…§å®¹å‰åŠéƒ¨åƒæ˜¯è¬›å¤&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæœƒè¬› kubectl create / apply
kubectl ä½¿ç”¨ï¼Œç„¶å¾Œå®˜æ–¹æœ‰æé†’æˆ‘å€‘ä½¿ç”¨ kubectl ç®¡ç† k8s object æ™‚çš„ trade-offï¼Œé€™äº› trade-off æˆ‘å€‘å¯ä»¥ä½¿ç”¨å…¶ä»–çš„å·¥å…·ä¾†å½Œè£œ&lt;/p&gt;
&lt;p&gt;å°å…¥ helm chartï¼Œä¾†æ‰“åŒ… k8s objects è®Šæˆä¸€å€‹å®Œæ•´åœ°ç™¼å¸ƒå–®ä½&lt;/p&gt;
&lt;p&gt;argocd èµ° gitflow ä¾†ç™¼å¸ƒ&lt;/p&gt;
&lt;p&gt;ç„¶å¾Œåœ¨ workflow è£¡åŠ å…¥æ¸¬è©¦ï¼Œç¢ºä¿ k8s objects çš„äº¤ä»˜å“è³ª&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;kubectl&#34;&gt;Kubectl&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# Imperative commands 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl create deployment nginx --image nginx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# Imperative object configuration 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl create -f nginx.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# Declarative object configuration
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -R -f configs/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/overview/working-with-objects/object-management/#management-techniques&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/concepts/overview/working-with-objects/object-management/#management-techniques&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  kubectl æ‡‰è©²æ˜¯æ‰€æœ‰äººå­¸ k8s çš„ç¬¬ä¸€å€‹å·¥å…·
ä½œç‚ºå®˜æ–¹çš„ cli å·¥å…·ï¼Œkunectl éå¸¸å¼·å¤§ï¼Œå¯ä»¥æ§åˆ¶å¹¾ä¹å¤§éƒ¨åˆ† k8s çš„ apiï¼Œä¹Ÿèƒ½å°å¹¾ä¹æ‰€æœ‰ k8s object é€²è¡Œæ“ä½œ
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;kubectl.jpg&#34;
  &gt;

&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;é¦–å…ˆï¼Œå¦‚åŒå®˜æ–¹æ–‡ä»¶æ‰€æè¿°ï¼Œkubectl çš„ä½¿ç”¨ä¸Šï¼Œä¹Ÿæœ‰å„ç¨®ä¸åŒæ–¹æ³•ã€‚ie. kubectl äº¤åœ¨ä¸åŒäººæ‰‹ä¸Šï¼Œä½¿ç”¨æ–¹å¼æ˜¯ä¸åŒçš„
å®˜æ–¹æ–‡ä»¶æè¿°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Imperative commands æŒ‡ä»¤å¼&lt;/li&gt;
&lt;li&gt;Imperative object configuration æŒ‡ä»¤ç‰©ä»¶&lt;/li&gt;
&lt;li&gt;Declarative object configuration å®£å‘Šç‰©ä»¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;kubectl create deployment nginxï¼Œä¸€è¡Œå‘½ä»¤å‘Šè¨´ k8s ä½ è¦ create deployment&lt;/p&gt;
&lt;p&gt;kubectl create -f nginx.yamlï¼Œä½¿ç”¨è€…é¸æ“‡è¦ create / apply / delete è€Œ nginx.yaml è£¡é¢æè¿°ä¸€å€‹ nginx deployment ç‰©ä»¶&lt;/p&gt;
&lt;p&gt;kubectl apply -f -R nginx/ï¼Œä½¿ç”¨è€…æè¿°ä¸€å€‹æˆ–å¤šå€‹ç‰©ä»¶ï¼Œæè¿°ç‰©ä»¶çš„ç‹€æ…‹ã€‚apply æ™‚ï¼Œç”± kubectl æ±ºå®šè¦å° object åŸ·è¡Œï¼Œcreate / update / delete&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;issue&#34;&gt;Issue&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# Imperative commands 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl create deployment nginx --image nginx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# Imperative object configuration 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl create -f nginx.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# Declarative object configuration
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -R -f configs/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;kubectl é€™éº¼å¥½ç”¨ï¼Œé‚£ç‚ºä½•ä¸ç¹¼çºŒç”¨ä¸‹å»ï¼Ÿ&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;çš„å•é¡Œå¾ˆæ˜é¡¯ï¼Œä¸èƒ½ diff
2.3. æœƒæœ‰ä¸€å€‹åŸºç¤çš„ specï¼Œé—œæ–¼ deployment/nginxï¼Œå› æ­¤å¯ä»¥åœ¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é‡é»&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;change review / diff&lt;/li&gt;
&lt;li&gt;source record other than live&lt;/li&gt;
&lt;li&gt;templateï¼Œä¸€å€‹å¯é‡è¤‡ä½¿ç”¨çš„æ¨£ç‰ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2.3. çš„å•é¡Œï¼Œä½ å¿…é ˆå° object å¤ äº†è§£ï¼Œæ‰å¯«å¾—å‡ºå®Œæ•´æ²’ bug çš„ spec yaml&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;è½èµ·ä¾†æ˜¯æœ€å®Œæ•´çš„ï¼Œä»–çš„å•é¡Œå°±æ˜¯è¦å¦‚ä½•ç¶­æŒ local file èˆ‡ live é€£çµï¼Œæˆ–æ˜¯èªª sync
é€™å€‹æœ‰ä½¿ç”¨ argocd çš„äººå¯èƒ½å°±æœƒæ¯”è¼ƒæœ‰æ„Ÿè¦º&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¤§å®¶æœ‰èˆˆè¶£å¯ä»¥å»çœ‹å®˜æ–¹æè¿°çš„å…§å®¹ï¼Œé€™è£¡ä¸è´…è¿°&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;issue-1&#34;&gt;Issue&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;change review / diff before apply&lt;/li&gt;
&lt;li&gt;source of live record&lt;/li&gt;
&lt;li&gt;template / repetitive apply&lt;/li&gt;
&lt;li&gt;sync local to live&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;ul&gt;
&lt;li&gt;change review / diff before apply&lt;/li&gt;
&lt;li&gt;source of live record&lt;/li&gt;
&lt;li&gt;template / repetitive apply&lt;/li&gt;
&lt;li&gt;sync local to live&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;declarative-object-configuration&#34;&gt;Declarative object configuration&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;nginx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ deployment.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ ingress.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ service.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;redis
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ deployment.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ ingress.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ service.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;microservice-a b c ...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  ç‚ºäº† change reviewï¼Œé€šå¸¸æœƒèµ°å‘ 3. Declarative object configurationï¼Œå¯èƒ½æœƒé•·é€™æ¨£
ä¸€å€‹ git repository
è£¡é¢æœ‰å¤šå€‹ directoryï¼Œæè¿°æ¯ä¸€çµ„æœå‹™æ‰€éœ€è¦çš„è³‡æº
ä½¿ç”¨ kubectl ä¸€æ¬¡ apply æ•´å€‹ directoryï¼Œæ‰€ä»¥ local file åŸºæœ¬ä¸Šä¹Ÿåæ‡‰ live object
æœ‰ local fileï¼Œå¾ˆè‡ªç„¶è€Œç„¶å°±æœƒæƒ³è¦æ”¾åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼Œä¾‹å¦‚ gitï¼Œé€™æ¨£åˆå¯ä»¥èµ° gitflow
PR -&amp;gt; review -&amp;gt; merged -&amp;gt; apply master / release tag
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;helm.jpg&#34;
  &gt;

&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;æœ‰äººåœ¨ 2014 å¹´å‰ç”¨é k8s å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¤æ—©æ™‚æœŸï¼Œè¦ç”¨å€‹ redis é‚„è¦è‡ªå·±åŒ… service / ingress / deploymentï¼Œå…ˆå» dockerhub æ‰¾ redisï¼Œç„¶å¾Œä¾æ“š readme è‡ªå·±åŒ… deploymentï¼Œè‡ªå·±æ¸¬è©¦çœ‹ redis æœƒä¸æœƒå‹•&lt;/p&gt;
&lt;p&gt;ç¾åœ¨æ‡‰è©²æ²’æœ‰äººæœƒå› ç‚ºè¦å»ä½¿ç”¨ redis æˆ–æ˜¯ mysqlï¼Œè‡ªå·±è·‘å»å¯« k8s object äº†å§&lt;/p&gt;
&lt;p&gt;helm v2.0-alpha 2016&lt;/p&gt;
&lt;p&gt;ç¾åœ¨æœ‰ helm + chart&lt;/p&gt;
&lt;p&gt;å¦‚æœåªæ˜¯ä½¿ç”¨ä½ä¸‰æ–¹é–‹æºçš„ helm chartï¼Œç¤¾ç¾¤å¹«ä½ ç¶­è­· service / ingress / deployment&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æä¾›åŸºæœ¬çš„ default valueï¼Œé è¨­å°±è·‘å¾—èµ·ä¾†&lt;/li&gt;
&lt;li&gt;è·‘å¾—èµ·ä¾†å¾Œï¼Œè·‘å¾—å¥½ï¼Œèƒ½ä½¿ç”¨ k8s orchestration æä¾›å®Œæ•´çš„åŠŸèƒ½ï¼Œé€é value.yaml æ§åˆ¶&lt;/li&gt;
&lt;li&gt;ç¶“éæ¸¬è©¦&lt;/li&gt;
&lt;li&gt;issue tracking&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;helm-chart&#34;&gt;Helm chart&lt;/h3&gt;
&lt;p&gt;k8s object çš„é–‹ç™¼ï¼Œæ‰“åŒ…ï¼Œæ¸¬è©¦ï¼Œrelease&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;k8s ååˆ†å¼·å¤§ï¼Œäº«å— orchestration&lt;/li&gt;
&lt;li&gt;k8s object è®Šå¾—å¤ªè¤‡é›œ&lt;/li&gt;
&lt;li&gt;æ¨™æº–åŒ– templateï¼Œrelease + upgrade&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;chart ä½œç‚ºä¸€å€‹ k8s object çš„ release / artifactï¼Œæœ‰é–‹ç™¼æµç¨‹ï¼Œç‰ˆæœ¬æ§ç®¡ï¼Œæ¸¬è©¦ï¼Œå®Œæ•´çš„ç™¼ä½ˆ&lt;/p&gt;
&lt;p&gt;app æœ¬èº«ï¼Œä¾‹å¦‚ redisï¼Œç•¶ç„¶æ˜¯æ•´å€‹æ‡‰ç”¨çš„æ ¸å¿ƒã€‚ä½†è¦èƒ½å¤ åœ¨ k8s åŸ·è¡Œï¼Œä¸¦æ­£ç¢ºåœ°äº«å— k8s orchestration çš„å¥½è™•ï¼Œk8s object éå¸¸çš„é‡è¦&lt;/p&gt;
&lt;p&gt;ç”šè‡³ï¼Œk8s object è¤‡é›œåº¦å·²ç¶“é é è¶…ééå»åœ¨ vm ä¸Šè·‘ä¸€å€‹ redisï¼Œå…œä¸€å€‹ systemd unit å°±å¯ä»¥è·‘èµ·ä¾†&lt;/p&gt;
&lt;p&gt;k8s object éœ€è¦ release / versionï¼Œæ‰èƒ½åš object çš„å›ºå®šç‰ˆæœ¬ applyï¼Œupgrade ç”Ÿç‰ˆï¼Œæœ‰å•é¡Œ rollback&lt;/p&gt;
&lt;p&gt;åœ¨ k8s ä¸Šè¦è·‘å¾—ç©©é‚Šçš„ååˆ†é–«é›£ï¼Œé€éç¤¾ç¾¤ä¾†ç¶­è­·å¤§éƒ¨åˆ†é€šé‹çš„ç¬¬ä¸‰æ–¹æœå‹™&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;helm-chart-library&#34;&gt;Helm Chart Library&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME       URL
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;bitnami    https://charts.bitnami.com/bitnami
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;argocd     https://argoproj.github.io/argo-helm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;chaos-mesh https://charts.chaos-mesh.org
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;k8s objects èƒ½å‹•å¾ˆç°¡å–®ï¼Œä½†è¦è·‘å¾—ç©©åˆèƒ½äº«å— orchestration çš„ä¾¿åˆ©ï¼Œååˆ†å›°é›£
é€éç¤¾ç¾¤ä¾†ç¶­è­·å¤§éƒ¨åˆ†é€šé‹çš„ç¬¬ä¸‰æ–¹æœå‹™ï¼Œé€éå–®ä¸€ value.yaml&lt;/p&gt;
&lt;p&gt;ç¤¾ç¾¤ç¶­è­·çš„ chart ä¸æ˜¯å°±ä¸€å‹æ°¸é€¸&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ç†±é–€çš„ chart&lt;/li&gt;
&lt;li&gt;ç‰¹æ®Šéœ€æ±‚æ™‚ï¼Œé‚„æ˜¯éœ€è¦ fork chart å›ä¾†è‡ªå·±ç¶­è­·&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½†ç„¡è«–å¦‚ä½•ï¼Œéƒ½æ˜¯å¤§å¹…é™ä½ç¶­é‹çš„è¤‡é›œåº¦&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;helm-ç”Ÿæ…‹ç³»&#34;&gt;helm ç”Ÿæ…‹ç³»&lt;/h3&gt;
&lt;p&gt;ex. helmfile&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;repositories:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- name: argocd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  url: https://argoproj.github.io/argo-helm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helmDefaults:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  kubeContext: general
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  #verify: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  wait: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  timeout: 300
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;context: general
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;releases:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- name: argocd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  namespace: argocd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  chart: argocd/argo-cd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  version: 5.31.0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  values:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  - values/argocd.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- name: redis
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- name: mysql
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/cdwv/awesome-helm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/cdwv/awesome-helm&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;æ›´é«˜å±¤ç´šçš„å°è£&#34;&gt;æ›´é«˜å±¤ç´šçš„å°è£&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;api-services
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ nginx
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ mysql
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ ingress -&amp;gt; nlb
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;daemon-services
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ redis
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ mysql
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ kafka
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;åº•ä¸‹çš„ä¾è³´æ¨™æº–åŒ–ï¼Œä¾æ“šç©©å®šçš„ release ç™¼å¸ƒä¹‹å¾Œ
å¯ä»¥å†é€²è¡Œæ›´é«˜å±¤ç´šçš„å°è£&lt;/p&gt;
&lt;p&gt;é‡è¤‡æ€§çš„æœå‹™ï¼Œä¾‹å¦‚æ¯å€‹ microservice éƒ½éœ€è¦
ä¾‹å¦‚æˆ‘æœ‰ä¸€ç™¾å€‹ api service groupï¼Œéƒ½æ˜¯ restful apiï¼Œéƒ½éœ€è¦ ingress / service / nginx ç­‰ç­‰&lt;/p&gt;
&lt;p&gt;åº•ä¸‹çš„å…ƒä»¶æ¨™æº–åŒ–ï¼Œé™ä½ç¶­è­·æˆæœ¬&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çµ±ä¸€ç‰ˆæœ¬ï¼Œé†«ç—…ç¶­è­·ï¼Œå‡ç´šï¼Œé€€ç‰ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¾‹å¦‚ daemon serviceï¼Œåº•ä¸‹ä¾è³´ queue / redis / db&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;å¾®æœå‹™&#34;&gt;å¾®æœå‹™&lt;/h3&gt;
&lt;p&gt;å¾®æœå‹™ä¸æ˜¯å•é¡Œï¼Œå¾®æœå‹™åº•ä¸‹çš„ k8s object æ‰æ˜¯å•é¡Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯ä»¥å¿«é€Ÿï¼Œæ¨™æº–åŒ–çš„ç”¢ç”Ÿç¶“éæ¸¬è©¦ï¼Œå¾®æœå‹™å–®å…ƒ&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;issues&#34;&gt;Issues&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;V change review / diff before apply&lt;/li&gt;
&lt;li&gt;source of live record&lt;/li&gt;
&lt;li&gt;V template / repetitive apply&lt;/li&gt;
&lt;li&gt;sync local to live&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;version control / gitflow&lt;/p&gt;
&lt;p&gt;helm template æœ‰æä¾›è¨±å¤šèªæ³•ï¼Œå¯ä»¥æœ‰ç³»çµ±åŒ–çš„ç”¢ç”Ÿé‡è¤‡çš„ k8s object
ex. å¯ä»¥è·‘ for loop / for each
é€™å€‹åœ¨ IaC æˆ–æ˜¯ resource as code çš„ xxx as code éƒ½ååˆ†æœ‰åˆ©&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;argo-cd&#34;&gt;Argo CD&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://argo-cd.readthedocs.io/en/stable/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Declarative GitOps CD for Kubernetes&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://argo-cd.readthedocs.io/en/stable/assets/argocd-ui.gif&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;why-argo-cd&#34;&gt;Why Argo CD?&lt;/h3&gt;
&lt;p&gt;Application definitions, configurations, and environments should be declarative and version controlled. Application deployment and lifecycle management should be automated, auditable, and easy to understand.&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;application æ‡‰è©²æ˜¯æ˜ç¢ºå®£å‘Šçš„ï¼Œæ¸…æ¥šæè¿°ï¼Œä¸¦ä¸”æœ‰ç‰ˆæœ¬æ§ç®¡
æè¿° application æœ¬èº«ï¼Œé™„å¸¶çš„è¨­å®š secret / configmap
environment ä¹Ÿæ‡‰è©²æ˜¯å®£å‘Šå¼çš„&lt;/p&gt;
&lt;p&gt;application çš„éƒ¨ç½²èˆ‡ lifecycle ç®¡ç†ï¼Œéƒ½æ‡‰è©²æ˜¯è‡ªå‹•åŒ–ï¼Œå¯ä»¥ç¨½æ ¸ï¼Œè€Œä¸”å¥½ç†è§£
æ¨™æº–åŒ–ï¼Œè‡ªå‹•åŒ–
UI åœ–åƒæè¿°ï¼Œä¸€ç›®ç­ç„¶ã€‚ä½†äº‹å¯¦ä¸Šå¦‚æœæœ‰åšåˆ°è¬› local file æ¨åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼Œå…‰æ˜¯ä½¿ç”¨ editor ä¹Ÿå¯ä»¥åšåˆ°ä¸€ç›®ç­ç„¶&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;argo-cd-1&#34;&gt;Argo CD&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;gitflow / git repository&lt;/li&gt;
&lt;li&gt;argocd application sync file from repository&lt;/li&gt;
&lt;li&gt;argocd controller è‡ªå‹•åŒ–çš„ç¢ºä¿ sync
&lt;ul&gt;
&lt;li&gt;un-sync è‡ªå‹•åŒ–è™•ç†&lt;/li&gt;
&lt;li&gt;ç„¡æ³• sync æ™‚é€šçŸ¥&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;gitflow&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;k8s object çš„ change æ˜¯éœ€è¦ PR review çš„ï¼Œä¸æ˜¯æƒ³æ”¹å°± kubectl apply ä¸‹å»&lt;/li&gt;
&lt;li&gt;k8s object çš„å“è³ªæŠŠé—œï¼Œä¾†è‡ªé«˜å“è³ªçš„ review&lt;/li&gt;
&lt;li&gt;é‡å° cluster ä¸Šçš„è®Šæ›´éƒ½æœ‰ç®¡æ§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;èƒ½å¤ ç›´æ¥æŒæ¡ live objectï¼Œé€é editor æª¢æŸ¥ git repositoryï¼Œæˆ–æ˜¯é€é argocd UI æª¢è¦–&lt;/p&gt;
&lt;p&gt;local file ç­‰æ–¼ live object
åœ¨è¤‡é›œçš„ç’°å¢ƒè£¡å¾ˆé‡è¦ï¼Œex. k8s å…§æœ‰æˆåƒä¸Šç™¾å€‹ helm releaseï¼Œå¯ä»¥ç”¨ editor æª¢è¦– local file&lt;/p&gt;
&lt;p&gt;ä¸ç„¶è¦é€é k8s å»æ‰“ api&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;api call ä¹Ÿæ˜¯è³‡æºå•Šï¼Œèƒ½çœå‰‡çœ&lt;/li&gt;
&lt;li&gt;editor æ›´ç›´è¦ºå¿«é€Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;applicationset&#34;&gt;applicationset&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://argo-cd.readthedocs.io/en/stable/operator-manual/applicationset/Generators-Git/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;git generator&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;apiVersion: argoproj.io/v1alpha1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kind: ApplicationSet
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  name: general-argocd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  namespace: argocd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  generators:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  - git:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      repoURL: https://github.com/chechiachang/azure-argo
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      revision: master
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      directories:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      - path: clusters/dev/dev-general/argocd/*
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  template:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    metadata:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      name: &amp;#39;dev-general-argocd-{{path.basename}}&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      labels:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        environment: dev
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        type: infra
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        function: argocd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        cluster: dev-general
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    spec:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      project: default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      syncPolicy:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        automated:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          prune: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      source:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        repoURL: https://github.com/chechiachang/azure-argo
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        targetRevision: master
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        path: &amp;#39;clusters/dev/dev-general/argocd/{{path.basename}}&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      destination:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        server: https://kubernetes.default.svc
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        namespace: argocd
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;argocd é™¤äº† sync ä»¥å¤–é‚„æä¾›çš„è¨±å¤šåŠŸèƒ½&lt;/p&gt;
&lt;p&gt;applicationset å®šç¾©ä¸€çµ„ setï¼Œå¯ä»¥é€é generator è¿­ä»£çš„ç”¢ç”Ÿå¤§é‡çš„ application
ex. ä¸€æ¬¡ deploy ä¸€ç¾¤ redis&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;applicationset-1&#34;&gt;applicationset&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;dev-general
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ default/redis
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ default/mysql
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ default/my-app
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ nginx-ingress/nginx-ingress
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ argocd/argocd
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;stag-general
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;prod-general
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;cluster-wide-çš„-k8s-object&#34;&gt;cluster-wide çš„ k8s object&lt;/h3&gt;
&lt;p&gt;cluster-wide çš„ k8s object ä¹Ÿå¾ˆé©åˆ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ helm template helper ä¾†ç®¡ç† value.yaml label / annotation / env / &amp;hellip;&lt;/li&gt;
&lt;li&gt;namespace&lt;/li&gt;
&lt;li&gt;rbac&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;cluster-wide çš„ k8s object ä¹Ÿå¾ˆé©åˆå¡é€² argocd ç®¡ç†&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ cluster access controlï¼Œè¤‡é›œçš„ rbac ruleï¼Œä¹Ÿå¾ˆé©åˆæ•´ç†æˆç‚º helm chart&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯ä»¥è¼•é¬†å¯¦ç¾ user -&amp;gt; rule å¤šå°å¤š&lt;/li&gt;
&lt;li&gt;å¯ä»¥å¿«é€Ÿå¢æ¸› user group&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;issues-1&#34;&gt;Issues&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;V change review / diff before apply&lt;/li&gt;
&lt;li&gt;V source of live record&lt;/li&gt;
&lt;li&gt;V template / repetitive apply&lt;/li&gt;
&lt;li&gt;V sync local to live&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;more-issues-multi-hybrid-cluster&#34;&gt;More Issues: multi-hybrid cluster&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;multiple k8s
&lt;ul&gt;
&lt;li&gt;dev / stag / prod&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;hybrid k8s
&lt;ul&gt;
&lt;li&gt;bare metal / public cloud&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;ç”±æ–¼ k8s å…§éƒ¨çš„ component éƒ½å·²ç¶“æ¨™æº–åŒ–ï¼Œå¯ä»¥å¾ˆè¼•æ˜“åœ°è¤‡è£½æ¸¬è©¦éçš„ component
dev æ¸¬è©¦ PR branchï¼Œstaging è·‘ release candicateï¼Œproduction é¸æ“‡ç¶“éæ¸¬è©¦çš„ release&lt;/p&gt;
&lt;p&gt;èƒ½å¤ ç¢ºä¿ dev / stag / prod çš„ k8s object æ˜¯å®Œå…¨ç›¸åŒçš„&lt;/p&gt;
&lt;p&gt;hybrid ç’°å¢ƒç®¡ç†ï¼ŒæŸäº› k8s å…ƒä»¶æ‡‰è©²å®‰è£åœ¨å“ªäº› cluster ä¸Š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;aws ingress controller / csi driver / cni node daemonsets&lt;/li&gt;
&lt;li&gt;local nginx-ingress controller&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;more-issues-multi-hybrid-cluster-1&#34;&gt;More Issues: multi-hybrid cluster&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://argo-cd.readthedocs.io/en/stable/operator-manual/applicationset/Generators-Cluster/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;argocd cluster generator&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kind: ApplicationSet
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  name: aws-cni
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  namespace: kube-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  generators:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  - clusters:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      selector:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        matchLabels:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          eks: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          #bare-metal: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          staging: true
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;more-issues-multi-hybrid-cluster-2&#34;&gt;More Issues: multi-hybrid cluster&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://argo-cd.readthedocs.io/en/stable/operator-manual/applicationset/Generators-Cluster/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;argocd cluster generator&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;aws-eks-1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ aws cni
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ aws ingress controller
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ nginx-ingress controller
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;bare-metal-1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ cilium
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ bare-metal ingress
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ nginx-ingress controller
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  å¤šåº§ cluster
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;more-issues-multi-hybrid-cluster-3&#34;&gt;More Issues: multi-hybrid cluster&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;applicationset&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;more-issues-test&#34;&gt;More Issues: Test&lt;/h3&gt;
&lt;p&gt;k8s object éœ€ä¸éœ€è¦æ¸¬è©¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;infra-test (bare-metal / self-hosted)&lt;/li&gt;
&lt;li&gt;release (helm chart)&lt;/li&gt;
&lt;li&gt;live status&lt;/li&gt;
&lt;li&gt;stress / load test / chaos engineering&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;k8s object éœ€ä¸éœ€è¦æ¸¬è©¦ï¼Œè¦ºå¾—éœ€è¦æ¸¬è©¦çš„è«‹èˆ‰æ‰‹&lt;/p&gt;
&lt;p&gt;k8s object éœ€ä¸éœ€è¦æ¸¬è©¦ï¼Œå°±è·Ÿé€™å€‹æŠ•å½±ç‰‡ä¸€æ¨£
æœ‰æ™‚é–“å°±è¬›ä¸€ä¸‹ï¼Œæ²’æ™‚é–“å°±è·³éå§&lt;/p&gt;
&lt;p&gt;infra-test provider æ‡‰è©²éƒ½æ¸¬å®Œäº†
è¦æ¸¬çš„æ˜¯ k8s object çš„åŠŸèƒ½æ˜¯å¦ç¬¦åˆé æœŸ&lt;/p&gt;
&lt;p&gt;ç•¶ç„¶ï¼Œæœ‰æ¸¬è©¦çš„ helm releae èˆ‡æ²’æ¸¬è©¦çš„ helm release ä¹Ÿæ˜¯å¤©å·®åœ°é &lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;test-ansible-playbook&#34;&gt;Test: ansible playbook&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æ¸¬è©¦ apply å¾Œ k8s object çš„ status
&lt;ul&gt;
&lt;li&gt;ingress æ˜¯å¦ ready&lt;/li&gt;
&lt;li&gt;endpoint æ˜¯å¦æœ‰ç”¢ç”Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¯ä»¥å…ˆæ¸¬
&lt;ul&gt;
&lt;li&gt;networking (ingress / svc)&lt;/li&gt;
&lt;li&gt;storage (csi / pvc)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- name: Test nginx deployment
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  hosts: {{ host }}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  gather_facts: no
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  vars:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    deployment_name: &amp;#34;nginx&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  tasks:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  - name: Get deployment status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    shell: kubectl get deployment {{ deployment_name }} -o=jsonpath=&amp;#39;{.status.readyReplicas}&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    register: deployment_status
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    failed_when: deployment_status.rc != 0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  - name: Verify deployment is running
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    assert:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      that:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        - deployment_status.stdout != &amp;#39;null&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        - deployment_status.stdout != &amp;#39;0&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      fail_msg: &amp;#39;Deployment {{ deployment_name }} is not running.&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;more-issues-test-1&#34;&gt;More Issues: Test&lt;/h3&gt;
&lt;p&gt;&lt;del&gt;Test&lt;/del&gt; Monitoring&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;prometheus rule with helm chart&lt;/li&gt;
&lt;li&gt;ServiceMonitor&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  helm release ä¸€å€‹ api-services
api service æœ‰ /metrics endpoint
é€é ServiceMonitor ä¾†æŒçºŒæ€§çš„ç´€éŒ„ metrics
é€é PrometheusRule ä¾†è¨­å®šç•°å¸¸ metrics çš„å‘Šè­¦
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;more-issues-test-2&#34;&gt;More Issues: Test&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;stress-test / load test
&lt;ul&gt;
&lt;li&gt;k6&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;chaos-engineering
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://chaos-mesh.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://chaos-mesh.org/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/asobti/kube-monkey&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/asobti/kube-monkey&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h3 id=&#34;summary&#34;&gt;Summary&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;kubectl + gitflow&lt;/li&gt;
&lt;li&gt;helm chart&lt;/li&gt;
&lt;li&gt;argocd: applicationset / generator&lt;/li&gt;
&lt;li&gt;test&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Q &amp;amp; A&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DevOpsDay: HashiCorp Vault è‡ªå»ºé‡‘é‘°ç®¡ç†æœ€ä½³å…¥å‘å§¿å‹¢</title>
      <link>https://chechia.net/zh-hant/slides/2023-09-26-devopsday-2023-vault/</link>
      <pubDate>Thu, 21 Sep 2023 00:00:00 +0000</pubDate>
      <guid>https://chechia.net/zh-hant/slides/2023-09-26-devopsday-2023-vault/</guid>
      <description>
&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;onepiece.jpg&#34;
  &gt;

&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;Q1: æœ‰éä½¿ç”¨ hashicorp vault çš„äººè«‹èˆ‰æ‰‹&lt;/p&gt;
&lt;p&gt;æ²’ä½¿ç”¨éçš„äººä¸æ˜¯é€™å€‹ session çš„ç›®æ¨™è½çœ¾ï¼Œå¯ä»¥ QR code æ‹ä¸‹ä¾†å»è½åˆ¥å ´ã€‚ä¾‹å¦‚å°é¢åŒé¡Œæçš„session
QR code æœ‰æŠ•å½±ç‰‡ï¼Œç¯„ä¾‹ github repoï¼ŒæŠ•å½±ç‰‡è£¡é‚„æœ‰è¬›ç¨¿ï¼Œæ‰€ä»¥æˆ‘ä»Šå¤©åœ¨é€™è£¡çš„ç”¨è™•å°±æ˜¯å¿µç¨¿ï¼ŒçœŸçš„å¯ä»¥ qrcode æ‹äº†å›å®¶çœ‹&lt;/p&gt;
&lt;p&gt;Q2: æœ‰ä½¿ç”¨é infrastructure as code / terraform çš„äººè«‹èˆ‰æ‰‹&lt;/p&gt;
&lt;p&gt;æœ‰ä½¿ç”¨ vault ä½†æ˜¯æ²’æœ‰ä½¿ç”¨ IaC çš„æœ‹å‹ï¼Œæ‰æ˜¯é€™å ´ session çš„ä¸»è¦å—çœ¾&lt;/p&gt;
&lt;p&gt;Q3: æœ‰ä½¿ç”¨ iac deploy vault stackï¼Œæˆ–æ˜¯æœ‰ä½¿ç”¨ iac / vcs ç®¡ç† vault å…§çš„ policy çš„äººè«‹èˆ‰æ‰‹&lt;/p&gt;
&lt;p&gt;é€™äº›äººå¯ä»¥å‡ºå»åƒé›¶é£Ÿï¼Œä»Šå¤©è¬›çš„å…§å®¹ä½ å€‘éƒ½æœƒäº†ï¼Œæˆ‘æ²’ä»€éº¼æ±è¥¿å¯ä»¥è·Ÿä½ å€‘åˆ†äº«&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;background.jpg&#34;
  &gt;

&lt;h2 id=&#34;hashicorp-vault&#34;&gt;HashiCorp Vault&lt;/h2&gt;
&lt;h2 id=&#34;è‡ªå»ºé‡‘é‘°ç®¡ç†æœ€ä½³å¯¦è¸&#34;&gt;è‡ªå»ºé‡‘é‘°ç®¡ç†æœ€ä½³å¯¦è¸&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://chechia.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Che Chia Chang&lt;/a&gt; | &lt;a href=&#34;https://chechia.net/zh-hant/tag/%E9%90%B5%E4%BA%BA%E8%B3%BD2023/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Vault éµäººè³½ workshop&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  s
æ¨™é¡Œæœ‰ç¨å¾®ä¿®æ”¹
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;about me&#34; srcset=&#34;
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/about-me_hu0533df8c600b6ebf5e775c57536fef00_311608_e417eec7e7a8490233a5f244ea106c42.webp 400w,
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/about-me_hu0533df8c600b6ebf5e775c57536fef00_311608_12a09867edd8370d5a4cd5564f097279.webp 760w,
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/about-me_hu0533df8c600b6ebf5e775c57536fef00_311608_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2023-09-26-devopsday-2023-vault/about-me_hu0533df8c600b6ebf5e775c57536fef00_311608_e417eec7e7a8490233a5f244ea106c42.webp&#34;
               width=&#34;760&#34;
               height=&#34;375&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://chechia.net/zh-hant/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;About Me&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;

&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;background.jpg&#34;
  &gt;

&lt;h3 id=&#34;outline&#34;&gt;Outline&lt;/h3&gt;
&lt;h3 id=&#34;from-dev-to-prod-ready&#34;&gt;from dev to prod-ready&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;terraform deployment IaC
&lt;ul&gt;
&lt;li&gt;on aws / azure / gcp / k8s&lt;/li&gt;
&lt;li&gt;å¦‚ä½•é–‹å§‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;terraform configuration IaC
&lt;ul&gt;
&lt;li&gt;IaC everything
&lt;ul&gt;
&lt;li&gt;secret backends / auth method / role / policy / audit &amp;hellip;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å·¥ä½œæµç¨‹è‡ªå‹•åŒ– gitflow / tested / automation&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  manage vault infra &amp;amp; vault configuration from a aspect of devops
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;vault-åŸºç¤çš„å­¸ç¿’è³‡æº&#34;&gt;Vault åŸºç¤çš„å­¸ç¿’è³‡æº&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.google.com/presentation/d/1iex9lm89OCIR8IAoD1RPe4vcW--bcKBmMHoixDybqP8/edit?usp=sharing&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;2023-05-10 é›²ç«¯åœ°ç«¯é€šåƒçš„ç§é‘°ç®¡ç†å¹³å°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://chechia.net/zh-hant/tag/%E9%90%B5%E4%BA%BA%E8%B3%BD2023/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;2023 éµäººè³½: vault 10- day workshop&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://ithelp.ithome.com.tw/users/20120327/ironman/4057&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;2021 éµäººè³½: terraform 30 day workshop&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/chechiachang/vault-playground&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¯„ä¾‹ Github&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;åŒä¸€æ™‚é–“ï¼ŒVault + Kubernetes è«‹å‡ºé–€å°é¢DEæœƒè­°å®¤&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;ä¸æœƒè¬› vault çš„åŸºç¤æ“ä½œï¼Œä½†å¦‚æœä½ éœ€è¦å­¸ç¿’è³‡æºï¼Œä½ å¯ä»¥ä¾†é€™é‚Šæ‰¾
ç¬¬ä¸€å€‹ google slides æ˜¯æˆ‘åœ¨å…¶ä»–å ´åˆçš„æ¼”è¬›ï¼Œé©åˆç¬¬ä¸€æ¬¡æ¥è§¸ vaultï¼Œæˆ–æ˜¯æ­£åœ¨è©•ä¼°æ˜¯å¦è¦å°å…¥ vault çš„åœ˜éšŠ&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒå€‹ä»Šå¹´çš„ ithome 2023éµäººè³½ï¼Œæˆ‘å¯«çš„å…§å®¹å°±æ˜¯ vault workshopï¼Œé›–ç„¶å¯«åˆ°ç¬¬åç¯‡å°±å› æ•…åœæ›´ï¼Œä½†å‰é¢ 1-8 ç¯‡å‰›å¥½æ˜¯ vault æ“ä½œåŸºç¤ï¼Œä½¿ç”¨ chatgpt ç¿»è­¯ vault official tutorialï¼Œä¹Ÿæ˜¯é©åˆç¬¬ä¸€æ¬¡ä½¿ç”¨ vault çš„äºº&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰å€‹æ˜¯å¦‚æœæ²’æ¥è§¸é infrastructure as code IaCï¼Œé€™å€‹ä¹Ÿæ˜¯éµäººè³½çš„ 30 day workshopï¼Œé€™å€‹æœ‰å®Œè³½ä½³ä½œ&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;production-deploy-checklisthttpsdeveloperhashicorpcomvaulttutorialskuberneteskubernetes-raft-deployment-guideproduction-deployment-checklist&#34;&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/tutorials/kubernetes/kubernetes-raft-deployment-guide#production-deployment-checklist&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;production deploy checklist&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;End-to-End TLS&lt;/li&gt;
&lt;li&gt;Single Tenancy&lt;/li&gt;
&lt;li&gt;Enable Auditing&lt;/li&gt;
&lt;li&gt;Immutable Upgrades&lt;/li&gt;
&lt;li&gt;Upgrade Frequently&lt;/li&gt;
&lt;li&gt;Restrict Storage Access&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;é€²å…¥ production å‰çš„ç¶­é‹å•é¡Œ&lt;/p&gt;
&lt;p&gt;vault å®˜æ–¹å»ºè­°çš„ prod checklist
å¤§å¤šéœ€è¦å®šæœŸæ›´æ–°ï¼Œç¶­è­·ï¼Œè€Œéä¸€å‹æ°¸é€¸ä¸€æ¬¡æ€§ä½œæ¥­&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ end-to-end TLS certificate éœ€è¦ç®¡ç†èˆ‡æ›´æ–°&lt;/p&gt;
&lt;p&gt;auditing å° vault çš„å­˜å–ç´€éŒ„éœ€è¦å®‰å…¨çš„è¼¸å‡ºï¼Œä¸¦ä¸”èƒ½å¤ æª¢æ ¸ã€‚è¨­å®šåšä¸€æ¬¡å°±å¯ä»¥ç”Ÿæ•ˆã€‚ä½†æ˜¯å¯¦å‹™ä¸Šæœªä¾†æœƒéœ€è¦ä¸æ–·çš„æ ¹æ“šå¤–éƒ¨ç¨½æ ¸éœ€æ±‚èª¿æ•´&lt;/p&gt;
&lt;p&gt;immutable upgrades æŒ‡çš„æ˜¯ç•¶ä½ ä½¿ç”¨ vault server èˆ‡ storage backendï¼Œvault server æœ¬èº«æ˜¯ immutable çš„ï¼Œä½ å¯ä»¥è‡ªå·±ä½¿ç”¨ official binary build VM Image (ex. aws ami)ï¼Œæˆ–æ˜¯é€é container image release ä¾†æ›´æ–°&lt;/p&gt;
&lt;p&gt;upgrade frequentlyï¼Œä½†è¦åšçš„å®‰å…¨ï¼Œè€Œä¸”æœ‰æ•ˆç‡ï¼Œæœ€å¥½æ˜¯åšåˆ°åŠè‡ªå‹•åŒ–æˆ–æ˜¯å…¨è‡ªå‹•åŒ–ï¼Œå¦‚æœæ²’æœ‰ IaC æœƒæ¯”è¼ƒè€—å·¥&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;infrastructure-as-code&#34;&gt;Infrastructure as Code&lt;/h2&gt;
&lt;p&gt;å°å…¥ IaC ï¼Œåšåˆ°é »ç¹ä¸”å®‰å…¨çš„ vault æ›´æ–°ï¼Œä½†åŒæ™‚åˆè¦æœ‰æ•ˆç‡ç”šè‡³å…¨è‡ªå‹•åŒ–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;multiple env: dev, stag, prod&lt;/li&gt;
&lt;li&gt;programable / reusable: æ¨™æº–åŒ–ï¼Œå¯é‡è¤‡ä½¿ç”¨çš„ code&lt;/li&gt;
&lt;li&gt;tested infrastructure&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;ä»¥ vault ç‚ºç›®æ¨™
ç¶­é‹ vault çš„ç¬¬ä¸€ç›®æ¨™ï¼šå®‰å…¨ç¬¬ä¸€ï¼Œä¸æ±‚é«˜æ•ˆèƒ½ï¼Œä½†æ˜¯è¿½æ±‚å®‰å…¨
æ˜¯æˆ‘å€‘è¦å°‡ deploy / release / upgrade vault ä¸­çš„é¢¨éšªé™åˆ°æœ€ä½&lt;/p&gt;
&lt;p&gt;infra: å‡ç´š vault ç‰ˆæœ¬ï¼Œèª¿æ•´ VM / containerï¼Œèª¿æ•´ load balancerï¼Œé™¤éŒ¯
config: æ›´æ”¹ auth-method / policy&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;policy å®¹æ˜“æ”¹å£ä½†ç„¡æ³•åŠæ™‚ç™¼ç¾ï¼Œè¦ç”¨æ™‚æ‰ç™¼ç¾æ¬Šé™å£äº†&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;å¦‚ä½•é–‹å§‹-iac-for-vault&#34;&gt;å¦‚ä½•é–‹å§‹ IaC for Vault&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;immutable Vault server&lt;/li&gt;
&lt;li&gt;storage backend&lt;/li&gt;
&lt;li&gt;load balancer&lt;/li&gt;
&lt;li&gt;security group / firewall rule&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  IaC å¥½æ£’ï¼Œé‚£æœ‰æ²’æœ‰ä»€éº¼è³‡æºå¯ä»¥å¹«åŠ©æˆ‘å€‘é–‹å§‹ deploy IaC Vault
ç­”æ¡ˆæ˜¯æœ‰çš„
&lt;/aside&gt;
&lt;hr&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/deliver-iac_hu0533df8c600b6ebf5e775c57536fef00_243366_9f383f9419bbc426efb073535d07bb90.webp 400w,
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/deliver-iac_hu0533df8c600b6ebf5e775c57536fef00_243366_e189cd499d567e542a61c269d1655dda.webp 760w,
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/deliver-iac_hu0533df8c600b6ebf5e775c57536fef00_243366_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2023-09-26-devopsday-2023-vault/deliver-iac_hu0533df8c600b6ebf5e775c57536fef00_243366_9f383f9419bbc426efb073535d07bb90.webp&#34;
               width=&#34;760&#34;
               height=&#34;415&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.terraform.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.terraform.io/&lt;/a&gt;&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;deploy-on-public-cloud&#34;&gt;Deploy on public cloud&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/hashicorp/terraform-aws-vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/hashicorp/terraform-aws-vault&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/hashicorp/terraform-aws-vault-starter&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/hashicorp/terraform-aws-vault-starter&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/hashicorp/terraform-azurerm-vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/hashicorp/terraform-azurerm-vault&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/terraform-google-modules/terraform-google-vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/terraform-google-modules/terraform-google-vault&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  åœ¨å…¬æœ‰é›² deploy Vaultï¼Œé›²æœå‹™å•†æœ‰æä¾›æ—¢æœ‰çš„terraform module
ä¸ä¸€å®šè¦ç…§å–®å…¨æ”¶ï¼Œå¯ä»¥è©¦è‘—æ¶èµ·æ¸¬è©¦ç’°å¢ƒï¼Œç„¶å¾Œèª¿æ•´terraform moduleï¼Œæˆç‚ºé©åˆè‡ªå·±ç”¢å“çš„æ¶æ§‹
èª¿æ•´æ¶æ§‹éœ€è¦è€ƒé‡çš„é»ï¼Œåº•ä¸‹åˆ†æ
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;deploy-terraform-aws-vaulthttpsgithubcomhashicorpterraform-aws-vault&#34;&gt;Deploy &lt;a href=&#34;https://github.com/hashicorp/terraform-aws-vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;terraform-aws-vault&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://github.com/hashicorp/terraform-aws-vault/blob/master/_docs/architecture.png?raw=true&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  hashicorp å®˜æ–¹æä¾›çš„ terraform-aws-vault æ˜¯ä¸€å€‹ä¸éŒ¯çš„é–‹å§‹
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;terraform-aws-vaulthttpsgithubcomhashicorpterraform-aws-vault&#34;&gt;&lt;a href=&#34;https://github.com/hashicorp/terraform-aws-vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;terraform-aws-vault&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ELB -&amp;gt; AWS Autoscaling Group -&amp;gt; EC2&lt;/li&gt;
&lt;li&gt;Backend: consul cluster&lt;/li&gt;
&lt;li&gt;Vault AMI&lt;/li&gt;
&lt;li&gt;security group&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/hashicorp/terraform-aws-vault/blob/master/test/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tested&lt;/a&gt; by hashicorp with &lt;a href=&#34;https://github.com/gruntwork-io/terratest&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;terratest&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  goto &lt;a href=&#34;https://github.com/hashicorp/terraform-aws-vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/hashicorp/terraform-aws-vault&lt;/a&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;terraform-aws-vaulthttpsgithubcomhashicorpterraform-aws-vault-1&#34;&gt;&lt;a href=&#34;https://github.com/hashicorp/terraform-aws-vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;terraform-aws-vault&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/terraform-aws-vault_hu0533df8c600b6ebf5e775c57536fef00_310936_ae456b396f746fd2b64cf6415e38c5df.webp 400w,
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/terraform-aws-vault_hu0533df8c600b6ebf5e775c57536fef00_310936_c450b16c6a48d50aa7bc746acdb4b8a6.webp 760w,
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/terraform-aws-vault_hu0533df8c600b6ebf5e775c57536fef00_310936_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2023-09-26-devopsday-2023-vault/terraform-aws-vault_hu0533df8c600b6ebf5e775c57536fef00_310936_ae456b396f746fd2b64cf6415e38c5df.webp&#34;
               width=&#34;760&#34;
               height=&#34;384&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;å¦‚ä½•ä½¿ç”¨&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯ä»¥åƒè€ƒ main.tf ç¯„ä¾‹&lt;/li&gt;
&lt;li&gt;å¯ä»¥æª¢è¦– ./modules å…§èªªæ˜é€æ­¥æ“ä½œ&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;terraform-aws-vault-starterhttpsgithubcomhashicorpterraform-aws-vault-starter&#34;&gt;&lt;a href=&#34;https://github.com/hashicorp/terraform-aws-vault-starter&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;terraform-aws-vault-starter&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ELB -&amp;gt; AWS Autoscaling Group -&amp;gt; EC2&lt;/li&gt;
&lt;li&gt;security group&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/concepts/integrated-storage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Integrated storage (raft)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  goto &lt;a href=&#34;https://github.com/hashicorp/terraform-aws-vault-starter&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/hashicorp/terraform-aws-vault-starter&lt;/a&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;integrated-storage&#34;&gt;Integrated storage&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/internals/integrated-storage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;integrated-storage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Raft Consensus protocol
&lt;ul&gt;
&lt;li&gt;å‡ºincidentè¦æœ‰è¾¦æ³•è§£&lt;/li&gt;
&lt;li&gt;stateful server&lt;/li&gt;
&lt;li&gt;å‚™ä»½ï¼Œç®¡ç†(è³‡æ–™é·ç§») util å·¥å…·æœªå¿…å¤ æˆç†Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é¸ä¸€å€‹æœƒç¶­è­·çš„&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/configuration/storage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;storage&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/configuration/storage/dynamodb&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;DynamoDB&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/configuration/storage/mysql&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;MySQL&lt;/a&gt; / &lt;a href=&#34;https://developer.hashicorp.com/vault/docs/configuration/storage/postgresql&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PostgreSQL&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  æ³¨æ„storageæ˜¯å¦èƒ½å¤ ç‚ºç¶­è­·ï¼Œé‡å•Ÿï¼Œå‚™ä»½
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;on-kubernetes&#34;&gt;On Kubernetes&lt;/h2&gt;
&lt;p&gt;argocd + vault helm chart&lt;/p&gt;
&lt;p&gt;server èˆ‡ injector å»ºè­°åˆ†é–‹å…©å€‹ argocd applicatoin / helm releaseç¨ç«‹deploy&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/hashicorp/vault-helm/blob/main/values.yaml#L357&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;server&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;é¸ä¸€å€‹æœƒç¶­è­·çš„&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/configuration/storage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;storage backend&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/hashicorp/vault-helm/blob/main/values.yaml#L46&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;injector&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;goto &lt;a href=&#34;https://github.com/hashicorp/vault-helm/blob/main/values.yaml#L357&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/hashicorp/vault-helm/blob/main/values.yaml#L357&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„server æ˜¯å¦ ha&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;deploy-on-kuberneteshttpsdeveloperhashicorpcomvaulttutorialskuberneteskubernetes-raft-deployment-guide&#34;&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/tutorials/kubernetes/kubernetes-raft-deployment-guide&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Deploy On Kubernetes&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;warning&#34; srcset=&#34;
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/k8s-security-warning_hu0533df8c600b6ebf5e775c57536fef00_141847_8f5dde8ddcc13e3e54037d2244da90ac.webp 400w,
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/k8s-security-warning_hu0533df8c600b6ebf5e775c57536fef00_141847_e8c6254ba1ebf4ad920e34f8d89ffe5d.webp 760w,
               /zh-hant/slides/2023-09-26-devopsday-2023-vault/k8s-security-warning_hu0533df8c600b6ebf5e775c57536fef00_141847_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://chechia.net/zh-hant/slides/2023-09-26-devopsday-2023-vault/k8s-security-warning_hu0533df8c600b6ebf5e775c57536fef00_141847_8f5dde8ddcc13e3e54037d2244da90ac.webp&#34;
               width=&#34;760&#34;
               height=&#34;229&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;secure your k8s&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;goto &lt;a href=&#34;https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubernetes.io/docs/tasks/administer-cluster/securing-a-cluster/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;FAQ: on VM or on K8s?
å•é¡Œä¸æ˜¯ vault åœ¨ VM ä¸Šå®‰å…¨ï¼Œé‚„æ˜¯åœ¨ k8s ä¸Šå®‰å…¨
è€Œæ˜¯åœ˜éšŠèƒ½ä¸èƒ½ secure åº•ä¸‹çš„ infraï¼Œå¦‚æœç†Ÿ VM å°±æœƒè¦ºå¾— VM å¥½åš
secure k8s æ˜¯ VM + k8s éƒ½è¦&lt;/p&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;å›åˆ°-outline-prod-ready&#34;&gt;å›åˆ° Outline: prod-ready&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;terraform configuration IaC
&lt;ul&gt;
&lt;li&gt;auth method / config / role&lt;/li&gt;
&lt;li&gt;secret mounts&lt;/li&gt;
&lt;li&gt;policy
&lt;ul&gt;
&lt;li&gt;team / people&lt;/li&gt;
&lt;li&gt;application / service account&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;audit log&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;vault-configuration-iac&#34;&gt;Vault Configuration IaC&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;VCS / PR reviewed&lt;/li&gt;
&lt;li&gt;well-formed / linted / no-typo&lt;/li&gt;
&lt;li&gt;multiple env: dev, stag, prod&lt;/li&gt;
&lt;li&gt;programable / reusable: æ¨™æº–åŒ–ï¼Œå¯é‡è¤‡ä½¿ç”¨çš„ code&lt;/li&gt;
&lt;li&gt;tested
&lt;ul&gt;
&lt;li&gt;å¯ä»¥ç‚º terraform code å¯«æ¸¬è©¦&lt;/li&gt;
&lt;li&gt;å¯ä»¥å¯«æ•´åˆæ¸¬è©¦è…³æœ¬æ¸¬è©¦ vault dev server&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;automation&lt;/li&gt;
&lt;li&gt;auditable&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  &lt;p&gt;version control æœ‰å¤šé‡è¦ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰ / æ²’æœ‰ review çš„ code å“è³ªï¼Œå¤©å·®åœ°é &lt;/li&gt;
&lt;li&gt;åˆ†äº«åœ˜éšŠçŸ¥è­˜ï¼Œåˆ†äº«è®Šæ›´è³‡è¨Š&lt;/li&gt;
&lt;li&gt;é¿å…æœ€é›·çš„åŒäº‹å‡ºåŒ…ï¼Œå…¨ team çš„æ•ˆèƒ½ç“¶é ¸&lt;/li&gt;
&lt;li&gt;change management å°æ–¼ vault å…§çš„çš„æ›´æ”¹è¦æœ€åš´æ ¼æ§åˆ¶
&lt;ul&gt;
&lt;li&gt;æ²’æœ‰ã€èª’æ˜¯èª°æ”¹äº†é€™å€‹æˆ‘æ€éº¼ä¸çŸ¥é“ã€é€™å›äº‹&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Linter / formated æ˜¯å·¥ä½œæ•ˆç‡çš„æ ¹æœ¬&lt;/p&gt;
&lt;p&gt;å¤šç’°å¢ƒæ¸¬è©¦&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ‰å®‰å…¨çš„æ¸¬è©¦ç’°å¢ƒï¼Œæ‰èƒ½ä¿ƒé€²åœ˜éšŠå‰µæ–°&lt;/li&gt;
&lt;li&gt;æœ‰ / æ²’æœ‰ ç¶“éå®Œæ•´ç’°å¢ƒæ¸¬è©¦çš„ release å“è³ªï¼Œå¤©å·®åœ°é &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Programable / Reusable&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;variable / for loop&lt;/li&gt;
&lt;li&gt;reusable module / don&amp;rsquo;t repeat your self&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;tested policy code&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;policy as code&lt;/li&gt;
&lt;li&gt;terratest&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;automation&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gitflow&lt;/li&gt;
&lt;li&gt;secured admin access only to workflow. developer don&amp;rsquo;t have admin access.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;auditable&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;audit in code / review&lt;/li&gt;
&lt;li&gt;live server generate audit log&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨ç¨½æ ¸&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;hashicorp-official-tutorialhttpsdeveloperhashicorpcomvaulttutorialspoliciespolicieswrite-a-policy&#34;&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/tutorials/policies/policies#write-a-policy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;hashicorp official tutorial&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tee admin-policy.hcl &amp;lt;&amp;lt;EOF
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# Read system health check
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;path &amp;#34;sys/health&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  capabilities = [&amp;#34;read&amp;#34;, &amp;#34;sudo&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# List existing policies
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;path &amp;#34;sys/policies/acl&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  capabilities = [&amp;#34;list&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;EOF
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  configure vault policy with CLI
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;hashicorp-official-tutorialhttpsdeveloperhashicorpcomvaulttutorialspoliciespolicieswrite-a-policy-1&#34;&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/tutorials/policies/policies#write-a-policy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;hashicorp official tutorial&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy write admin admin-policy.hcl
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy list
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault policy read admin
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  CLI ç®¡ç†å¾ˆä¸æ–¹ä¾¿
æ²’æœ‰ aggregated list view
æŸ¥éŒ¯æ™‚éœ€è¦è€—è²»å¤§é‡ api call åˆ—å‡º policy æŸ¥è¡¨
é€é IaC sync policy code to server
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;how-to-use&#34;&gt;How to use&lt;/h2&gt;
&lt;p&gt;prerequisites: vault, terraform, terragrunt&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone git@github.com:chechiachang/vault-playground.git
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cd vault-playground/usage/03-terraform-lives/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;terragrunt init
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;terragrunt plan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  terraform èˆ‡ terragrunt æˆ‘çš„éƒ¨è½æ ¼ä¸Šéƒ½æœ‰è¨±å¤šä»‹ç´¹æ–‡ç« ï¼Œithome éµäººè³½ä¹Ÿæœ‰ 30day workshop
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;vcs--pr-review&#34;&gt;VCS &amp;amp; PR review&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;local lint with &lt;a href=&#34;https://github.com/antonbabenko/pre-commit-terraform#terraform_fmt&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;git pre-commit hook&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;PR
&lt;ul&gt;
&lt;li&gt;lint check&lt;/li&gt;
&lt;li&gt;pipeline module test &lt;code&gt;terraform test&lt;/code&gt; on github action&lt;/li&gt;
&lt;li&gt;integration test against vault dev server&lt;/li&gt;
&lt;li&gt;review&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;merge / automation
&lt;ul&gt;
&lt;li&gt;apply to dev environment automatically&lt;/li&gt;
&lt;li&gt;release candidate tag will apply to stag automatically&lt;/li&gt;
&lt;li&gt;release tag will push to pre-production and production&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;multiple-environment&#34;&gt;Multiple environment&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;dev -&amp;gt; stag -&amp;gt; prod ç’°å¢ƒå¾ˆæ¥è¿‘
&lt;ul&gt;
&lt;li&gt;IaC + config as code&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ­è¨­æ–°ç’°å¢ƒåªéœ€1åˆ†é˜(VM)ï¼Œç”šè‡³æ•¸ç§’(container)ï¼Œå¯ä»¥é€²è¡Œå¤§é‡çš„æ¸¬è©¦&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;test&#34;&gt;Test&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;IaC code å¯ä»¥ä½¿ç”¨ &lt;code&gt;terraform test&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;config as code å¯ä»¥ä½¿ç”¨ &lt;code&gt;terraform test&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;live infrastructure å¯ä»¥ä½¿ç”¨ terratest&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;test-examplehttpsgithubcomchechiachangvault-playgroundtreemasterusage03-terraform-modulessecret_backendkv_v2&#34;&gt;Test &lt;a href=&#34;https://github.com/chechiachang/vault-playground/tree/master/usage/03-terraform-modules/secret_backend/kv_v2&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Example&lt;/a&gt;&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;resource &amp;#34;test_assertions&amp;#34; &amp;#34;main&amp;#34; {
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  component = &amp;#34;main&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  equal &amp;#34;mount_path&amp;#34; {
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    description = &amp;#34;default mount_path is ${local.mount_path}&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    got         = local.mount_path
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    want        = local.mount_path
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  equal &amp;#34;max_versions&amp;#34; {
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    description = &amp;#34;default max_versions is 10&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    got         = local.max_versions
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    want        = 10
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  equal &amp;#34;delete_version_after&amp;#34; {
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    description = &amp;#34;default delete_version_after is 10&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    got         = local.delete_version_after
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    want        = 12600
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;aside class=&#34;notes&#34;&gt;
  é€™å€‹ module åªæ˜¯ä¸€å€‹ kv engineï¼Œæ‰€ä»¥éš¨æ‰‹å¯«äº†ä¸€å€‹ç°¡å–®çš„ test
Demo æˆ‘åœ¨æœ¬åœ°éš¨æ‰‹è·‘ä¸€ä¸‹æ¸¬è©¦
ç•¶ä½ ä½¿ç”¨ terraform æ™‚é–“å¤ ä¹…ï¼Œä½¿ç”¨è¦æ¨¡è¶Šå¤§æ™‚ï¼Œæœƒæœ‰å¾©é›œçš„ moduleï¼Œé€™æ™‚æœ‰å¯«æ¸¬è©¦çš„ module å°±æ˜¯å¤©å·®åœ°é 
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;policy-as-code-for-vault&#34;&gt;Policy as code for vault&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;vault ACL æ˜¯åŸºæ–¼ path è¨­å®šæ¬Šé™&lt;/li&gt;
&lt;li&gt;ç•¶policyæœ‰æˆåƒä¸Šè¬æ¢ï¼Œå½¼æ­¤å¯èƒ½æœƒ conflict&lt;/li&gt;
&lt;li&gt;policy çš„ policy
&lt;ul&gt;
&lt;li&gt;é«˜é«˜å±¤æ¬¡çš„(å…¬å¸çš„è³‡å®‰æ”¿ç­–)é€é policy as code å®šç¾©&lt;/li&gt;
&lt;li&gt;å¯«åˆ° vault policy&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.openpolicyagent.org/docs/latest/#1-download-opa&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Open Policy Agent (OPA)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/tutorials/policies/sentinel#endpoint-governing-policies-egps&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sentinel(Vault Enterprise): EGP&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;gitflow--automation&#34;&gt;Gitflow &amp;amp; automation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;PR
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.runatlantis.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;atlantis&lt;/a&gt; run terraform plan&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;PR merged&lt;/li&gt;
&lt;li&gt;PR apply
&lt;ul&gt;
&lt;li&gt;apply to dev environment automatically with gitflow&lt;/li&gt;
&lt;li&gt;release candidate tag will apply to stag automatically&lt;/li&gt;
&lt;li&gt;release tag will push to pre-production and production&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;aside class=&#34;notes&#34;&gt;
  goto &lt;a href=&#34;https://www.runatlantis.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.runatlantis.io/&lt;/a&gt;
PR comment ä¸‹æœƒæœ‰é‡å° dev environemtn plan çš„çµæœ
ä½¿ç”¨ github webhookï¼Œå¯ä»¥ç›´æ¥åœ¨ PR approved å¾Œï¼Œå‘½ä»¤ atlantis ç›´æ¥ apply åˆ° dev server
é¿å…ä½¿ç”¨å·¥ç¨‹å¸« local machine å­˜å–é ç«¯ç’°å¢ƒï¼Œé¿å…å·¥ç¨‹å¸«å–å¾—ç®¡ç†å“¡æ¬Šé™ï¼Œé¿å…äººç‚ºæ“ä½œå¤±èª¤é€ æˆçš„ incident
&lt;/aside&gt;
&lt;hr&gt;
&lt;h2 id=&#34;summary&#34;&gt;Summary&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ IaC deploy vaultï¼Œä¸¦ä¾ç…§åœ˜éšŠéœ€æ±‚é€æ­¥èª¿æ•´ infra&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ IaC ç®¡ç† vault å…§éƒ¨ä¸€åˆ‡ config&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id=&#34;questions&#34;&gt;Questions?&lt;/h1&gt;
</description>
    </item>
    
    <item>
      <title>Deploy Kafka on Kubernetes</title>
      <link>https://chechia.net/zh-hant/slides/2019-10-18-kafka-on-k8s/</link>
      <pubDate>Fri, 18 Oct 2019 00:00:00 +0000</pubDate>
      <guid>https://chechia.net/zh-hant/slides/2019-10-18-kafka-on-k8s/</guid>
      <description>&lt;h3 id=&#34;deploy-kafka-on-kubernetes&#34;&gt;Deploy Kafka on Kubernetes&lt;/h3&gt;
&lt;p&gt;Che-Chia Chang&lt;/p&gt;
&lt;p&gt;QRCode&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;about-me&#34;&gt;About Me&lt;/h3&gt;
&lt;p&gt;David (Che-Chia) Chang&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Backend / Devops @ &lt;a href=&#34;https://machix.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;MachiX&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.meetup.com/golang-taipei-meetup/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Golang Taipei Meetup&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://ithelp.ithome.com.tw/users/20120327/ironman/2444&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;2020 Ithelp Ironman Challenge&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://t.me/chechiachang&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://t.me/chechiachang&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;outline&#34;&gt;Outline&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Introduction to Kafka&lt;/li&gt;
&lt;li&gt;Deploy Kafka with Helm&lt;/li&gt;
&lt;li&gt;Kafka Topology&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://ithelp.ithome.com.tw/articles/10219040&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ithelp Ironman 30 days Challenge (7th-12nd day)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;introduction&#34;&gt;Introduction&lt;/h3&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kafka.apache.org/images/logo.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable width=&#34;70%&#34; height=&#34;70%&#34; /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;p&gt;&lt;a href=&#34;https://kafka.apache.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kafka.apache.org/&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;distributed-streaming-platform&#34;&gt;Distributed streaming platform&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Publish &amp;amp; Subscribe: r/w data like messaging system&lt;/li&gt;
&lt;li&gt;Store data in distributed, replicated, fault-tolerant cluster&lt;/li&gt;
&lt;li&gt;Scalable&lt;/li&gt;
&lt;li&gt;Realtime&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;concepts&#34;&gt;Concepts&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Kafka run as a cluster&lt;/li&gt;
&lt;li&gt;Kafka cluster stores streams of &lt;strong&gt;records&lt;/strong&gt; in categories called &lt;strong&gt;topics&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;record = (key, value, timestamp)&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;kafka-diagram&#34;&gt;Kafka Diagram&lt;/h3&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kafka.apache.org/23/images/kafka-apis.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable width=&#34;70%&#34; height=&#34;70%&#34; /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h3 id=&#34;topic-partitions&#34;&gt;Topic Partitions&lt;/h3&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kafka.apache.org/23/images/log_anatomy.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable width=&#34;70%&#34; height=&#34;70%&#34; /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h3 id=&#34;topic-partitions-1&#34;&gt;Topic Partitions&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Data categorized by topic&lt;/li&gt;
&lt;li&gt;Data replicated in partitions&lt;/li&gt;
&lt;li&gt;Durability
&lt;ul&gt;
&lt;li&gt;consumer able to r/w complete data from at least 1 partition&lt;/li&gt;
&lt;li&gt;in order&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;distributed-data-streaming&#34;&gt;Distributed Data Streaming&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Scalible r/w bandwith&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Data Durability&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Consistency&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Availability&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Partition Tolerance&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;multi-consumer&#34;&gt;Multi Consumer&lt;/h3&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kafka.apache.org/23/images/log_consumer.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable width=&#34;70%&#34; height=&#34;70%&#34; /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h3 id=&#34;consumer-group&#34;&gt;Consumer Group&lt;/h3&gt;


















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img src=&#34;https://kafka.apache.org/23/images/consumer-groups.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34; data-zoomable width=&#34;70%&#34; height=&#34;70%&#34; /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;

&lt;hr&gt;
&lt;h3 id=&#34;consumer-group-1&#34;&gt;Consumer Group&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Partition deliver record to one consumer within each subscribing consumer group&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;deployment&#34;&gt;Deployment&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/helm/charts/tree/master/incubator/kafka&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Helm Kafka&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;deployment-1&#34;&gt;Deployment&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/chechiachang/kafka-on-kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/chechiachang/kafka-on-kubernetes&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat install.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#!/bin/bash&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# https://github.com/helm/charts/tree/master/incubator/kafka&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;HELM_NAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;kafka-1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo add incubator http://storage.googleapis.com/kubernetes-charts-incubator
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm upgrade --install &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;HELM_NAME&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; incubator/kafka --version 0.16.2 -f values-staging.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Check values-staging.yaml before deployment&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;helm-chart-values&#34;&gt;Helm Chart Values&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat values-staging.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# ------------------------------------------------------------------------------
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# Kafka:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# ------------------------------------------------------------------------------
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## The StatefulSet installs 3 pods by default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;replicas: 3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## The kafka image repository
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;image: &amp;#34;confluentinc/cp-kafka&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## The kafka image tag
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;imageTag: &amp;#34;5.0.1&amp;#34;  # Confluent image for Kafka 2.0.0
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## Specify a imagePullPolicy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## ref: http://kubernetes.io/docs/user-guide/images/#pre-pulling-images
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;imagePullPolicy: &amp;#34;IfNotPresent&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## Configure resource requests and limits
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## ref: http://kubernetes.io/docs/user-guide/compute-resources/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;resources: {}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # limits:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  #   cpu: 200m
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  #   memory: 1536Mi
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # requests:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  #   cpu: 100m
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  #   memory: 1024Mi
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kafkaHeapOptions: &amp;#34;-Xmx4G -Xms1G&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## The StatefulSet Update Strategy which Kafka will use when changes are applied.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## ref: https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/#update-strategies
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;updateStrategy:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  type: &amp;#34;OnDelete&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## Start and stop pods in Parallel or OrderedReady (one-by-one.)  Note - Can not change after first release.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## ref: https://kubernetes.io/docs/tutorials/stateful-application/basic-stateful-set/#pod-management-policy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;podManagementPolicy: OrderedReady
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## If RBAC is enabled on the cluster, the Kafka init container needs a service account
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## with permissisions sufficient to apply pod labels
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rbac:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  enabled: false
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;affinity:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   podAntiAffinity:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     requiredDuringSchedulingIgnoredDuringExecution:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     - labelSelector:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         matchExpressions:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         - key: app
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           operator: In
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           values:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           - kafka
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       topologyKey: &amp;#34;kubernetes.io/hostname&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   podAffinity:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     preferredDuringSchedulingIgnoredDuringExecution:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      - weight: 50
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        podAffinityTerm:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          labelSelector:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            matchExpressions:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            - key: app
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;              operator: In
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;              values:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                - zookeeper
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          topologyKey: &amp;#34;kubernetes.io/hostname&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## Configuration Overrides. Specify any Kafka settings you would like set on the StatefulSet
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## here in map format, as defined in the official docs.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## ref: https://kafka.apache.org/documentation/#brokerconfigs
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;##
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;configurationOverrides:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;default.replication.factor&amp;#34;: 3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;offsets.topic.replication.factor&amp;#34;: 1 # Increased from 1 to 2 for higher output
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # &amp;#34;offsets.topic.num.partitions&amp;#34;: 3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;confluent.support.metrics.enable&amp;#34;: false  # Disables confluent metric submission
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # &amp;#34;auto.leader.rebalance.enable&amp;#34;: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # &amp;#34;auto.create.topics.enable&amp;#34;: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # &amp;#34;controlled.shutdown.enable&amp;#34;: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # &amp;#34;controlled.shutdown.max.retries&amp;#34;: 100
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;message.max.bytes&amp;#34;: &amp;#34;16000000&amp;#34; # Extend global topic max message bytes to 16 Mb
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## Persistence configuration. Specify if and how to persist data to a persistent volume.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;##
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;persistence:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  enabled: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;## Prometheus Exporters / Metrics
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;##
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;prometheus:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  ## Prometheus JMX Exporter: exposes the majority of Kafkas metrics
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  jmx:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    enabled: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  ## Prometheus Kafka Exporter: exposes complimentary metrics to JMX Exporter
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  kafka:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    enabled: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;topics: []
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# ------------------------------------------------------------------------------
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# Zookeeper:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;# ------------------------------------------------------------------------------
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;zookeeper:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  ## If true, install the Zookeeper chart alongside Kafka
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  ## ref: https://github.com/kubernetes/charts/tree/master/incubator/zookeeper
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  enabled: true
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;kubernetes-configurations&#34;&gt;Kubernetes Configurations&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;replicas&lt;/li&gt;
&lt;li&gt;resource&lt;/li&gt;
&lt;li&gt;pod affinity&lt;/li&gt;
&lt;li&gt;persistence&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;kafka-configurations&#34;&gt;Kafka Configurations&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;zookeeper&lt;/li&gt;
&lt;li&gt;configurationOverrides&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;default.replication.factor&amp;#34;: 3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;offsets.topic.replication.factor&amp;#34;: 1 # Increased from 1 to 2 for higher output
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # &amp;#34;offsets.topic.num.partitions&amp;#34;: 3
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # &amp;#34;auto.leader.rebalance.enable&amp;#34;: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  # &amp;#34;auto.create.topics.enable&amp;#34;: true
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &amp;#34;message.max.bytes&amp;#34;: &amp;#34;16000000&amp;#34; # Extend global topic max message bytes to 16 Mb
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;monitoring-configurations&#34;&gt;Monitoring Configurations&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;prometheus exporter&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;monitoring is the key to production&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;deploy-after-understande-configs&#34;&gt;Deploy after Understande Configs&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;All Kafka garantees are based on a correctly configured cluster&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Incorrect configs will cause cluster unstable and data loss&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Now we can deploy :)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;pods&#34;&gt;Pods&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get po | grep kafka
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                                                     READY   STATUS      RESTARTS   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kafka-1-0                                                1/1     Running     0          224d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kafka-1-1                                                1/1     Running     0          224d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kafka-1-2                                                1/1     Running     0          224d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kafka-1-exporter-88786d84b-z954z                         1/1     Running     0          224d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kafka-1-zookeeper-0                                      1/1     Running     0          224d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kafka-1-zookeeper-1                                      1/1     Running     0          224d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kafka-1-zookeeper-2                                      1/1     Running     0          224d
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h3 id=&#34;availability&#34;&gt;Availability&lt;/h3&gt;
&lt;p&gt;ex. replication factor=3&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;3 partitions, each 1 in a kafka-broker&lt;/li&gt;
&lt;li&gt;1 master partition 2 slave partitions (readonly)&lt;/li&gt;
&lt;li&gt;data &lt;strong&gt;sync&lt;/strong&gt; from master to slave&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;availability-1&#34;&gt;Availability&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;kafka keep a number of slave in-synced
&lt;ul&gt;
&lt;li&gt;too many in-sync -&amp;gt; slow down write confirm&lt;/li&gt;
&lt;li&gt;not enough will -&amp;gt; data loss&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;on-slave-failure&#34;&gt;On slave failure&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;client not affected&lt;/li&gt;
&lt;li&gt;keep enough in-sync slaves&lt;/li&gt;
&lt;li&gt;wait dead slave to back online&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;on-master-failure&#34;&gt;On master failure&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;slave select new master within in-synced slaves&lt;/li&gt;
&lt;li&gt;new master sync to slaves&lt;/li&gt;
&lt;li&gt;new master serve clients&lt;/li&gt;
&lt;li&gt;wait dead master to back online and become slave&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;configs-availability&#34;&gt;Configs Availability&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Metadata are stored in zookeeper
&lt;ul&gt;
&lt;li&gt;topic configs&lt;/li&gt;
&lt;li&gt;partition configs&lt;/li&gt;
&lt;li&gt;consumer offsets&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;é‡é»&#34;&gt;é‡é»&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;è¦ä»”ç´°çœ‹å®Œ helm chart values çš„è¨­å®šï¼Œè¨­éŒ¯å°±å¹¹æ‰é‡ä¾†&lt;/li&gt;
&lt;li&gt;kafka çš„æ¦‚å¿µèˆ‡è¨­å®šï¼Œè¦èŠ±æ™‚é–“ç ”ç©¶æ¸…æ¥š&lt;/li&gt;
&lt;li&gt;resource &amp;amp; JVM heap size&lt;/li&gt;
&lt;li&gt;prometheus is a must&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ithelp-ironman-challenge&#34;&gt;Ithelp Ironman Challenge&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;30 å¤©å…§å®¹éƒ½æ˜¯ step-by-step&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…§å®¹åªæ˜¯ä»”ç´°çœ‹å®˜æ–¹æ–‡ä»¶&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;challenge -&amp;gt; è‡ªæˆ‘æˆé•·&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;çµ¦è¼¸åœ¨èµ·è·‘é»çš„äºº&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;thank-you&#34;&gt;Thank you&lt;/h3&gt;
</description>
    </item>
    
  </channel>
</rss>
