<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Aws Cross Account Delegation & pre-commit hook | Che-Chia Chang</title><meta name=keywords content="terraform,iac,aws,鐵人賽2022"><meta name=description content="Article description."><meta name=author content="chechiachang"><link rel=canonical href=https://chechia.net/posts/2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook/><meta name=google-site-verification content="G-QYR8JCDGM9"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://chechia.net/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://chechia.net/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://chechia.net/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://chechia.net/favicon/favicon-32x32.png><link rel=mask-icon href=https://chechia.net/favicon/favicon-32x32.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://chechia.net/posts/2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://chechia.net/posts/2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook/"><meta property="og:site_name" content="Che-Chia Chang"><meta property="og:title" content="Aws Cross Account Delegation & pre-commit hook"><meta property="og:description" content="Article description."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-21T22:55:41+08:00"><meta property="article:modified_time" content="2022-09-21T22:55:41+08:00"><meta property="article:tag" content="Terraform"><meta property="article:tag" content="Iac"><meta property="article:tag" content="Aws"><meta property="article:tag" content="鐵人賽2022"><meta property="og:image" content="https://chechia.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://chechia.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Aws Cross Account Delegation & pre-commit hook"><meta name=twitter:description content="Article description."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://chechia.net/posts/"},{"@type":"ListItem","position":2,"name":"Aws Cross Account Delegation \u0026 pre-commit hook","item":"https://chechia.net/posts/2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Aws Cross Account Delegation \u0026 pre-commit hook","name":"Aws Cross Account Delegation \u0026 pre-commit hook","description":"Article description.","keywords":["terraform","iac","aws","鐵人賽2022"],"articleBody":"TODO 與進度 root 中設定 IAM User aws cross account iam role delegation root account MFA policy (Optional) Cloudtrail (Optional) terraform aws config security 中設定 IAM User security 設定 password policy security 設定 MFA policy security 中設定 IAM Policy \u0026 Group dev 中設定 IAM role 允許 security assume dev IAM role iThome 鐵人賽好讀版\n賽後文章會整理放到個人的部落格上 http://chechia.net/\n追蹤粉專可以收到文章的主動推播\nAWS cross account with iam roles 要做跨 AWS account 的 IAM Roles access control，我們先看官方文件理解這個功能\nhttps://docs.aws.amazon.com/IAM/latest/UserGuide/tutorial_cross-account-with-roles.html\n回憶我們在 day-04 提到的 multi-accounts 架構\naccount/security 有所有 iam-users 其他 child-account ex. account/test 中會有 iam-roles 需求：security/iam-user 可以使用 test/iam-role 的身份，存取 test 底下的 resource ex.test/ec2 好處 admin 不需要到每一個 child-account 下面去開每一個人的 iam user，統一到 account/security 管理 user 只要登入一個 security 帳號，就可以控制多個 child-account，不用登出又登入不同 account 在 aws official doc 上，也是舉幾個 account 作為 cross account delegation 的範例。由於本 workshop 已經有現存的 child-account，我們會直接使用 workshop 的 accounts 做說明。完成這次 iam role delegation 的設定後，我們會得到以下成果\naccount/security 下面 IAM User 可以 assume 到 account/test 下面的特定的 IAM role account/test 下面有一個 IAM role 可以存取 S3 Bucket 工程師可以使用 web console 登入 security/user，然後 assume role 為 test/role，取得查看 s3 bucket 的權限 工程師也可使用以 security/user 的身份， call aws API 取得 test/role 的暫時的 credential 步驟 我們會先過一次 aws 官方文件上所述的步驟，讓大家了解整個設定步驟，弄清整個 delegation 的流程與概念。之後會轉而使用 Terraform 設定所有的元件。\n首先要在 test (child-account) 設定 iam role 將 account/security 作為 trusted entity 設定 role 的 policy，增加可以存取 s3 bucket 的權限給 test/role 調整 iam role，可以設定需要給予權限，或是 deny 某些權限 最後做測試，是否可以完成 switch role AWS 的範例使用 aws web console 做範例，這個 workshop 後面我們會使用 terraform 來實作。\n外出取材 上面的範例還在 WIP，請當作者外出取材一天，今天先講另外一個工具\nTerraform fmt \u0026 lint 要提升 terraform code 品質，有許多工具非常值得在 CI/CD 過程中使用\n例如 terraform 內建的 fmt 與 terragrunt 內建的 hclfmt\n在 module 的 repository 中會需要跑 terraform fmt，確保每個 module release 出去前都有經過 fmt 在使用 terragrunt 的 root module 會需要 hclfmt .hcl 檔案 cd terragrunt-infrastructure-modules terraform fmt -recursive cd terragrunt-infrastructure-live-example terragrunt hclfmt fmt 對於程式碼的品質是基礎但十分重要的\n沒有固定 format 的程式碼會造成 git 使用出現過多 diff，造成團隊協作的困難 format 也會影響自動化，例如 templating / variable expension fmt / lint 是我們第一個帶入 CI/CD 的工具\n手動 fmt fmt 一下\ncd terragrunt-infrastructure-modules terraform fmt -recursive cd terragrunt-infrastructure-live-example terragrunt hclfmt commit 如下\nterragrunt-infrastructure-modules commit terragrunt-infrastructure-live-example Git precommit hook 既然是 code 品質的基礎，應該每次 commit 之前都觸發檢查，這個階段適合使用 git pre-commit hook 前執行\nhttps://github.com/antonbabenko/pre-commit-terraform\n以 terragrunt-infrastructure-live-example 為例\nPR 在此 啟用前需要 install remote script 到本地 git add 後，使用 run 來手動觸發 pre-commit hook 會根據 commit hook 執行腳本，以這邊的範例會執行 id: terraform-fmt id: terraform-validate id: tflint id: terraform_checkov id: terrascan id: terraform_tfsec id: infracost_breakdown 除了 fmt 有說明過以外，其他的 tool 我們後續再說明 pre-commit install pre-commit install pre-commit installed at .git/hooks/pre-commit pre-commit run 如果通過 run 測試，就可以進行 git commit commit 之前會在跑一次 script，所以稱作 pre-commit hook 如果通過測試變化自動 commit 如果沒有通過，則退回這次 commit 如果想要跳過 pre-commit check，可以使用 git commit –no-verify 通過上述步驟，來確保工程師在本地發出的 commit 有經過基礎的驗證，非常值得團隊導入\nGithub Action ","wordCount":"390","inLanguage":"en","image":"https://chechia.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2022-09-21T22:55:41+08:00","dateModified":"2022-09-21T22:55:41+08:00","author":{"@type":"Person","name":"chechiachang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://chechia.net/posts/2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook/"},"publisher":{"@type":"Organization","name":"Che-Chia Chang","logo":{"@type":"ImageObject","url":"https://chechia.net/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://chechia.net/ accesskey=h title="Home (Alt + H)"><img src=https://chechia.net/favicon/favicon-32x32.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://chechia.net/#posts title=Posts><span>Posts</span></a></li><li><a href=https://mvp.microsoft.com/zh-TW/mvp/profile/e407d0b9-5c01-eb11-a815-000d3a8ccaf5 title=MVP><span>MVP</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://chechia.net/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://chechia.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://chechia.net/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://chechia.net/>Home</a>&nbsp;»&nbsp;<a href=https://chechia.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Aws Cross Account Delegation & pre-commit hook</h1><div class=post-description>Article description.</div><div class=post-meta><span title='2022-09-21 22:55:41 +0800 CST'>September 21, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;390 words&nbsp;·&nbsp;chechiachang&nbsp;|&nbsp;<a href=https://github.com/chechiachang.github.io-src/content/posts/2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#todo-與進度>TODO 與進度</a></li><li><a href=#aws-cross-account-with-iam-roles>AWS cross account with iam roles</a></li><li><a href=#步驟>步驟</a></li><li><a href=#外出取材>外出取材</a></li><li><a href=#terraform-fmt--lint>Terraform fmt & lint</a></li><li><a href=#手動-fmt>手動 fmt</a></li><li><a href=#git-precommit-hook>Git precommit hook</a></li><li><a href=#github-action>Github Action</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h3 id=todo-與進度>TODO 與進度<a hidden class=anchor aria-hidden=true href=#todo-與進度>#</a></h3><ul><li><input checked disabled type=checkbox> root 中設定 IAM User<ul><li><input disabled type=checkbox> aws cross account iam role delegation</li><li><input disabled type=checkbox> root account MFA policy</li><li><input disabled type=checkbox> (Optional) Cloudtrail</li><li><input disabled type=checkbox> (Optional) terraform aws config</li></ul></li><li><input disabled type=checkbox> security 中設定 IAM User<ul><li><input disabled type=checkbox> security 設定 password policy</li><li><input disabled type=checkbox> security 設定 MFA policy</li></ul></li><li><input disabled type=checkbox> security 中設定 IAM Policy & Group</li><li><input disabled type=checkbox> dev 中設定 IAM role</li><li><input disabled type=checkbox> 允許 security assume dev IAM role</li></ul><p><a href=https://ithelp.ithome.com.tw/articles/10290931>iThome 鐵人賽好讀版</a></p><p><a href=http://chechia.net/>賽後文章會整理放到個人的部落格上 http://chechia.net/</a></p><p><a href=https://www.facebook.com/engineer.from.scratch>追蹤粉專可以收到文章的主動推播</a></p><p><img alt=https://ithelp.ithome.com.tw/upload/images/20210901/20120327NvpHVr2QC0.jpg loading=lazy src=https://ithelp.ithome.com.tw/upload/images/20210901/20120327NvpHVr2QC0.jpg></p><h3 id=aws-cross-account-with-iam-roles>AWS cross account with iam roles<a hidden class=anchor aria-hidden=true href=#aws-cross-account-with-iam-roles>#</a></h3><p>要做跨 AWS account 的 IAM Roles access control，我們先看官方文件理解這個功能</p><p><a href=https://docs.aws.amazon.com/IAM/latest/UserGuide/tutorial_cross-account-with-roles.html>https://docs.aws.amazon.com/IAM/latest/UserGuide/tutorial_cross-account-with-roles.html</a></p><p>回憶我們在 day-04 提到的 multi-accounts 架構</p><ul><li>account/security 有所有 iam-users</li><li>其他 child-account ex. account/test 中會有 iam-roles</li><li>需求：security/iam-user 可以使用 test/iam-role 的身份，存取 test 底下的 resource ex.test/ec2</li><li>好處<ul><li>admin 不需要到每一個 child-account 下面去開每一個人的 iam user，統一到 account/security 管理</li><li>user 只要登入一個 security 帳號，就可以控制多個 child-account，不用登出又登入不同 account</li></ul></li></ul><p>在 aws official doc 上，也是舉幾個 account 作為 cross account delegation 的範例。由於本 workshop 已經有現存的 child-account，我們會直接使用 workshop 的 accounts 做說明。完成這次 iam role delegation 的設定後，我們會得到以下成果</p><ul><li>account/security 下面 IAM User 可以 assume 到 account/test 下面的特定的 IAM role</li><li>account/test 下面有一個 IAM role 可以存取 S3 Bucket</li><li>工程師可以使用 web console 登入 security/user，然後 assume role 為 test/role，取得查看 s3 bucket 的權限</li><li>工程師也可使用以 security/user 的身份， call aws API 取得 test/role 的暫時的 credential</li></ul><h3 id=步驟>步驟<a hidden class=anchor aria-hidden=true href=#步驟>#</a></h3><p>我們會先過一次 aws 官方文件上所述的步驟，讓大家了解整個設定步驟，弄清整個 delegation 的流程與概念。之後會轉而使用 Terraform 設定所有的元件。</p><ul><li>首先要在 test (child-account) 設定 iam role<ul><li>將 account/security 作為 trusted entity</li><li>設定 role 的 policy，增加可以存取 s3 bucket 的權限給 test/role</li></ul></li><li>調整 iam role，可以設定需要給予權限，或是 deny 某些權限</li><li>最後做測試，是否可以完成 switch role</li></ul><p>AWS 的範例使用 aws web console 做範例，這個 workshop 後面我們會使用 terraform 來實作。</p><h3 id=外出取材>外出取材<a hidden class=anchor aria-hidden=true href=#外出取材>#</a></h3><p>上面的範例還在 WIP，請當作者外出取材一天，今天先講另外一個工具</p><hr><h3 id=terraform-fmt--lint>Terraform fmt & lint<a hidden class=anchor aria-hidden=true href=#terraform-fmt--lint>#</a></h3><p>要提升 terraform code 品質，有許多工具非常值得在 CI/CD 過程中使用</p><p>例如 terraform 內建的 fmt 與 terragrunt 內建的 hclfmt</p><ul><li>在 module 的 repository 中會需要跑 terraform fmt，確保每個 module release 出去前都有經過 fmt</li><li>在使用 terragrunt 的 root module 會需要 hclfmt .hcl 檔案</li></ul><pre><code>cd terragrunt-infrastructure-modules
terraform fmt -recursive

cd terragrunt-infrastructure-live-example
terragrunt hclfmt
</code></pre><p>fmt 對於程式碼的品質是基礎但十分重要的</p><ul><li>沒有固定 format 的程式碼會造成 git 使用出現過多 diff，造成團隊協作的困難</li><li>format 也會影響自動化，例如 templating / variable expension</li></ul><p>fmt / lint 是我們第一個帶入 CI/CD 的工具</p><h3 id=手動-fmt>手動 fmt<a hidden class=anchor aria-hidden=true href=#手動-fmt>#</a></h3><p>fmt 一下</p><pre><code>cd terragrunt-infrastructure-modules
terraform fmt -recursive

cd terragrunt-infrastructure-live-example
terragrunt hclfmt
</code></pre><p>commit 如下</p><ul><li><a href=https://github.com/chechiachang/terragrunt-infrastructure-modules/commit/cab9fe72bafe8fa238ba04a17b7a60858ca2d27c>terragrunt-infrastructure-modules commit</a></li><li><a href=https://github.com/chechiachang/terragrunt-infrastructure-live-example/commit/1810e1a28558937058e21feafa4a8c9d2c82fab3>terragrunt-infrastructure-live-example</a></li></ul><h3 id=git-precommit-hook>Git precommit hook<a hidden class=anchor aria-hidden=true href=#git-precommit-hook>#</a></h3><p>既然是 code 品質的基礎，應該每次 commit 之前都觸發檢查，這個階段適合使用 git pre-commit hook 前執行</p><p><a href=https://github.com/antonbabenko/pre-commit-terraform>https://github.com/antonbabenko/pre-commit-terraform</a></p><p>以 terragrunt-infrastructure-live-example 為例</p><ul><li><a href=https://github.com/chechiachang/terragrunt-infrastructure-modules/pull/5>PR 在此</a></li><li>啟用前需要 install remote script 到本地</li><li>git add 後，使用 run 來手動觸發 pre-commit hook<ul><li>會根據 commit hook 執行腳本，以這邊的範例會執行<ul><li>id: terraform-fmt</li><li>id: terraform-validate</li><li>id: tflint</li><li>id: terraform_checkov</li><li>id: terrascan</li><li>id: terraform_tfsec</li><li>id: infracost_breakdown</li></ul></li><li>除了 fmt 有說明過以外，其他的 tool 我們後續再說明</li></ul></li></ul><pre><code>pre-commit install

pre-commit install
pre-commit installed at .git/hooks/pre-commit

pre-commit run
</code></pre><ul><li>如果通過 run 測試，就可以進行 git commit<ul><li>commit 之前會在跑一次 script，所以稱作 pre-commit hook</li><li>如果通過測試變化自動 commit</li><li>如果沒有通過，則退回這次 commit</li><li>如果想要跳過 pre-commit check，可以使用 git commit &ndash;no-verify</li></ul></li></ul><p>通過上述步驟，來確保工程師在本地發出的 commit 有經過基礎的驗證，非常值得團隊導入</p><hr><h3 id=github-action>Github Action<a hidden class=anchor aria-hidden=true href=#github-action>#</a></h3></div><footer class=post-footer><ul class=post-tags><li><a href=https://chechia.net/tags/terraform/>Terraform</a></li><li><a href=https://chechia.net/tags/iac/>Iac</a></li><li><a href=https://chechia.net/tags/aws/>Aws</a></li><li><a href=https://chechia.net/tags/%E9%90%B5%E4%BA%BA%E8%B3%BD2022/>鐵人賽2022</a></li></ul><nav class=paginav><a class=prev href=https://chechia.net/posts/2022-09-25-14th-ithome-ironman-iac-aws-workshop-11-aws-github-action-ci-cd/><span class=title>« Prev</span><br><span>Terraform Github Action CI/CD</span>
</a><a class=next href=https://chechia.net/posts/2022-09-20-14th-ithome-ironman-iac-aws-workshop-09-terraform-module-and-password-security/><span class=title>Next »</span><br><span>Modules and password security</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Aws Cross Account Delegation & pre-commit hook on x" href="https://x.com/intent/tweet/?text=Aws%20Cross%20Account%20Delegation%20%26%20pre-commit%20hook&amp;url=https%3a%2f%2fchechia.net%2fposts%2f2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook%2f&amp;hashtags=terraform%2ciac%2caws%2c%e9%90%b5%e4%ba%ba%e8%b3%bd2022"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Aws Cross Account Delegation & pre-commit hook on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fchechia.net%2fposts%2f2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook%2f&amp;title=Aws%20Cross%20Account%20Delegation%20%26%20pre-commit%20hook&amp;summary=Aws%20Cross%20Account%20Delegation%20%26%20pre-commit%20hook&amp;source=https%3a%2f%2fchechia.net%2fposts%2f2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Aws Cross Account Delegation & pre-commit hook on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fchechia.net%2fposts%2f2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook%2f&title=Aws%20Cross%20Account%20Delegation%20%26%20pre-commit%20hook"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Aws Cross Account Delegation & pre-commit hook on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fchechia.net%2fposts%2f2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Aws Cross Account Delegation & pre-commit hook on whatsapp" href="https://api.whatsapp.com/send?text=Aws%20Cross%20Account%20Delegation%20%26%20pre-commit%20hook%20-%20https%3a%2f%2fchechia.net%2fposts%2f2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Aws Cross Account Delegation & pre-commit hook on telegram" href="https://telegram.me/share/url?text=Aws%20Cross%20Account%20Delegation%20%26%20pre-commit%20hook&amp;url=https%3a%2f%2fchechia.net%2fposts%2f2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Aws Cross Account Delegation & pre-commit hook on ycombinator" href="https://news.ycombinator.com/submitlink?t=Aws%20Cross%20Account%20Delegation%20%26%20pre-commit%20hook&u=https%3a%2f%2fchechia.net%2fposts%2f2022-09-21-14th-ithome-ironman-iac-aws-workshop-10-aws-cross-account-delegation-and-pre-commit-hook%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://chechia.net/>Che-Chia Chang</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>