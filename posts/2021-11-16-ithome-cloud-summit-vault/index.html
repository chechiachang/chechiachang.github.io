<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>2021 11 16 Ithome Cloud Summit Vault | Che-Chia Chang</title><meta name=keywords content="kubernetes,vault,terraform"><meta name=description content="各位好
關於這個 QRcode
每次上台前，我都會想要帶什麼樣的內容給觀眾，讓觀眾值得花 30 分鐘在底下聽。後來就習慣先發表一篇文章，把對觀眾有幫助的資源包成一包：

首先是完整投影片：https://slides.com/chechiac&mldr;/terraform-introduction-a56697
逐字講稿：(最後校稿中）
然而只有本次演講內容，回去可能還是不太容易操作。所以這次附上使用 Terraform 一鍵部署 vault 的 Github Repository：https://github.com/&mldr;/southe&mldr;/chechia_net/vault/singleton
如果不熟 Terraform，再附上 30 天手把手 Terraform 教學文章，只要願意花時間，全篇中文一個月帶你上手 Terraform。

IThome 鐵人賽好讀版：https://ithelp.ithome.com.tw/users/20120327/ironman/4057
Github Repository 完整版：https://github.com/&mldr;/terraform-30&mldr;/tree/main/lecture/zh


如果遇到問題還是需要找人發問，所以再推薦兩個社群，可以來這邊發問，要找我本人也找得到。甚至只是加入潛水不講話，都可以被動吸收許多新知。

Cloud Native Taiwan User Group

https://t.me/cntug
https://fb.cloudnative.tw


DevOps Taiwan Meetup Group

https://t.me/devopstw





大家可以手機拍完這個就出去吃午餐了。
或是拍回家，然後傳給一個同事叫他花 30 天把 Terraform 跟 Vault 這些都學會。
總之希望對各位有幫助，讓國內技術力能持續進步成長。

回到本次演講。
本次演講有三個關鍵字

Kubernetes
Vault
Terraform 這個是隱藏的

請問平時工作會用到這三個技術之一的朋友，請舉個手，好讓我知道一下觀眾的分布，等等分享的內容會照比例做一些調整。
我們今天不會講太多 Kubernetes 的內容，重點放在 Vault，以及如何設定 Vault，所以 Terraform Infrastructure as Code 或是 configuration as Code 會在這邊跑出來。"><meta name=author content="chechiachang"><link rel=canonical href=https://chechia.net/posts/2021-11-16-ithome-cloud-summit-vault/><meta name=google-site-verification content="G-QYR8JCDGM9"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://chechia.net/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://chechia.net/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://chechia.net/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://chechia.net/favicon/favicon-32x32.png><link rel=mask-icon href=https://chechia.net/favicon/favicon-32x32.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://chechia.net/posts/2021-11-16-ithome-cloud-summit-vault/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYR8JCDGM9"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-QYR8JCDGM9")}</script><meta property="og:url" content="https://chechia.net/posts/2021-11-16-ithome-cloud-summit-vault/"><meta property="og:site_name" content="Che-Chia Chang"><meta property="og:title" content="2021 11 16 Ithome Cloud Summit Vault"><meta property="og:description" content="各位好
關於這個 QRcode
每次上台前，我都會想要帶什麼樣的內容給觀眾，讓觀眾值得花 30 分鐘在底下聽。後來就習慣先發表一篇文章，把對觀眾有幫助的資源包成一包：
首先是完整投影片：https://slides.com/chechiac…/terraform-introduction-a56697 逐字講稿：(最後校稿中） 然而只有本次演講內容，回去可能還是不太容易操作。所以這次附上使用 Terraform 一鍵部署 vault 的 Github Repository：https://github.com/…/southe…/chechia_net/vault/singleton 如果不熟 Terraform，再附上 30 天手把手 Terraform 教學文章，只要願意花時間，全篇中文一個月帶你上手 Terraform。 IThome 鐵人賽好讀版：https://ithelp.ithome.com.tw/users/20120327/ironman/4057 Github Repository 完整版：https://github.com/…/terraform-30…/tree/main/lecture/zh 如果遇到問題還是需要找人發問，所以再推薦兩個社群，可以來這邊發問，要找我本人也找得到。甚至只是加入潛水不講話，都可以被動吸收許多新知。 Cloud Native Taiwan User Group https://t.me/cntug https://fb.cloudnative.tw DevOps Taiwan Meetup Group https://t.me/devopstw 大家可以手機拍完這個就出去吃午餐了。 或是拍回家，然後傳給一個同事叫他花 30 天把 Terraform 跟 Vault 這些都學會。
總之希望對各位有幫助，讓國內技術力能持續進步成長。
回到本次演講。
本次演講有三個關鍵字
Kubernetes Vault Terraform 這個是隱藏的 請問平時工作會用到這三個技術之一的朋友，請舉個手，好讓我知道一下觀眾的分布，等等分享的內容會照比例做一些調整。
我們今天不會講太多 Kubernetes 的內容，重點放在 Vault，以及如何設定 Vault，所以 Terraform Infrastructure as Code 或是 configuration as Code 會在這邊跑出來。"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-16T01:04:12+08:00"><meta property="article:modified_time" content="2021-11-16T01:04:12+08:00"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="Vault"><meta property="article:tag" content="Terraform"><meta property="og:image" content="https://chechia.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://chechia.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="2021 11 16 Ithome Cloud Summit Vault"><meta name=twitter:description content="各位好
關於這個 QRcode
每次上台前，我都會想要帶什麼樣的內容給觀眾，讓觀眾值得花 30 分鐘在底下聽。後來就習慣先發表一篇文章，把對觀眾有幫助的資源包成一包：

首先是完整投影片：https://slides.com/chechiac&mldr;/terraform-introduction-a56697
逐字講稿：(最後校稿中）
然而只有本次演講內容，回去可能還是不太容易操作。所以這次附上使用 Terraform 一鍵部署 vault 的 Github Repository：https://github.com/&mldr;/southe&mldr;/chechia_net/vault/singleton
如果不熟 Terraform，再附上 30 天手把手 Terraform 教學文章，只要願意花時間，全篇中文一個月帶你上手 Terraform。

IThome 鐵人賽好讀版：https://ithelp.ithome.com.tw/users/20120327/ironman/4057
Github Repository 完整版：https://github.com/&mldr;/terraform-30&mldr;/tree/main/lecture/zh


如果遇到問題還是需要找人發問，所以再推薦兩個社群，可以來這邊發問，要找我本人也找得到。甚至只是加入潛水不講話，都可以被動吸收許多新知。

Cloud Native Taiwan User Group

https://t.me/cntug
https://fb.cloudnative.tw


DevOps Taiwan Meetup Group

https://t.me/devopstw





大家可以手機拍完這個就出去吃午餐了。
或是拍回家，然後傳給一個同事叫他花 30 天把 Terraform 跟 Vault 這些都學會。
總之希望對各位有幫助，讓國內技術力能持續進步成長。

回到本次演講。
本次演講有三個關鍵字

Kubernetes
Vault
Terraform 這個是隱藏的

請問平時工作會用到這三個技術之一的朋友，請舉個手，好讓我知道一下觀眾的分布，等等分享的內容會照比例做一些調整。
我們今天不會講太多 Kubernetes 的內容，重點放在 Vault，以及如何設定 Vault，所以 Terraform Infrastructure as Code 或是 configuration as Code 會在這邊跑出來。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://chechia.net/posts/"},{"@type":"ListItem","position":2,"name":"2021 11 16 Ithome Cloud Summit Vault","item":"https://chechia.net/posts/2021-11-16-ithome-cloud-summit-vault/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"2021 11 16 Ithome Cloud Summit Vault","name":"2021 11 16 Ithome Cloud Summit Vault","description":"各位好\n關於這個 QRcode\n每次上台前，我都會想要帶什麼樣的內容給觀眾，讓觀眾值得花 30 分鐘在底下聽。後來就習慣先發表一篇文章，把對觀眾有幫助的資源包成一包：\n首先是完整投影片：https://slides.com/chechiac\u0026hellip;/terraform-introduction-a56697 逐字講稿：(最後校稿中） 然而只有本次演講內容，回去可能還是不太容易操作。所以這次附上使用 Terraform 一鍵部署 vault 的 Github Repository：https://github.com/\u0026hellip;/southe\u0026hellip;/chechia_net/vault/singleton 如果不熟 Terraform，再附上 30 天手把手 Terraform 教學文章，只要願意花時間，全篇中文一個月帶你上手 Terraform。 IThome 鐵人賽好讀版：https://ithelp.ithome.com.tw/users/20120327/ironman/4057 Github Repository 完整版：https://github.com/\u0026hellip;/terraform-30\u0026hellip;/tree/main/lecture/zh 如果遇到問題還是需要找人發問，所以再推薦兩個社群，可以來這邊發問，要找我本人也找得到。甚至只是加入潛水不講話，都可以被動吸收許多新知。 Cloud Native Taiwan User Group https://t.me/cntug https://fb.cloudnative.tw DevOps Taiwan Meetup Group https://t.me/devopstw 大家可以手機拍完這個就出去吃午餐了。 或是拍回家，然後傳給一個同事叫他花 30 天把 Terraform 跟 Vault 這些都學會。\n總之希望對各位有幫助，讓國內技術力能持續進步成長。\n回到本次演講。\n本次演講有三個關鍵字\nKubernetes Vault Terraform 這個是隱藏的 請問平時工作會用到這三個技術之一的朋友，請舉個手，好讓我知道一下觀眾的分布，等等分享的內容會照比例做一些調整。\n我們今天不會講太多 Kubernetes 的內容，重點放在 Vault，以及如何設定 Vault，所以 Terraform Infrastructure as Code 或是 configuration as Code 會在這邊跑出來。\n","keywords":["kubernetes","vault","terraform"],"articleBody":"各位好\n關於這個 QRcode\n每次上台前，我都會想要帶什麼樣的內容給觀眾，讓觀眾值得花 30 分鐘在底下聽。後來就習慣先發表一篇文章，把對觀眾有幫助的資源包成一包：\n首先是完整投影片：https://slides.com/chechiac…/terraform-introduction-a56697 逐字講稿：(最後校稿中） 然而只有本次演講內容，回去可能還是不太容易操作。所以這次附上使用 Terraform 一鍵部署 vault 的 Github Repository：https://github.com/…/southe…/chechia_net/vault/singleton 如果不熟 Terraform，再附上 30 天手把手 Terraform 教學文章，只要願意花時間，全篇中文一個月帶你上手 Terraform。 IThome 鐵人賽好讀版：https://ithelp.ithome.com.tw/users/20120327/ironman/4057 Github Repository 完整版：https://github.com/…/terraform-30…/tree/main/lecture/zh 如果遇到問題還是需要找人發問，所以再推薦兩個社群，可以來這邊發問，要找我本人也找得到。甚至只是加入潛水不講話，都可以被動吸收許多新知。 Cloud Native Taiwan User Group https://t.me/cntug https://fb.cloudnative.tw DevOps Taiwan Meetup Group https://t.me/devopstw 大家可以手機拍完這個就出去吃午餐了。 或是拍回家，然後傳給一個同事叫他花 30 天把 Terraform 跟 Vault 這些都學會。\n總之希望對各位有幫助，讓國內技術力能持續進步成長。\n回到本次演講。\n本次演講有三個關鍵字\nKubernetes Vault Terraform 這個是隱藏的 請問平時工作會用到這三個技術之一的朋友，請舉個手，好讓我知道一下觀眾的分布，等等分享的內容會照比例做一些調整。\n我們今天不會講太多 Kubernetes 的內容，重點放在 Vault，以及如何設定 Vault，所以 Terraform Infrastructure as Code 或是 configuration as Code 會在這邊跑出來。\n關於我，我是哲嘉。我在 Maicoin 當 SRE。常出現的社群是 CNTUG 與 DevOpsTW。\n我們今天談的更大的主題其實是 Key Management 私鑰管理，或是密碼管理。這是一個很大的題目，今天演講內容只是其中的一個實作案例。\n舉個例子，一邊是 API Server，另一邊 Database，或是第三方服務\nDatabase 來 Authenticate 合法的 Client 用戶端，可能是 username + password，或是 API Key + Secret，或是 Access Token，或是 Private Key，Client Certificate，都可以。\n在跨不同平台或是介面的服務，我們常用的 Auth 方法。認 Key 不認人。\n那中間這些 Key 要怎麼管理，就有很多學問 其中最基本的，是怎麼配置給 API Server 讓他使用 注意：讓 API Server 使用，隱含的意思是，其他人不管是其他微服務，或是開發工程師，閒雜人等都不能看到。\n這邊我們假設 API Server 是在 Kubernetes 裡面跑，微服務架構，所以 API Server 可能是一個 Pod，我們 SRE 要為這組 Pod 配置密碼。\n這邊列出的應該是 K8s 比較常見的幾種做法。\nplain text，直接寫進 file 讓 Pod 去讀取 k8s secret 做 base64 encode 安全一點的透過外部機制作加密解密 或是寫在 API Server 的 memory 中 事實上如果沒有使用 K8s，使用 VM 或是公有雲 Container Service，應該都是類似的原理，大家都是 Linux base，secret 放進來看要放在 disk 或是 memory 裏面。\n實際放到 K8s 大概會長長這些 yaml\n最簡單，就直接把 secret 壓到 Pod env 裏面，\n最簡單也最危險\n所有看得到 yaml 的人都明碼看見密碼 所有能進到 file system 提外話\nAPI Server 被從正面打穿，滲透到拿到這組密碼的機會多高？\n如果 API Server golang library 有在跟安全性更新 Kubernetes 用公有雲的 Kubernetes Service，有在更新 OS ami 跟 docker image 都有在更新 然後有功能正常的防火牆 打掛蠻有可能的，但打穿服務到拿到密碼，是有難度的。\n更多時候，至少在幣圈有被爆出來的資安事件，大多是是公司員工被釣魚信掉到，被植入惡意軟體在 local 電腦，然後他又看得到明碼的密碼，直接爆炸。\n明碼糟糕的地方，大家都看得到，一開始就是 exposed 的狀態，風險不可控，也無從管制。\n然後是 K8s secret，也是從 env 掛進去 Pod\n放在 k8s secret，是 base64 的格式\n看起來跟原先內容不一樣了，有人就跟我說，他們家的 k8s secret 有用 base64 加密。\nencode 跟 encrypt\nk8s secret 有什麼問題\n明碼 plain text 的問題，不該看到的人很容易就看到 根本的問題還是 RBAC 懶得設定，大家都用 default role 進來 要用可以，先看 k8s secret 後面的儲存實作是什麼？\n是 k8s etcd 透過 k8s API server 存取 etcd 跟 kube-api 一般來說是夠安全的。官方文件還建議\nsecret 要加密 encrypt 增強 RBAC 控制，只有特定 role 才看得到 secret，，而不是每個人都用 default role 近來 k8s，然後進到 namespace 全部 secret 就看光光 RBAC 有設定好，有加密，是可以做到安全。當然還是沒有專門 key Management 工具，如 Vault 有額外管理上的優化功能。\n加密範例可以看強者我朋友的文章\n加密完可能長這樣，還要額外透過其他機制才能進行解密，拿到原始資料\n例如透過 k8s controller 解密 或是透過 vault server 或是透過公有雲的 Key Management Service 做解密 其他的 k8s secret 加密解決方案\n今天我們使用 Vault，其中一個目的就是要坐中間這段 Safe Magic\n給這個 Pod secret 然後只給這個 Pod Secret 當然 Key Management 其他還有一堆事情要處理\n密碼洩漏的話有沒有 revoke 機制\n能不能定時 Rotate 汰換密碼？\n改架構，底下的設定好不好耕著動態調整，還是要跟著 rename / mv k8s secret\n怎麼做稽核，怎麼檢查內容。我看不到 vault 幫我看一下內容對不對，這個很容易發生。\n臆想頭就很痛\n今天的目的很單純\n密碼的露出盡量小 最好密碼是有期限的，逾期自動失效 暴露了可以 revoke Vault\n有人用過？這邊簡介一下\n在 CNCF 的 landscape 漱渝 Key Management，應該是裡面市佔最高的開源項目\n重點就是保護與管理 secret\nVault 的核心概念，這個影片是 Hashicorp 官方介紹的影片，講得很好，大家自己回去看一下\n這邊簡單 vault 101\n現在有一台 vault server 已經設定好了，我們可以使用 vault client 連線\n例如這邊\n使用 VAULT TOKEN 告訴 vault 你是什麼身份的用戶 或是進行 login，Vault 會呸發一組臨時的 TOKEN 給你 拿著組 TOKEN 去問 Vault，請問我可以要 /user/mysql 這個路徑下的資料嗎？\nVault 檢查 TOKEN 的 role 與 permission，可以就回傳值 不行就 permission denied\nVault 就是金庫，真正重要的 key 存在裡面，使用這要來問 Vault，要先過 Vault 這關\nVault 實際存放 Secret Engine，這邊也跳過，大家先把他當 key / value 存放好了 XD\n等等，這樣 vault Auth 有點怪\n本來拿 username / password 去控制 Mysql 先在多一步，先拿到 VAULT TOKEN，再拿 TOKEN 去跟 Vault 拿 Mysql password，再去連 MySQL\n咦這樣不是很怪？我如果 Vault token 暴露了，有心人士還是可以從 vault 拿到資料啊\n這樣有比較安全嗎？還是只是花式被駭\n對，只是做 token 交換的話，還是不夠，所以 Vault 有提供許多 Auth method\ntoken 只是其中一種 有很多認證方法不用 token 交換，但也能讓 vault 認得 k8s pod 與 api server 這是今天的重點之一，token / 密碼傳遞不安全，那就用其他手段 auth\n以 AWS IAM auth 為例\n如果今天是在 aws ec2 上跑，那可以透過 aws internal api 去取得身份認證資料，也就是 ec2 instance metadata\n拿這個 metadata 去問 vault，vault 再透過 aws api 去確認，這個 ec2 instance 真的是合法的\n然後依據 ec2 instance 身份，配發權限跟資料\napi server ec2 就給 api server secret frontend server ec2 就給 frontend secret 中間沒有多餘的密碼 / token 交換\n來往的對話大概是這樣\nAWS API 是可信的 Vault 自己維護是可信的 服務透過三方交握去認證，認 runtime 環境的 metadata，不再是認 key 不認人 至於 api server ec2 近來 vault 後，應該有什麼樣的權限，在 vault 內部透過 policy 配置\n設定 path 設定允許的 operation 例如 read write list delete … 等 runtime 動態調整\n當然 Vault 還有提供很多更加安全的功能\n例如如何安全地存放 secret Storage 這邊跳過\nSecret + auth 搭配跳過\n以及 dynamic secret，來解認 key 不認人的問題\n例如 mysql 的靜態 username / password，透過 vault 設定可以變成動態的\n回到 k8s，使用 token auth，然後把 VAULT TOKEN 放在 k8s secret 裏面，只有比較安全一點點\n就是 VAULT TOKEN 可以快速 rotate 跟 revoke\n這邊可以搭配其他 auth 方式來解決\n剛剛不是讓 vault 去認 aws ec2？\n在 k8s 中，可以讓 vault 去認 k8s cluster / service account\n路徑圖長這樣\npod runtime 都會有 service account 使用 service account 的 metadata 去問 vault vault 去問 k8s，這個 service account 是真的假的 k8s 回答 vault，Pod 跟service account 是合法的 vault 再配權限給 Pod auth detail 的文字描述，跟上面講的一樣\n配合 k8s sidecar，可以把 vault 拿到的 key 寫到 memory mount 裏面\nPod init 時 init container 才去 invoke vault API key 不會透過 k8s api 傳遞，也不會在 etcd 內出現 main container 透過 memory mount 存取 key key 的 lifecycle 跟 pod 一樣， pod delete 掉這組 in-memory key 也自動清除 好處\n更少 expose，沒有過 kube-api 與 etcd in-memory vault 跟 pod 之間的 vault token 的 time-to-live 期限可以很短，幾十秒內，init 完即可拋棄的 token 壞處（？）\n每個 pod 起來會去打 vault api 實務經驗上 loading 很低 而且 vault server 可以做 HA 跟 horizontal scaling 最大的成本，其實是 vault 設定 讓 vault 認 k8s 根據 service account 去配權限 其他花俏功能都需要額外的設定 系統複雜，保證配到你頭昏眼花 想像一下，這張圖里的\npolicy 跟為服務數量呈正比 secret path 也耕服務數量呈正比 auth k8s 數量也跟服務數量呈正相關 用越久，內容隨時間增加 改架構時更刺激 建議使用 vault 務必 搭配 Terraform 管理\ninfrastructure as code configuration as code policy as code Terraform 非常適合管理複雜，但有常常需要細部調整的設定資料\n其他功能，跳過\n其他功能\nsecret debug 超麻煩\n內容正確性，valid key 還是 invalid key，還是根本是另一隻 key 權限正確性，是不是這個 username / password 的權限是正確的 跨團隊溝通更頭痛，不是可以貼在 slack 大家一起幫看的東西 terraform 可以幫助 vault 設定 debug\n至少跨環境復現問題很方邊 Vault 有 HA\nVault Performance 通常不是問題\n雖然 loading 隨 micro service 線性增加 但本身可以是無狀態 server，可以 horizontal scale 注意一下 auto-retry\npod fail restart 又再 init 一次，如果一萬個 pod 一直 retry 可能真的會把 vault 打爆 backup limit 要注意 使用 init container 的話，是 cache 在 Pod 層級，container fail restart 不會重新打 vault api 安全性\nvault 有專業資安團隊把關 不要怕 vault 被打穿，而是要怕同事被釣魚 結論\n要不要 vault\nqrcode 最後機會\n有問題可以來社群找我\nMaicoin 是間好公司 2014 服務上線到現在，在台灣已經邁入第八年。顧客數一直增加，我們也持續緩慢擴編。\n覺得自己有能力，歡迎來挑戰，等等私下找我聊\n謝謝\nQ \u0026 A\nTerraform vs Pulumi\n操作語言差異，有好有壞 vault 跟 terraform 的 hcl 是增強版 json，本質還是 json，有興趣可以去看我的文章 terraform 目前是站跟星星還是領先，未來繼續看 Kubernetes Service account token 要不要更新\n要，應該定期更新，官方文件有操作步驟 Vault / Terraform 實務上的工作負擔會很花時間跟人力嗎\n學習曲線比較奇怪，要花一點時間做中學 學熟了之後就很好改，效率很高 至少是屌打用 gui 改或是 client 直接下 cmd 拉 ","wordCount":"877","inLanguage":"en","image":"https://chechia.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2021-11-16T01:04:12+08:00","dateModified":"2021-11-16T01:04:12+08:00","author":{"@type":"Person","name":"chechiachang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://chechia.net/posts/2021-11-16-ithome-cloud-summit-vault/"},"publisher":{"@type":"Organization","name":"Che-Chia Chang","logo":{"@type":"ImageObject","url":"https://chechia.net/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://chechia.net/ accesskey=h title="Home (Alt + H)"><img src=https://chechia.net/favicon/favicon-32x32.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://chechia.net/#posts title=Posts><span>Posts</span></a></li><li><a href=https://mvp.microsoft.com/zh-TW/mvp/profile/e407d0b9-5c01-eb11-a815-000d3a8ccaf5 title=MVP><span>MVP</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://chechia.net/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://chechia.net/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://chechia.net/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://chechia.net/>Home</a>&nbsp;»&nbsp;<a href=https://chechia.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">2021 11 16 Ithome Cloud Summit Vault</h1><div class=post-meta><span title='2021-11-16 01:04:12 +0800 CST'>November 16, 2021</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;877 words&nbsp;·&nbsp;chechiachang&nbsp;|&nbsp;<a href=https://github.com/chechiachang.github.io-src/content/posts/2021-11-16-ithome-cloud-summit-vault.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>各位好</p><p>關於這個 QRcode</p><p>每次上台前，我都會想要帶什麼樣的內容給觀眾，讓觀眾值得花 30 分鐘在底下聽。後來就習慣先發表一篇文章，把對觀眾有幫助的資源包成一包：</p><ul><li>首先是完整投影片：https://slides.com/chechiac&mldr;/terraform-introduction-a56697</li><li>逐字講稿：(最後校稿中）</li><li>然而只有本次演講內容，回去可能還是不太容易操作。所以這次附上使用 Terraform 一鍵部署 vault 的 Github Repository：https://github.com/&mldr;/southe&mldr;/chechia_net/vault/singleton</li><li>如果不熟 Terraform，再附上 30 天手把手 Terraform 教學文章，只要願意花時間，全篇中文一個月帶你上手 Terraform。<ul><li>IThome 鐵人賽好讀版：https://ithelp.ithome.com.tw/users/20120327/ironman/4057</li><li>Github Repository 完整版：https://github.com/&mldr;/terraform-30&mldr;/tree/main/lecture/zh</li></ul></li><li>如果遇到問題還是需要找人發問，所以再推薦兩個社群，可以來這邊發問，要找我本人也找得到。甚至只是加入潛水不講話，都可以被動吸收許多新知。<ul><li>Cloud Native Taiwan User Group<ul><li><a href=https://t.me/cntug>https://t.me/cntug</a></li><li><a href=https://fb.cloudnative.tw>https://fb.cloudnative.tw</a></li></ul></li><li>DevOps Taiwan Meetup Group<ul><li><a href=https://t.me/devopstw>https://t.me/devopstw</a></li></ul></li></ul></li></ul><p>大家可以手機拍完這個就出去吃午餐了。
或是拍回家，然後傳給一個同事叫他花 30 天把 Terraform 跟 Vault 這些都學會。</p><p>總之希望對各位有幫助，讓國內技術力能持續進步成長。</p><hr><p>回到本次演講。</p><p>本次演講有三個關鍵字</p><ul><li>Kubernetes</li><li>Vault</li><li>Terraform 這個是隱藏的</li></ul><p>請問平時工作會用到這三個技術之一的朋友，請舉個手，好讓我知道一下觀眾的分布，等等分享的內容會照比例做一些調整。</p><p>我們今天不會講太多 Kubernetes 的內容，重點放在 Vault，以及如何設定 Vault，所以 Terraform Infrastructure as Code 或是 configuration as Code 會在這邊跑出來。</p><hr><p>關於我，我是哲嘉。我在 Maicoin 當 SRE。常出現的社群是 CNTUG 與 DevOpsTW。</p><hr><p>我們今天談的更大的主題其實是 Key Management 私鑰管理，或是密碼管理。這是一個很大的題目，今天演講內容只是其中的一個實作案例。</p><hr><p>舉個例子，一邊是 API Server，另一邊 Database，或是第三方服務</p><p>Database 來 Authenticate 合法的 Client 用戶端，可能是 username + password，或是 API Key + Secret，或是 Access Token，或是 Private Key，Client Certificate，都可以。</p><p>在跨不同平台或是介面的服務，我們常用的 Auth 方法。認 Key 不認人。</p><hr><p>那中間這些 Key 要怎麼管理，就有很多學問
其中最基本的，是怎麼配置給 API Server 讓他使用
注意：讓 API Server 使用，隱含的意思是，其他人不管是其他微服務，或是開發工程師，閒雜人等都不能看到。</p><hr><p>這邊我們假設 API Server 是在 Kubernetes 裡面跑，微服務架構，所以 API Server 可能是一個 Pod，我們 SRE 要為這組 Pod 配置密碼。</p><p>這邊列出的應該是 K8s 比較常見的幾種做法。</p><ul><li>plain text，直接寫進 file 讓 Pod 去讀取</li><li>k8s secret 做 base64 encode</li><li>安全一點的透過外部機制作加密解密</li><li>或是寫在 API Server 的 memory 中</li></ul><p>事實上如果沒有使用 K8s，使用 VM 或是公有雲 Container Service，應該都是類似的原理，大家都是 Linux base，secret 放進來看要放在 disk 或是 memory 裏面。</p><hr><p>實際放到 K8s 大概會長長這些 yaml</p><p>最簡單，就直接把 secret 壓到 Pod env 裏面，</p><p>最簡單也最危險</p><ul><li>所有看得到 yaml 的人都明碼看見密碼</li><li>所有能進到 file system</li></ul><p>提外話</p><p>API Server 被從正面打穿，滲透到拿到這組密碼的機會多高？</p><ul><li>如果 API Server golang library 有在跟安全性更新</li><li>Kubernetes 用公有雲的 Kubernetes Service，有在更新</li><li>OS ami 跟 docker image 都有在更新</li><li>然後有功能正常的防火牆</li></ul><p>打掛蠻有可能的，但打穿服務到拿到密碼，是有難度的。</p><p>更多時候，至少在幣圈有被爆出來的資安事件，大多是是公司員工被釣魚信掉到，被植入惡意軟體在 local 電腦，然後他又看得到明碼的密碼，直接爆炸。</p><p>明碼糟糕的地方，大家都看得到，一開始就是 exposed 的狀態，風險不可控，也無從管制。</p><hr><p>然後是 K8s secret，也是從 env 掛進去 Pod</p><hr><p>放在 k8s secret，是 base64 的格式</p><p>看起來跟原先內容不一樣了，有人就跟我說，他們家的 k8s secret 有用 base64 加密。</p><p>encode 跟 encrypt</p><hr><p>k8s secret 有什麼問題</p><ul><li>明碼 plain text 的問題，不該看到的人很容易就看到</li><li>根本的問題還是 RBAC 懶得設定，大家都用 default role 進來</li></ul><p>要用可以，先看 k8s secret 後面的儲存實作是什麼？</p><ul><li>是 k8s etcd</li><li>透過 k8s API server 存取</li></ul><p>etcd 跟 kube-api 一般來說是夠安全的。官方文件還建議</p><ul><li>secret 要加密 encrypt</li><li>增強 RBAC 控制，只有特定 role 才看得到 secret，，而不是每個人都用 default role 近來 k8s，然後進到 namespace 全部 secret 就看光光</li></ul><p>RBAC 有設定好，有加密，是可以做到安全。當然還是沒有專門 key Management 工具，如 Vault 有額外管理上的優化功能。</p><p>加密範例可以看強者我朋友的文章</p><hr><p>加密完可能長這樣，還要額外透過其他機制才能進行解密，拿到原始資料</p><ul><li>例如透過 k8s controller 解密</li><li>或是透過 vault server</li><li>或是透過公有雲的 Key Management Service 做解密</li></ul><hr><p>其他的 k8s secret 加密解決方案</p><hr><p>今天我們使用 Vault，其中一個目的就是要坐中間這段 Safe Magic</p><ul><li>給這個 Pod secret</li><li>然後只給這個 Pod Secret</li></ul><hr><p>當然 Key Management 其他還有一堆事情要處理</p><ul><li><p>密碼洩漏的話有沒有 revoke 機制</p></li><li><p>能不能定時 Rotate 汰換密碼？</p></li><li><p>改架構，底下的設定好不好耕著動態調整，還是要跟著 rename / mv k8s secret</p></li><li><p>怎麼做稽核，怎麼檢查內容。我看不到 vault 幫我看一下內容對不對，這個很容易發生。</p></li></ul><p>臆想頭就很痛</p><hr><p>今天的目的很單純</p><ul><li>密碼的露出盡量小</li><li>最好密碼是有期限的，逾期自動失效</li><li>暴露了可以 revoke</li></ul><hr><p>Vault</p><p>有人用過？這邊簡介一下</p><hr><p>在 CNCF 的 landscape 漱渝 Key Management，應該是裡面市佔最高的開源項目</p><hr><p>重點就是保護與管理 secret</p><hr><p>Vault 的核心概念，這個影片是 Hashicorp 官方介紹的影片，講得很好，大家自己回去看一下</p><hr><p>這邊簡單 vault 101</p><p>現在有一台 vault server 已經設定好了，我們可以使用 vault client 連線</p><p>例如這邊</p><ul><li>使用 VAULT TOKEN 告訴 vault 你是什麼身份的用戶</li><li>或是進行 login，Vault 會呸發一組臨時的 TOKEN 給你</li></ul><p>拿著組 TOKEN 去問 Vault，請問我可以要 /user/mysql 這個路徑下的資料嗎？</p><p>Vault 檢查 TOKEN 的 role 與 permission，可以就回傳值
不行就 permission denied</p><p>Vault 就是金庫，真正重要的 key 存在裡面，使用這要來問 Vault，要先過 Vault 這關</p><hr><p>Vault 實際存放 Secret Engine，這邊也跳過，大家先把他當 key / value 存放好了 XD</p><hr><p>等等，這樣 vault Auth 有點怪</p><p>本來拿 username / password 去控制 Mysql
先在多一步，先拿到 VAULT TOKEN，再拿 TOKEN 去跟 Vault 拿 Mysql password，再去連 MySQL</p><p>咦這樣不是很怪？我如果 Vault token 暴露了，有心人士還是可以從 vault 拿到資料啊</p><p>這樣有比較安全嗎？還是只是花式被駭</p><p>對，只是做 token 交換的話，還是不夠，所以 Vault 有提供許多 Auth method</p><ul><li>token 只是其中一種</li><li>有很多認證方法不用 token 交換，但也能讓 vault 認得 k8s pod 與 api server</li></ul><p>這是今天的重點之一，token / 密碼傳遞不安全，那就用其他手段 auth</p><hr><p>以 AWS IAM auth 為例</p><p>如果今天是在 aws ec2 上跑，那可以透過 aws internal api 去取得身份認證資料，也就是 ec2 instance metadata</p><p>拿這個 metadata 去問 vault，vault 再透過 aws api 去確認，這個 ec2 instance 真的是合法的</p><p>然後依據 ec2 instance 身份，配發權限跟資料</p><ul><li>api server ec2 就給 api server secret</li><li>frontend server ec2 就給 frontend secret</li></ul><p>中間沒有多餘的密碼 / token 交換</p><hr><p>來往的對話大概是這樣</p><ul><li>AWS API 是可信的</li><li>Vault 自己維護是可信的</li><li>服務透過三方交握去認證，認 runtime 環境的 metadata，不再是認 key 不認人</li></ul><hr><p>至於 api server ec2 近來 vault 後，應該有什麼樣的權限，在 vault 內部透過 policy 配置</p><ul><li>設定 path</li><li>設定允許的 operation 例如 read write list delete &mldr; 等</li></ul><p>runtime 動態調整</p><hr><p>當然 Vault 還有提供很多更加安全的功能</p><ul><li>例如如何安全地存放 secret</li></ul><p>Storage 這邊跳過</p><hr><p>Secret + auth 搭配跳過</p><hr><p>以及 dynamic secret，來解認 key 不認人的問題</p><p>例如 mysql 的靜態 username / password，透過 vault 設定可以變成動態的</p><hr><p>回到 k8s，使用 token auth，然後把 VAULT TOKEN 放在 k8s secret 裏面，只有比較安全一點點</p><p>就是 VAULT TOKEN 可以快速 rotate 跟 revoke</p><p>這邊可以搭配其他 auth 方式來解決</p><hr><p>剛剛不是讓 vault 去認 aws ec2？</p><p>在 k8s 中，可以讓 vault 去認 k8s cluster / service account</p><hr><p>路徑圖長這樣</p><ul><li>pod runtime 都會有 service account</li><li>使用 service account 的 metadata 去問 vault</li><li>vault 去問 k8s，這個 service account 是真的假的</li><li>k8s 回答 vault，Pod 跟service account 是合法的</li><li>vault 再配權限給 Pod</li></ul><hr><p>auth detail 的文字描述，跟上面講的一樣</p><hr><p>配合 k8s sidecar，可以把 vault 拿到的 key 寫到 memory mount 裏面</p><ul><li>Pod init 時 init container 才去 invoke vault API</li><li>key 不會透過 k8s api 傳遞，也不會在 etcd 內出現</li><li>main container 透過 memory mount 存取 key</li><li>key 的 lifecycle 跟 pod 一樣， pod delete 掉這組 in-memory key 也自動清除</li></ul><hr><p>好處</p><ul><li>更少 expose，沒有過 kube-api 與 etcd</li><li>in-memory</li><li>vault 跟 pod 之間的 vault token 的 time-to-live 期限可以很短，幾十秒內，init 完即可拋棄的 token</li></ul><hr><p>壞處（？）</p><ul><li>每個 pod 起來會去打 vault api<ul><li>實務經驗上 loading 很低</li><li>而且 vault server 可以做 HA 跟 horizontal scaling</li></ul></li><li>最大的成本，其實是 vault 設定<ul><li>讓 vault 認 k8s</li><li>根據 service account 去配權限</li><li>其他花俏功能都需要額外的設定</li><li>系統複雜，保證配到你頭昏眼花</li></ul></li></ul><hr><p>想像一下，這張圖里的</p><ul><li>policy 跟為服務數量呈正比</li><li>secret path 也耕服務數量呈正比</li><li>auth k8s 數量也跟服務數量呈正相關</li><li>用越久，內容隨時間增加</li><li>改架構時更刺激</li></ul><hr><p>建議使用 vault 務必 搭配 Terraform 管理</p><ul><li>infrastructure as code</li><li>configuration as code</li><li>policy as code</li></ul><p>Terraform 非常適合管理複雜，但有常常需要細部調整的設定資料</p><hr><p>其他功能，跳過</p><hr><p>其他功能</p><hr><p>secret debug 超麻煩</p><ul><li>內容正確性，valid key 還是 invalid key，還是根本是另一隻 key</li><li>權限正確性，是不是這個 username / password 的權限是正確的</li><li>跨團隊溝通更頭痛，不是可以貼在 slack 大家一起幫看的東西</li></ul><hr><p>terraform 可以幫助 vault 設定 debug</p><ul><li>至少跨環境復現問題很方邊</li></ul><hr><p>Vault 有 HA</p><hr><p>Vault Performance 通常不是問題</p><ul><li>雖然 loading 隨 micro service 線性增加</li><li>但本身可以是無狀態 server，可以 horizontal scale</li></ul><hr><p>注意一下 auto-retry</p><ul><li>pod fail restart 又再 init 一次，如果一萬個 pod 一直 retry 可能真的會把 vault 打爆</li><li>backup limit 要注意</li><li>使用 init container 的話，是 cache 在 Pod 層級，container fail restart 不會重新打 vault api</li></ul><hr><p>安全性</p><ul><li>vault 有專業資安團隊把關</li><li>不要怕 vault 被打穿，而是要怕同事被釣魚</li></ul><hr><p>結論</p><hr><p>要不要 vault</p><hr><p>qrcode 最後機會</p><hr><p>有問題可以來社群找我</p><hr><p>Maicoin 是間好公司 2014 服務上線到現在，在台灣已經邁入第八年。顧客數一直增加，我們也持續緩慢擴編。</p><p>覺得自己有能力，歡迎來挑戰，等等私下找我聊</p><hr><p>謝謝</p><hr><p>Q & A</p><p>Terraform vs Pulumi</p><ul><li>操作語言差異，有好有壞</li><li>vault 跟 terraform 的 hcl 是增強版 json，本質還是 json，有興趣可以去看我的文章</li><li>terraform 目前是站跟星星還是領先，未來繼續看</li></ul><p>Kubernetes Service account token 要不要更新</p><ul><li>要，應該定期更新，官方文件有操作步驟</li></ul><p>Vault / Terraform 實務上的工作負擔會很花時間跟人力嗎</p><ul><li>學習曲線比較奇怪，要花一點時間做中學</li><li>學熟了之後就很好改，效率很高</li><li>至少是屌打用 gui 改或是 client 直接下 cmd 拉</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://chechia.net/tags/kubernetes/>Kubernetes</a></li><li><a href=https://chechia.net/tags/vault/>Vault</a></li><li><a href=https://chechia.net/tags/terraform/>Terraform</a></li></ul><nav class=paginav><a class=prev href=https://chechia.net/posts/2022-05-21-coscup-proposal-operating-time-series-database-in-k8s/><span class=title>« Prev</span><br><span>2022 05 21 COSCUP Operating Time Series Database in K8s</span>
</a><a class=next href=https://chechia.net/posts/2021-09-01-ithome-ironman-go/><span class=title>Next »</span><br><span>2021 09 01 Ithome Ironman Go</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 2021 11 16 Ithome Cloud Summit Vault on x" href="https://x.com/intent/tweet/?text=2021%2011%2016%20Ithome%20Cloud%20Summit%20Vault&amp;url=https%3a%2f%2fchechia.net%2fposts%2f2021-11-16-ithome-cloud-summit-vault%2f&amp;hashtags=kubernetes%2cvault%2cterraform"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 2021 11 16 Ithome Cloud Summit Vault on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fchechia.net%2fposts%2f2021-11-16-ithome-cloud-summit-vault%2f&amp;title=2021%2011%2016%20Ithome%20Cloud%20Summit%20Vault&amp;summary=2021%2011%2016%20Ithome%20Cloud%20Summit%20Vault&amp;source=https%3a%2f%2fchechia.net%2fposts%2f2021-11-16-ithome-cloud-summit-vault%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 2021 11 16 Ithome Cloud Summit Vault on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fchechia.net%2fposts%2f2021-11-16-ithome-cloud-summit-vault%2f&title=2021%2011%2016%20Ithome%20Cloud%20Summit%20Vault"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 2021 11 16 Ithome Cloud Summit Vault on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fchechia.net%2fposts%2f2021-11-16-ithome-cloud-summit-vault%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 2021 11 16 Ithome Cloud Summit Vault on whatsapp" href="https://api.whatsapp.com/send?text=2021%2011%2016%20Ithome%20Cloud%20Summit%20Vault%20-%20https%3a%2f%2fchechia.net%2fposts%2f2021-11-16-ithome-cloud-summit-vault%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 2021 11 16 Ithome Cloud Summit Vault on telegram" href="https://telegram.me/share/url?text=2021%2011%2016%20Ithome%20Cloud%20Summit%20Vault&amp;url=https%3a%2f%2fchechia.net%2fposts%2f2021-11-16-ithome-cloud-summit-vault%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 2021 11 16 Ithome Cloud Summit Vault on ycombinator" href="https://news.ycombinator.com/submitlink?t=2021%2011%2016%20Ithome%20Cloud%20Summit%20Vault&u=https%3a%2f%2fchechia.net%2fposts%2f2021-11-16-ithome-cloud-summit-vault%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://chechia.net/>Che-Chia Chang</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>