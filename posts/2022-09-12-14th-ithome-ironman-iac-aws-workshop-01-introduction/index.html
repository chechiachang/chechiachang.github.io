<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>IaC best practice workshop on aws | Che-Chia Chang</title><meta name=keywords content="terraform,iac,aws,鐵人賽2022"><meta name=description content="Article description."><meta name=author content="chechiachang"><link rel=canonical href=https://chechia.net/posts/2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction/><meta name=google-site-verification content="G-QYR8JCDGM9"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://chechia.net/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://chechia.net/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://chechia.net/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://chechia.net/favicon/favicon-32x32.png><link rel=mask-icon href=https://chechia.net/favicon/favicon-32x32.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://chechia.net/posts/2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://chechia.net/posts/2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction/"><meta property="og:site_name" content="Che-Chia Chang"><meta property="og:title" content="IaC best practice workshop on aws"><meta property="og:description" content="Article description."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-12T14:31:48+08:00"><meta property="article:modified_time" content="2022-09-12T14:31:48+08:00"><meta property="article:tag" content="Terraform"><meta property="article:tag" content="Iac"><meta property="article:tag" content="Aws"><meta property="article:tag" content="鐵人賽2022"><meta property="og:image" content="https://chechia.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://chechia.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="IaC best practice workshop on aws"><meta name=twitter:description content="Article description."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://chechia.net/posts/"},{"@type":"ListItem","position":2,"name":"IaC best practice workshop on aws","item":"https://chechia.net/posts/2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"IaC best practice workshop on aws","name":"IaC best practice workshop on aws","description":"Article description.","keywords":["terraform","iac","aws","鐵人賽2022"],"articleBody":"iThome 鐵人賽好讀版\n賽後文章會整理放到個人的部落格上 http://chechia.net/\n追蹤粉專可以收到文章的主動推播\n–\nAWS 為例，實現 production framework 的最佳實踐的 30 天 workshop\n準備 Production environmtn Devops 面臨的問題 DevOps 的工作內容繁雜\n今天想要 Deploy 一個 backend API deployment 到 k8s 上 一轉眼發現自己在修 port / servie / ingress / alb 一轉眼發現自己在修 tls certificate 一轉眼發現自己在修 node linux 上的一個 bug 一轉眼發現自己在修 monitoring / metrics + alert / log collection … 我只是想 deploy 一個 backend deployment 修infra 花了好幾天，而寫 deployment 只要 2 hr Devops 的工作，是處理 developer 與 operator 中間的繁雜的細節 換個角度思考：上面這些元件全都是存在許久的功能，應該有一套統一介面隨叫即用這些服務，ex.\n今天想要 Deploy 一個 backend API deployment 到 k8s 上 承上，同值性高，coding 講求 DRY 原則 (Don’t Repeat Youself)，infra 管理上卻會有大量重複的工作\n開一個 Restful API deployment 開一個 GRPC deployment 開一個 Kafka message Queue / redis / RDS / … 希望這些元件都有寫好的 unit 可以重複使用 但實務上還是會有細節需要調整 自動化\n標準化功能後，應該要可以自動部署 甚至是當 Backend API deployment 部署上去時，自動調用產生對應的元件 Backend API deployment 有變化時應該要跟據 deployment 需求去做 reconcile (k8s controller) 缺乏測試\nVM / alb / RDS / … 等公有雲服務需要測試嗎 A: AWS / Google / Azure 都測過了，我們不用再測 然而 SRE 卻發現時常需要花時間 debug 這些元件 不是 functional issue，而是 configuration 問題，或是不同元件設定造成交互作用 B: 要上 production 的元件都要測試 使用 terraform provision 一台 EC2 後，在使用 terratest (Golang) 打 aws API 進行測試 標準化，自動化後，應該有大量的自動化測試，來確保每一個元件的 configuration 都是正確的，而且有信心維持穩定度 infra 時常改變\n技術元件時常改變：terraform 升級，aws 升級，k8s 升級，linux 升級與 patch infra 沒有射後不理這種事，都需要時常且穩定的更新 為了滿足上游服務(前後端/DB/…)的需求 調整 VM spec / networking / routing / security rules / 不斷的改變耗費大量的人工時間 production ready 需要準備的\nproduction -\u003e 真金白銀，公司的業務與名聲 production ready 應該是有明確的表準 True / False，而不是『我覺得現在是 production ready 了』 DevOps / SRE 都知道 production ready 的標準，只是沒有把他明確寫出來 production ready 應該就跟 unit test 一樣，一個 checklist 跑下去檢查，通過就是 production-ready，不通過就是 not-ready，且會說明不通過的原因 Gruntwork production ready checklist 人工介入工作太多\n新增元件需要人工處裡 定期的 patch \u0026 update / 安全性更新 / deploy 都需要人工介入的話就太浪費時間了 人工工作太多容易造成人為錯誤(human error) 多環境\nSRE 需要提供大量的環境 dev / qa / stag / prod … 或是提早 scan 到更前面的工作流程，例如在 code base / reposiroty 中就先 scan Gruntwork solution 為何要使用 gruntwork framework\nWhy you need a framework\nGruntwork 提出兩個 solution\nReference Architecture Build your own architecture Prerequisites 由於本次分享不希望有多餘的費用，所以內容依據 gruntwork 公開網站與開源的 repository 內容講解使用\n不會涉及付費版的 terraform code library 內容與教材(subscription $795/month) aws 服務也盡量使用 free tier 中的額度 Prerequisites\n基本 Terraform 經驗，或是參考2021 年的鐵人賽系列文章: 30 天學 Terraform on Azure 基本 AWS 服務的觀念 都沒有也沒關係，會沿路在幫各位複習 30 天的目標 使用 terraform 設定所有 aws account 的 resource 參考 gruntwork-io 的開源 repository，設定 如果是測試或學習，可以參考 https://github.com/gruntwork-io/terraform-aws-service-catalog 學習目標\n熟悉 terraform 基本觀念 學會使用 terraform IaC 控制所有 aws service Repository NOTE: 如果是有購買 gruntwork subscription 的朋友，請使用私有的 IaC library repository，有更完整且經過測試的架構\n本課程使用 gruntwork 開源的 repository 架構\n請 copy 需要的部分（而不要 fork，因為這裡不需要過去的 commit history 與未來的 update)\n去年iThome 鐵人賽使用的範例 repository 我自己使用的 repo 今年 iThome 會使用的 repository 今天要做的事 請準備好以下 prerequisite\n設定 / 註冊 aws account 併取得 aws 12-month free-tier (預期是免費的預期 12-month free tier 即可包含所有內容) 然而成本控制也是課程的一環，各位要注意使用的資源，不要超過 aws free tier 太多，理論上也是最多幾美金的花費 安裝與設定 terraform tools terraform 1.2.9 terragrunt 0.38.9 使用舊版本的朋友請盡量使用 terraform \u003e1.x 與 terragrunt \u003e0.35.8 的版本 Aws account\n如果已經有 aws cloud service account 可以直接使用，本課程會使用全新的 aws account 使用 email 註冊 aws cloud service email 認證 信用卡登記 手機認證 Install terraform\nterraform 1.2.9 terragrunt 0.38.9 設定 Github repository 準備一個 github repository 來存放ㄏ的 terraform code\n可以使用我的範例 repository，也是 fork 底下 gruntwork 的 repository 稍作整理 或參考 gruntwork Github repository example git clone git@github.com:chechiachang/terragrunt-infrastructure-live-example.git 明天 帶著大家在 terraform code 中設定 aws account 與 IAM 權限\n參考資源 不熟悉 terraform 的朋友不妨參考去年的佳作 Terraform Workshop - Infrastructure as Code for Public Cloud 疫情警戒陪你度過 30 天，雖然是在 Azure 上 ，但許多基本概念都是相通的\n過去的鐵人賽文章\n13th 佳作 Terraform Workshop - Infrastructure as Code for Public Cloud 疫情警戒陪你度過 30 天 12th 佳作 Kubernetes X DevOps X 從零開始導入工具 X 需求分析＊從底層開始研究到懷疑人生的體悟＊ 11th 優勝 其實我真的沒想過只是把服務丟上 kubernetes 就有這麼多問題只好來參加30天分享那些年我怎麼在 kubernetes 上踩雷各項服務 kkk 推薦一下 Gruntwork 他們家的 blog: Gruntwork devops as a service\nQ\u0026A 過去參賽都會有許多朋友提出問題，今年若有疑問可以集中在第一篇文章，我會跟大家一起討論。有想要看的題目也可以留言，我們看時間做安排。\nreferences https://docs.gruntwork.io/intro/overview/how-it-works ","wordCount":"532","inLanguage":"en","image":"https://chechia.net/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2022-09-12T14:31:48+08:00","dateModified":"2022-09-12T14:31:48+08:00","author":{"@type":"Person","name":"chechiachang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://chechia.net/posts/2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction/"},"publisher":{"@type":"Organization","name":"Che-Chia Chang","logo":{"@type":"ImageObject","url":"https://chechia.net/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://chechia.net/ accesskey=h title="Home (Alt + H)"><img src=https://chechia.net/favicon/favicon-32x32.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://chechia.net/#posts title=Posts><span>Posts</span></a></li><li><a href=https://www.instagram.com/c.c.leather/ title=Leather><span>Leather</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.instagram.com/dive.with.cat.coach/ title=Scuba><span>Scuba</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://mvp.microsoft.com/zh-TW/mvp/profile/e407d0b9-5c01-eb11-a815-000d3a8ccaf5 title=MVP><span>MVP</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://chechia.net/categories/ title=categories><span>categories</span></a></li><li><a href=https://chechia.net/tags/ title=tags><span>tags</span></a></li><li><a href=https://chechia.net/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://chechia.net/>Home</a>&nbsp;»&nbsp;<a href=https://chechia.net/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">IaC best practice workshop on aws</h1><div class=post-description>Article description.</div><div class=post-meta><span title='2022-09-12 14:31:48 +0800 CST'>September 12, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;532 words&nbsp;·&nbsp;chechiachang&nbsp;|&nbsp;<a href=https://github.com/chechiachang.github.io-src/content/posts/2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents></nav></div></details></div><div class=post-content><p><a href=https://ithelp.ithome.com.tw/articles/10290931>iThome 鐵人賽好讀版</a></p><p><a href=http://chechia.net/>賽後文章會整理放到個人的部落格上 http://chechia.net/</a></p><p><a href=https://www.facebook.com/engineer.from.scratch>追蹤粉專可以收到文章的主動推播</a></p><p><img alt=https://ithelp.ithome.com.tw/upload/images/20210901/20120327NvpHVr2QC0.jpg loading=lazy src=https://ithelp.ithome.com.tw/upload/images/20210901/20120327NvpHVr2QC0.jpg></p><p>&ndash;</p><p>AWS 為例，實現 production framework 的最佳實踐的 30 天 workshop</p><h1 id=準備-production-environmtn-devops-面臨的問題>準備 Production environmtn Devops 面臨的問題<a hidden class=anchor aria-hidden=true href=#準備-production-environmtn-devops-面臨的問題>#</a></h1><p>DevOps 的工作內容繁雜</p><ul><li>今天想要 Deploy 一個 backend API deployment 到 k8s 上</li><li>一轉眼發現自己在修 port / servie / ingress / alb</li><li>一轉眼發現自己在修 tls certificate</li><li>一轉眼發現自己在修 node linux 上的一個 bug</li><li>一轉眼發現自己在修 monitoring / metrics + alert / log collection
&mldr;</li><li>我只是想 deploy 一個 backend deployment<ul><li>修infra 花了好幾天，而寫 deployment 只要 2 hr</li><li>Devops 的工作，是處理 developer 與 operator 中間的繁雜的細節</li></ul></li></ul><p>換個角度思考：上面這些元件全都是存在許久的功能，應該有一套統一介面隨叫即用這些服務，ex.</p><ul><li>今天想要 Deploy 一個 backend API deployment 到 k8s 上</li></ul><p>承上，同值性高，coding 講求 DRY 原則 (Don&rsquo;t Repeat Youself)，infra 管理上卻會有大量重複的工作</p><ul><li>開一個 Restful API deployment</li><li>開一個 GRPC deployment</li><li>開一個 Kafka message Queue / redis / RDS / &mldr;</li><li>希望這些元件都有寫好的 unit 可以重複使用</li><li>但實務上還是會有細節需要調整</li></ul><p>自動化</p><ul><li>標準化功能後，應該要可以自動部署</li><li>甚至是當 Backend API deployment 部署上去時，自動調用產生對應的元件</li><li>Backend API deployment 有變化時應該要跟據 deployment 需求去做 reconcile (k8s controller)</li></ul><p>缺乏測試</p><ul><li>VM / alb / RDS / &mldr; 等公有雲服務需要測試嗎<ul><li>A: AWS / Google / Azure 都測過了，我們不用再測<ul><li>然而 SRE 卻發現時常需要花時間 debug 這些元件<ul><li>不是 functional issue，而是 configuration 問題，或是不同元件設定造成交互作用</li></ul></li></ul></li><li>B: 要上 production 的元件都要測試<ul><li>使用 terraform provision 一台 EC2 後，在使用 terratest (Golang) 打 aws API 進行測試</li></ul></li></ul></li><li>標準化，自動化後，應該有大量的自動化測試，來確保每一個元件的 configuration 都是正確的，而且有信心維持穩定度</li></ul><p>infra 時常改變</p><ul><li>技術元件時常改變：terraform 升級，aws 升級，k8s 升級，linux 升級與 patch<ul><li>infra 沒有射後不理這種事，都需要時常且穩定的更新</li></ul></li><li>為了滿足上游服務(前後端/DB/&mldr;)的需求<ul><li>調整 VM spec / networking / routing / security rules /</li></ul></li><li>不斷的改變耗費大量的人工時間</li></ul><p>production ready 需要準備的</p><ul><li>production -> 真金白銀，公司的業務與名聲</li><li>production ready 應該是有明確的表準 True / False，而不是『我覺得現在是 production ready 了』<ul><li>DevOps / SRE 都知道 production ready 的標準，只是沒有把他明確寫出來</li></ul></li><li>production ready 應該就跟 unit test 一樣，一個 checklist 跑下去檢查，通過就是 production-ready，不通過就是 not-ready，且會說明不通過的原因</li><li><a href=https://gruntwork.io/devops-checklist/>Gruntwork production ready checklist</a></li></ul><p>人工介入工作太多</p><ul><li>新增元件需要人工處裡</li><li>定期的 patch & update / 安全性更新 / deploy 都需要人工介入的話就太浪費時間了</li><li>人工工作太多容易造成人為錯誤(human error)</li></ul><p>多環境</p><ul><li>SRE 需要提供大量的環境 dev / qa / stag / prod &mldr;</li><li>或是提早 scan 到更前面的工作流程，例如在 code base / reposiroty 中就先 scan</li></ul><h1 id=gruntwork-solution>Gruntwork solution<a hidden class=anchor aria-hidden=true href=#gruntwork-solution>#</a></h1><p>為何要使用 gruntwork framework</p><p><a href=https://docs.gruntwork.io/guides/production-framework>Why you need a framework</a></p><p><a href=https://docs.gruntwork.io/intro/next-steps>Gruntwork 提出兩個 solution</a></p><ul><li><a href=https://docs.gruntwork.io/guides/reference-architecture/example-usage-guide>Reference Architecture</a></li><li><a href=https://docs.gruntwork.io/guides/build-it-yourself>Build your own architecture</a></li></ul><h1 id=prerequisites>Prerequisites<a hidden class=anchor aria-hidden=true href=#prerequisites>#</a></h1><p>由於本次分享不希望有多餘的費用，所以內容依據 gruntwork 公開網站與開源的 repository 內容講解使用</p><ul><li>不會涉及付費版的 terraform code library 內容與教材(subscription $795/month)</li><li>aws 服務也盡量使用 free tier 中的額度</li></ul><p>Prerequisites</p><ul><li>基本 Terraform 經驗，或是參考<a href>2021 年的鐵人賽系列文章: 30 天學 Terraform on Azure</a></li><li>基本 AWS 服務的觀念
都沒有也沒關係，會沿路在幫各位複習</li></ul><h1 id=30-天的目標>30 天的目標<a hidden class=anchor aria-hidden=true href=#30-天的目標>#</a></h1><ul><li>使用 terraform 設定所有 aws account 的 resource</li><li>參考 gruntwork-io 的開源 repository，設定<ul><li>如果是測試或學習，可以參考
<a href=https://github.com/gruntwork-io/terraform-aws-service-catalog>https://github.com/gruntwork-io/terraform-aws-service-catalog</a></li></ul></li></ul><p>學習目標</p><ul><li>熟悉 terraform 基本觀念</li><li>學會使用 terraform IaC 控制所有 aws service</li></ul><h1 id=repository>Repository<a hidden class=anchor aria-hidden=true href=#repository>#</a></h1><p>NOTE: 如果是有購買 gruntwork subscription 的朋友，請使用私有的 IaC library repository，有更完整且經過測試的架構</p><p>本課程使用 <a href=https://github.com/gruntwork-io/terragrunt-infrastructure-live-example>gruntwork 開源的 repository 架構</a></p><p>請 copy 需要的部分（而不要 fork，因為這裡不需要過去的 commit history 與未來的 update)</p><ul><li><a href=https://github.com/chechiachang/terraform-30-days>去年iThome 鐵人賽使用的範例 repository</a></li><li><a href=https://github.com/chechiachang/terraform-azure>我自己使用的 repo</a></li><li><a href=https://github.com/chechiachang/terragrunt-infrastructure-live-example>今年 iThome 會使用的 repository</a></li></ul><h1 id=今天要做的事>今天要做的事<a hidden class=anchor aria-hidden=true href=#今天要做的事>#</a></h1><p>請準備好以下 prerequisite</p><ul><li>設定 / 註冊 aws account 併取得 aws 12-month free-tier (預期是免費的預期 12-month free tier 即可包含所有內容)<ul><li>然而成本控制也是課程的一環，各位要注意使用的資源，不要超過 aws free tier 太多，理論上也是最多幾美金的花費</li></ul></li><li>安裝與設定 terraform tools<ul><li>terraform 1.2.9</li><li>terragrunt 0.38.9</li><li>使用舊版本的朋友請盡量使用 terraform >1.x 與 terragrunt >0.35.8 的版本</li></ul></li></ul><p>Aws account</p><ul><li>如果已經有 aws cloud service account 可以直接使用，本課程會使用全新的 aws account</li><li>使用 email 註冊 aws cloud service<ul><li>email 認證</li><li>信用卡登記</li><li>手機認證</li></ul></li></ul><p>Install terraform</p><ul><li>terraform 1.2.9</li><li>terragrunt 0.38.9</li></ul><h1 id=設定-github-repository>設定 Github repository<a hidden class=anchor aria-hidden=true href=#設定-github-repository>#</a></h1><p>準備一個 github repository 來存放ㄏ的 terraform code</p><ul><li>可以使用<a href=https://github.com/chechiachang/terragrunt-infrastructure-live-example>我的範例 repository</a>，也是 fork 底下 gruntwork 的 repository 稍作整理</li><li>或參考 <a href=https://github.com/gruntwork-io/terragrunt-infrastructure-live-example>gruntwork Github repository example</a></li></ul><pre><code>git clone git@github.com:chechiachang/terragrunt-infrastructure-live-example.git
</code></pre><h1 id=明天>明天<a hidden class=anchor aria-hidden=true href=#明天>#</a></h1><p>帶著大家在 terraform code 中設定 aws account 與 IAM 權限</p><h1 id=參考資源>參考資源<a hidden class=anchor aria-hidden=true href=#參考資源>#</a></h1><p>不熟悉 terraform 的朋友不妨參考去年的佳作 <a href=https://ithelp.ithome.com.tw/users/20120327/ironman/4057>Terraform Workshop - Infrastructure as Code for Public Cloud 疫情警戒陪你度過 30 天</a>，雖然是在 Azure 上
，但許多基本概念都是相通的</p><p>過去的鐵人賽文章</p><ul><li>13th 佳作 <a href=https://ithelp.ithome.com.tw/users/20120327/ironman/4057>Terraform Workshop - Infrastructure as Code for Public Cloud 疫情警戒陪你度過 30 天</a></li><li>12th 佳作 <a href=https://ithelp.ithome.com.tw/users/20120327/ironman/3248>Kubernetes X DevOps X 從零開始導入工具 X 需求分析＊從底層開始研究到懷疑人生的體悟＊</a></li><li>11th 優勝 <a href=https://ithelp.ithome.com.tw/users/20120327/ironman/2444>其實我真的沒想過只是把服務丟上 kubernetes 就有這麼多問題只好來參加30天分享那些年我怎麼在 kubernetes 上踩雷各項服務</a>
kkk</li></ul><p>推薦一下 Gruntwork 他們家的 blog: <a href=https://blog.gruntwork.io/>Gruntwork devops as a service</a></p><h1 id=qa>Q&amp;A<a hidden class=anchor aria-hidden=true href=#qa>#</a></h1><p>過去參賽都會有許多朋友提出問題，今年若有疑問可以集中在第一篇文章，我會跟大家一起討論。有想要看的題目也可以留言，我們看時間做安排。</p><h1 id=references>references<a hidden class=anchor aria-hidden=true href=#references>#</a></h1><ul><li><a href=https://docs.gruntwork.io/intro/overview/how-it-works>https://docs.gruntwork.io/intro/overview/how-it-works</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://chechia.net/tags/terraform/>Terraform</a></li><li><a href=https://chechia.net/tags/iac/>Iac</a></li><li><a href=https://chechia.net/tags/aws/>Aws</a></li><li><a href=https://chechia.net/tags/%E9%90%B5%E4%BA%BA%E8%B3%BD2022/>鐵人賽2022</a></li></ul><nav class=paginav><a class=prev href=https://chechia.net/posts/2022-09-13-14th-ithome-ironman-iac-aws-workshop-02-aws-account-structure/><span class=title>« Prev</span><br><span>AWS Account Struture</span>
</a><a class=next href=https://chechia.net/posts/2022-06-09-ithome-devopsday-2022-proposal-introduce-policy-as-code-for-terraform-/><span class=title>Next »</span><br><span>IThome 2022 DevOpsDay Introducing policy as code for terraform</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share IaC best practice workshop on aws on x" href="https://x.com/intent/tweet/?text=IaC%20best%20practice%20workshop%20on%20aws&amp;url=https%3a%2f%2fchechia.net%2fposts%2f2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction%2f&amp;hashtags=terraform%2ciac%2caws%2c%e9%90%b5%e4%ba%ba%e8%b3%bd2022"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IaC best practice workshop on aws on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fchechia.net%2fposts%2f2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction%2f&amp;title=IaC%20best%20practice%20workshop%20on%20aws&amp;summary=IaC%20best%20practice%20workshop%20on%20aws&amp;source=https%3a%2f%2fchechia.net%2fposts%2f2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IaC best practice workshop on aws on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fchechia.net%2fposts%2f2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction%2f&title=IaC%20best%20practice%20workshop%20on%20aws"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IaC best practice workshop on aws on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fchechia.net%2fposts%2f2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IaC best practice workshop on aws on whatsapp" href="https://api.whatsapp.com/send?text=IaC%20best%20practice%20workshop%20on%20aws%20-%20https%3a%2f%2fchechia.net%2fposts%2f2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IaC best practice workshop on aws on telegram" href="https://telegram.me/share/url?text=IaC%20best%20practice%20workshop%20on%20aws&amp;url=https%3a%2f%2fchechia.net%2fposts%2f2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IaC best practice workshop on aws on ycombinator" href="https://news.ycombinator.com/submitlink?t=IaC%20best%20practice%20workshop%20on%20aws&u=https%3a%2f%2fchechia.net%2fposts%2f2022-09-12-14th-ithome-ironman-iac-aws-workshop-01-introduction%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://chechia.net/>Che-Chia Chang</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>